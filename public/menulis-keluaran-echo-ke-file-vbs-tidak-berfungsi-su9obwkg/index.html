<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><title>Menulis keluaran ECHO ke File VBS tidak berfungsi</title><meta name=description content="Saya menulis Batch Script yang membuat VB Script dengan menggemakan setiap baris dan mengarahkan output ke file yang dibuat. Ini berfungsi untuk sebagian besar, kecuali untuk dua baris yang mendapatkan variabel Baris..."><link rel=canonical href=https://www.idxstack.com/menulis-keluaran-echo-ke-file-vbs-tidak-berfungsi-su9obwkg/><meta property="og:title" content="Menulis keluaran ECHO ke File VBS tidak berfungsi"><meta property="og:description" content="Saya menulis Batch Script yang membuat VB Script dengan menggemakan setiap baris dan mengarahkan output ke file yang dibuat. Ini berfungsi untuk sebagian besar, kecuali untuk dua baris yang mendapatkan variabel Baris..."><meta property="og:type" content="website"><meta property="og:url" content="https://www.idxstack.com/menulis-keluaran-echo-ke-file-vbs-tidak-berfungsi-su9obwkg/"><meta property="og:site_name" content="IDXStack"><meta property="og:locale" content="id_ID"><meta name=twitter:card content="summary"><meta name=twitter:title content="Menulis keluaran ECHO ke File VBS tidak berfungsi"><meta name=twitter:description content="Saya menulis Batch Script yang membuat VB Script dengan menggemakan setiap baris dan mengarahkan output ke file yang dibuat. Ini berfungsi untuk sebagian besar, kecuali untuk dua baris yang mendapatkan variabel Baris..."><link rel=stylesheet href=/css/style.min.c181a38d9857323db0ab0ad950bbd049d24d2f1d58d7566522f92aae4e1057df.css><link rel=stylesheet href=/vendor/fontawesome/css/all.min.css></head><body itemscope itemtype=https://schema.org/QAPage><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><div class=container><a href=/ class=navbar-brand>IDXStack</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a href=/ class=nav-link>Beranda</a></li></ul><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a href=/about-us class=dropdown-item>About</a>
<a href=/contact class=dropdown-item>Contact</a>
<a href=/disclaimer class=dropdown-item>Disclaimer</a></div></li></ul></div></div></nav><div class="container my-2" itemprop=mainEntity itemscope itemtype=https://schema.org/Question><div class="card shadow-sm mb-2"><div class=card-body><div class=mb-2><span class="badge badge-dark">Komputer</span></div><h1 class=h3 itemprop=name>Menulis keluaran ECHO ke File VBS tidak berfungsi</h1><div itemprop=text><p>Saya menulis Batch Script yang membuat VB Script dengan menggemakan setiap baris dan mengarahkan output ke file yang dibuat. Ini berfungsi untuk sebagian besar, kecuali untuk dua baris yang mendapatkan variabel Baris Perintah dan menggunakannya sebagai variabel VBS. Ini kodenya:</p><pre><code>ECHO:strHomeFolder = oShell.ExpandEnvironmentStrings^(^"^%USERPROFILE^%^"^) &gt;&gt; uninstallBeta.vbs
ECHO:strProgramData = oShell.ExpandEnvironmentStrings^(^"^%ProgramData^%^"^) &gt;&gt; uninstallBeta.vbs
</code></pre><p>Ini akan terlihat seperti ini di VB Script:</p><pre><code>strHomeFolder = oShell.ExpandEnvironmentStrings("%USERPROFILE%")
strProgramData = oShell.ExpandEnvironmentStrings("%ProgramData%")
</code></pre><p>Tapi yang terjadi adalah Batch Script itu hanya menggemakan seluruh baris, termasuk <code>>> uninstallBeta.vbs</code>. Adakah yang tahu mengapa ini terjadi? Saya memiliki baris serupa untuk membuat skrip VBS dan Batch lain yang menurut saya berfungsi dengan baik melakukannya dengan cara ini. Saya telah memeriksa kesalahan ketik dan tidak menemukannya. Ini berfungsi dengan baik di Command Prompt, tetapi tidak di Batch Script.</p></div></div><div class="card-footer bg-white d-flex justify-content-between"><div><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>4</span></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/519818/a-child-of-god target=_blank rel="nofollow noopener"><span itemprop=name>A Child of God</span></a>
—
<a href=https://superuser.com/questions/1261162/writing-echo-output-to-vbs-file-not-working target=_blank rel="nofollow noopener">Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm" id=showQuestionReplies>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 d-none" id=questionRepliesContainer><ul class="list-group list-group-flush"><li class=list-group-item><div>saya menemukan <a href=https://ss64.com/nt/syntax-redirection.html rel="nofollow noopener" target=_blank>sebuah solusi</a> yang memperbaikinya, tetapi saya masih ingin tahu mengapa ini terjadi.</div><div>— <a href=https://superuser.com/users/519818/a-child-of-god target=_blank rel="nofollow noopener">A Child of God</a></div></li><li class=list-group-item><div>Anda mungkin ingin melihat <a href=https://stackoverflow.com/a/9074483/1012053 target=_blank rel="nofollow noopener">stackoverflow.com/a/9074483/1012053</a> , terutama <b><i>UPDATE 2014-04-27</i></b> di bagian bawah, untuk metode yang sepenuhnya menghindari pembuatan file VBS terpisah. Anda benar-benar dapat menjalankan VBS langsung di dalam skrip batch!</div><div>— <a href=https://superuser.com/users/109090/dbenham target=_blank rel="nofollow noopener">dbenham</a></div></li><li class=list-group-item><div>@dbenham Saya melihat itu kemarin sebelum ada yang menjawab. Dalam akan mempertimbangkan untuk mencobanya.</div><div>— <a href=https://superuser.com/users/519818/a-child-of-god target=_blank rel="nofollow noopener">A Child of God</a></div></li></ul></div></div></div><hr><h2 class=h4><span itemprop=answerCount>2</span> Jawaban</h2><div class=form-row itemprop=acceptedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>6</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-0><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>6</div><div class=card-body><div itemprop=text><p>Ini membantu untuk memahami bagaimana cmd.exe mem-parsing skrip batch:<br><a href=https://stackoverflow.com/a/4095133/1012053 target=_blank rel="nofollow noopener">Bagian 1 - Gambaran Umum</a><br><a href=https://stackoverflow.com/a/7970912/1012053 target=_blank rel="nofollow noopener">Bagian 2 - Detail persen perluasan</a></p><p>Saya akan mengerjakan pemrosesan baris pertama yang salah:</p><pre class="lang-none prettyprint-override"><code>echo strHomeFolder = oShell.ExpandEnvironmentStrings^(^"^%USERPROFILE^%^"^) &gt;&gt; uninstallBeta.vbs
</code></pre><p>Pemrosesan persen dalam fase 1 terjadi sebelum <code>^</code> lolos pemrosesan dalam fase 2. Jadi parser mencari variabel lingkungan bernama <code>USERPROFILE^</code>, dan gagal menemukannya. Sehingga mengembang menjadi string kosong, meninggalkan:</p><pre class="lang-none prettyprint-override"><code>echo strHomeFolder = oShell.ExpandEnvironmentStrings^(^"^^"^) &gt;&gt; uninstallBeta.vbs
</code></pre><p>Selanjutnya, tanda sisipan diproses untuk melepaskan karakter dalam fase dua. Yang penting <code>^"</code> pertama adalah kutipan yang lolos, jadi karakter setelahnya <strong><em>tidak</em></strong> dikutip. <code>^^</code> berikutnya adalah tanda sisipan yang lolos. Than mengikuti kutipan pertama yang tidak di-escape, jadi semua karakter setelahnya akan dikutip. Saya menandakan bahwa dengan Q di atas setiap karakter yang dikutip:</p><pre class="lang-none prettyprint-override"><code>                                                        QQQQQQQQQQQQQQQQQQQQQQQ
echo strHomeFolder = oShell.ExpandEnvironmentStrings("^"^) &gt;&gt; uninstallBeta.vbs
</code></pre><p>Harus jelas mengapa pengalihan <code>>></code> tidak berfungsi - ini dikutip sehingga berfungsi sebagai string literal sebagai gantinya.</p><p>Anda mencoba untuk keluar dari <code>%</code> sebagai <code>^%</code> untuk mencegah ekspansi variabel dalam kelompok. Itu tidak berhasil. Hal yang benar adalah menggandakan persen:</p><pre class="lang-none prettyprint-override"><code>echo strHomeFolder = oShell.ExpandEnvironmentStrings("%%USERPROFILE%%") &gt;&gt; uninstallBeta.vbs
</code></pre><p>Jika garis berada dalam blok tanda kurung, maka Anda harus keluar dari <code>)</code>, tetapi <code>(</code> tidak perlu lolos</p><pre class="lang-none prettyprint-override"><code>for .... do (
    ...
    echo strHomeFolder = oShell.ExpandEnvironmentStrings("%%USERPROFILE%%"^) &gt;&gt; uninstallBeta.vbs
    ...
)
</code></pre><p>Perhatikan bahwa aturan berbeda dari baris perintah. Tidak ada mekanisme untuk benar-benar melepaskan <code>%</code> dalam baris perintah, dan baris perintah mempertahankan teks <code>%undefinedVar%</code> jika variabel tidak ditentukan. Namun, Anda dapat secara efektif mencegah perluasan variabel dengan memasukkan satu atau lebih <code>^</code> di antara persen sehingga variabel tersebut tidak ditemukan. Tanda sisipan kemudian menghilang di fase 2. Tapi kutipan pertama harus dihilangkan sehingga <code>^</code> internal menghilang. Dan kutipan terakhir harus di-escape agar pengalihan aktif.</p><p>Ini berfungsi dari baris perintah (tetapi tidak dalam skrip batch):</p><pre class="lang-none prettyprint-override"><code>echo strHomeFolder = oShell.ExpandEnvironmentStrings(^"%USERPROFILE^%^") &gt;&gt; uninstallBeta.vbs
</code></pre><p>Tanda sisipan dapat muncul di mana saja di antara persen. Semua hal berikut akan bekerja dengan baik:</p><pre class="lang-none prettyprint-override"><code>%USER^PROFILE%
%^USERPROFILE%
etc.
</code></pre></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/menulis-keluaran-echo-ke-file-vbs-tidak-berfungsi-su9obwkg/#answer-0 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/109090/dbenham target=_blank rel="nofollow noopener"><span itemprop=name>dbenham</span></a>
—
<a href=https://superuser.com/a/1261181 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=0>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=0><ul class="list-group list-group-flush"><li class=list-group-item><div>@Facebook - Saya tidak tahu situasi apa yang Anda maksud. Saya harus melihat contoh konkret. Jika Anda mengetahui skenario yang benar-benar merepotkan, kirimkan pertanyaan baru, baik di sini atau di StackOverflow.</div><div>— <a href=https://superuser.com/users/109090/dbenham target=_blank rel="nofollow noopener">dbenham</a></div></li><li class=list-group-item><div>Ini dia pria .... <a href=https://superuser.com/questions/1261588/batch-script-parenthesized-echo-of-the-word-where-issue title="batch script parenthesized echo of the word where issue" target=_blank rel="nofollow noopener">superuser.com/questions/1261588/…</a></div><div>— <a href=https://superuser.com/users/510662/drink-more-pimp-juice-it target=_blank rel="nofollow noopener">Drink More Pimp Juice IT</a></div></li></ul></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>2</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-1><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>2</div><div class=card-body><div itemprop=text><p>Saya mencoba ini dan berfungsi seperti yang diharapkan juga .....</p><pre><code>set a=userprofile
set b=ProgramData
&gt; uninstallBeta.vbs ECHO strHomeFolder = oShell.ExpandEnvironmentStrings^("%%%a%%%%"^)
&gt;&gt; %DESKTOP%\uninstallBeta.vbs ECHO strProgramData = oShell.ExpandEnvironmentStrings^("%%%b%%%%"^)
</code></pre><p>Saya juga seorang pemula dalam batch-scripting. Saya menemukan ini bekerja dengan mencoba.
berharap seseorang menjelaskan cara kerjanya.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/menulis-keluaran-echo-ke-file-vbs-tidak-berfungsi-su9obwkg/#answer-1 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/741364/tahaeltahawy target=_blank rel="nofollow noopener"><span itemprop=name>TahaEltahawy</span></a>
—
<a href=https://superuser.com/a/1261186 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=1>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=1><ul class="list-group list-group-flush"><li class=list-group-item><div>Lihat jawaban dbenham mengapa itu berhasil.</div><div>— <a href=https://superuser.com/users/519818/a-child-of-god target=_blank rel="nofollow noopener">A Child of God</a></div></li></ul></div></div></div></div></div><div class="card shadow-sm my-2"><div class=card-header>Pertanyaan Serupa</div><ul class="list-group list-group-flush"><li class=list-group-item><div><a href=/menyalin-hanya-hal-hal-yang-berbeda-duplikat-fxxix9yu/>Menyalin hanya hal-hal yang berbeda [duplikat]</a></div></li><li class=list-group-item><div><a href=/masalah-dengan-kunci-ssh-bersama-k3zxgcjo/>Masalah dengan kunci ssh bersama</a></div></li><li class=list-group-item><div><a href=/cara-remote-desktop-komputer-melalui-internet-duplikat-oehxbeqz/>Cara remote desktop komputer melalui internet [duplikat]</a></div></li><li class=list-group-item><div><a href=/mengoreksi-izin-di-mac-setelah-penginstalan-mountain-lion-k4gv1gd2/>mengoreksi izin di Mac setelah penginstalan Mountain Lion</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-menampilkan-nama-seri-di-dalam-batang-diagram-batang-bertumpuk-esylp99l/>Bagaimana cara menampilkan nama seri di dalam batang diagram batang bertumpuk?</a></div></li><li class=list-group-item><div><a href=/menginstal-avira-antivirus-di-windows-8-um5m40nb/>Menginstal Avira Antivirus di Windows 8</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-memperbaiki-lebar-teks-vim-selama-pengeditan-rz3lmipy/>Bagaimana cara memperbaiki lebar teks vim selama pengeditan?</a></div></li><li class=list-group-item><div><a href=/buat-terminal-mengenali-pageup-dan-pagedown-saat-dipetakan-ulang-ke-kunci-yang-berbeda-7ytnetpv/>Buat Terminal mengenali PageUp dan PageDown saat dipetakan ulang ke kunci yang berbeda</a></div></li><li class=list-group-item><div><a href=/apa-yang-dimaksud-dengan-suffix-co-versi-internet-explorer-5fvajh7w/>Apa yang dimaksud dengan Suffix = CO Versi Internet Explorer?</a></div></li><li class=list-group-item><div><a href=/gimp-tempel-sebagai-layer-baru-1eofcxhn/>GIMP: Tempel sebagai Layer Baru</a></div></li></ul></div></div><div class="mt-5 bg-light"><div class=container><div class="py-4 d-flex justify-content-between small text-muted"><div>By using our site, you agree to our <a href=/terms-of-service>Terms of Service</a>, <a href=/privacy-policy>Privacy Policy</a>, and <a href=/cookie-policy>Cookie Policy</a></div><div>Berlisensi di bawah <a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="nofollow noopener">CC BY-SA 4.0</a> dengan attribusi</div></div></div></div><script src=/js/jquery-3.5.1.min.js></script><script src=/js/bootstrap.bundle.min.js></script><script>$(document).ready(function(){$("#showQuestionReplies").click(function(){$("#questionRepliesContainer").toggleClass("d-none")}),$(".show-answer-replies").click(function(){var a=$(this).data("id");$(".answer-replies-container[data-id='"+a+"']").toggleClass("d-none")})})</script></body></html>