<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><title>Powershell one-liner untuk menampilkan proses pada baris yang sama dengan port menggunakan masalah netstat</title><meta name=description content="Pertama saya hanya ingin memastikan pengguna Erik Bitemo mendapatkan kredit untuk kode asli yang saya gunakan di sini. Outputnya adalah apa yang saya cari dengan satu pengecualian: Salah satu port menghilang dan..."><link rel=canonical href=https://www.idxstack.com/powershell-one-liner-untuk-menampilkan-proses-pada-baris-yang-sama-dengan-port-menggunakan-masalah-netstat-b5jh2kge/><meta property="og:title" content="Powershell one-liner untuk menampilkan proses pada baris yang sama dengan port menggunakan masalah netstat"><meta property="og:description" content="Pertama saya hanya ingin memastikan pengguna Erik Bitemo mendapatkan kredit untuk kode asli yang saya gunakan di sini. Outputnya adalah apa yang saya cari dengan satu pengecualian: Salah satu port menghilang dan..."><meta property="og:type" content="website"><meta property="og:url" content="https://www.idxstack.com/powershell-one-liner-untuk-menampilkan-proses-pada-baris-yang-sama-dengan-port-menggunakan-masalah-netstat-b5jh2kge/"><meta property="og:site_name" content="IDXStack"><meta property="og:locale" content="id_ID"><meta name=twitter:card content="summary"><meta name=twitter:title content="Powershell one-liner untuk menampilkan proses pada baris yang sama dengan port menggunakan masalah netstat"><meta name=twitter:description content="Pertama saya hanya ingin memastikan pengguna Erik Bitemo mendapatkan kredit untuk kode asli yang saya gunakan di sini. Outputnya adalah apa yang saya cari dengan satu pengecualian: Salah satu port menghilang dan..."><link rel=stylesheet href=/css/style.min.c181a38d9857323db0ab0ad950bbd049d24d2f1d58d7566522f92aae4e1057df.css><link rel=stylesheet href=/vendor/fontawesome/css/all.min.css></head><body itemscope itemtype=https://schema.org/QAPage><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><div class=container><a href=/ class=navbar-brand>IDXStack</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a href=/ class=nav-link>Beranda</a></li></ul><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a href=/about-us class=dropdown-item>About</a>
<a href=/contact class=dropdown-item>Contact</a>
<a href=/disclaimer class=dropdown-item>Disclaimer</a></div></li></ul></div></div></nav><div class="container my-2" itemprop=mainEntity itemscope itemtype=https://schema.org/Question><div class="card shadow-sm mb-2"><div class=card-body><div class=mb-2><span class="badge badge-dark">Komputer</span></div><h1 class=h3 itemprop=name>Powershell one-liner untuk menampilkan proses pada baris yang sama dengan port menggunakan masalah netstat</h1><div itemprop=text><p>Pertama saya hanya ingin memastikan pengguna Erik Bitemo mendapatkan kredit untuk kode asli yang saya gunakan di sini. Outputnya adalah apa yang saya cari dengan satu pengecualian: Salah satu port menghilang dan "System System5" muncul di tempatnya dan saya tidak tahu mengapa itu terjadi.</p><p>Sasaran: Menampilkan semua port TCP (Listening) dan UDP dan proses yang terkait dengan masing-masing pada baris yang sama.</p><p>Satu liner digunakan:</p><pre><code>$nets = netstat -bano|select-string 'LISTENING|UDP'; foreach ($n in $nets)    {    $p = $n -replace ' +',' ';    $nar = $p.Split(' ');    $pname = $(Get-Process -id $nar[-1]).ProcessName;    $n -replace "$($nar[-1])","$($ppath) $($pname)";     }
</code></pre><p>Contoh Output:</p><blockquote><p>TCP 0.0.0.0:135 0.0.0.0i> LISTENING svchost<br>TCP 0.0.0.0: Sistem Sistem5 0.0.0.0 E5E5E5 LISTENING Sistem<br>TCP 0.0.0.0:623 0.0.0.0 terrible LMS MENDENGARKAN</p></blockquote><p>Porta yang diubah adalah 445 tetapi saya tidak tahu mengapa hanya mengubah yang itu ketika port lainnya berfungsi sebagaimana mestinya. Mengapa skrip 445 berubah menjadi "System System5"?</p><p>Sayangnya, menggunakan alat lain tidak memungkinkan, jadi saya dibatasi untuk menggunakan alat Windows bawaan.</p></div></div><div class="card-footer bg-white d-flex justify-content-between"><div><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>4</span></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/726514/ric target=_blank rel="nofollow noopener"><span itemprop=name>Ric</span></a>
—
<a href=https://superuser.com/questions/1215093/powershell-one-liner-to-show-process-on-same-line-as-port-using-netstat-issue target=_blank rel="nofollow noopener">Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm" id=showQuestionReplies>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 d-none" id=questionRepliesContainer><ul class="list-group list-group-flush"><li class=list-group-item><div>Silahkan <a href=https://superuser.com/posts/1215093/edit target=_blank rel="nofollow noopener">edit</a> pertanyaan dan memberikan hasil mentah dari <code>netstat -bano|select-string 'LISTENING|UDP'</code></div><div>— <a href=https://superuser.com/users/337631/davidpostill target=_blank rel="nofollow noopener">DavidPostill&#9830;</a></div></li></ul></div></div></div><hr><h2 class=h4><span itemprop=answerCount>3</span> Jawaban</h2><div class=form-row itemprop=acceptedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>3</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-0><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>3</div><div class=card-body><div itemprop=text><p><code>$p</code> bisa seperti <code>TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4</code> dan <code>$nar[-1]</code> adalah string <code>4</code> sehingga operator <code>-replace</code> mengambil <strong>semua</strong> <code>4</code>-an:</p><pre><code>TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4
            ↑↑                      ↑
</code></pre><p>Paksa hanya mengganti kejadian terakhir <code>$nar[-1]</code> menggunakan <em>akhir baris</em> jangkar (lolos <code>$</code>):</p><pre><code>$p -replace "$($nar[-1])`$","$ppath $pname"
</code></pre><p>Baca juga jawaban Matt untuk <a href=https://stackoverflow.com/a/28437855/3439404 target=_blank rel="nofollow noopener">Mengganti kemunculan terakhir substring dalam string</a> di stackoverflow.</p><p>BTW:</p><ul><li><code>$ppath</code> tidak ditentukan…</li><li>… Dan<pre><code>$p -replace "$($nar[-1])`$","$ppath $pname"
</code></pre>sudah cukup (perhatikan bahwa opsi <code>-b</code> dapat memakan waktu dan akan gagal kecuali Anda memiliki izin yang memadai).</li></ul></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/powershell-one-liner-untuk-menampilkan-proses-pada-baris-yang-sama-dengan-port-menggunakan-masalah-netstat-b5jh2kge/#answer-0 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/376602/josefz target=_blank rel="nofollow noopener"><span itemprop=name>JosefZ</span></a>
—
<a href=https://superuser.com/a/1215199 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=0>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=0><ul class="list-group list-group-flush"><li class=list-group-item><div>Anda menemukan masalahnya dengan pasti. Saya telah menawarkan saran untuk masalah ini juga jika Anda penasaran.</div><div>— <a href=https://superuser.com/users/348943/matt target=_blank rel="nofollow noopener">Matt</a></div></li></ul></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>6</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-1><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>6</div><div class=card-body><div itemprop=text><p><a href=https://superuser.com/a/1215199/348943 target=_blank rel="nofollow noopener">Jawaban JosefZ</a> menjelaskan masalah Anda dengan sempurna. Anda menggunakan regex dan melakukan persis seperti yang Anda minta, mungkin hanya mengganti lebih dari yang Anda harapkan.</p><p>Catatan tambahannya adalah Anda meminta <code>netstat</code> untuk</p><blockquote><p>menampilkan eksekusi yang terlibat dalam membuat setiap koneksi atau port mendengarkan</p></blockquote><p>dengan tombol b. Namun Anda menjatuhkannya dengan <code>select-string</code> karena proses itu muncul di barisnya sendiri setelah data lainnya. Itu bukanlah akhir dunia tetapi karena Anda dapat menggunakan hal-hal seperti <code>-Context</code> dari <code>Select-String</code> untuk mendapatkannya tetapi itu harus dilihat lebih dekat di lain waktu.</p><p>Saya ingin menawarkan saran lain tentang apa yang dapat Anda lakukan dalam situasi ini.</p><blockquote><p>Sayangnya, menggunakan alat lain tidak memungkinkan, jadi saya dibatasi untuk menggunakan alat Windows bawaan.</p></blockquote><p>Lucunya, apakah Anda memiliki setidaknya Windows 8? Jika Anda melakukannya, Anda bisa menggunakan <a href=https://technet.microsoft.com/itpro/powershell/windows/nettcpip/get-nettcpconnection rel="nofollow noopener" target=_blank><code>Get-NetTCPConnection</code></a> cmdlet yang pada dasarnya <code>netstat</code> dalam bentuk objek.</p><p>Jadi Anda bisa melakukan ini yang seharusnya memberi Anda informasi yang sama tanpa kerumitan</p><pre class="lang-ps prettyprint-override"><code>get-nettcpconnection | select local*,remote*,state,@{Name="Process";Expression={(Get-Process -Id $_.OwningProcess).ProcessName}}
</code></pre><p>Tidak punya Windows 8+? Kalau begitu kami bisa meningkatkan skrip parsing Anda. Mengambil satu langkah lebih jauh untuk membuat objek akan mencegah masalah dengan pencocokan ekspresi reguler.</p><pre class="lang-ps prettyprint-override"><code>netstat -ano | Where-Object{$_ -match 'LISTENING|UDP'} | ForEach-Object{
    $split = $_.Trim() -split "\s+"
    [pscustomobject][ordered]@{
        "Proto" = $split[0]
        "Local Address" = $split[1]
        "Foreign Address" = $split[2]
        # Some might not have a state. Check to see if the last element is a number. If it is ignore it
        "State" = if($split[3] -notmatch "\d+"){$split[3]}else{""}
        # The last element in every case will be a PID
        "Process Name" = $(Get-Process -Id $split[-1]).ProcessName
    }
}
</code></pre><p>Jika Anda terbatas pada PowerShell v2 maka Anda perlu mengubah psobject dan memerintahkan cast</p><pre class="lang-ps prettyprint-override"><code>netstat -ano | Where-Object{$_ -match 'LISTENING|UDP'} | ForEach-Object{
    $split = $_.Trim() -split "\s+"
    New-Object -Type pscustomobject -Property @{
        "Proto" = $split[0]
        "Local Address" = $split[1]
        "Foreign Address" = $split[2]
        # Some might not have a state. Check to see if the last element is a number. If it is ignore it
        "State" = if($split[3] -notmatch "\d+"){$split[3]}else{""}
        # The last element in every case will be a PID
        "Process Name" = $(Get-Process -Id $split[-1]).ProcessName
    }
} | Select "Proto", "Local Address", "Foreign Address", "State", "Process Name" 
</code></pre><p>Pernyataan <code>select</code> terakhir menjamin urutan properti, yang akan dikocok sebaliknya, dan fungsinya setara dengan <code>[ordered]</code></p><p>Sehingga akan menghasilkan keluaran seperti ini ...</p><pre><code>Proto Local Address Foreign Address State     Process Name  
----- ------------- --------------- -----     ------------  
TCP   0.0.0.0:135   0.0.0.0:0       LISTENING svchost       
TCP   0.0.0.0:445   0.0.0.0:0       LISTENING System        
TCP   0.0.0.0:1279  0.0.0.0:0       LISTENING PlexDlnaServer
TCP   0.0.0.0:2869  0.0.0.0:0       LISTENING System  
</code></pre><p>Yang kemudian dapat Anda perlakukan seperti Anda memperlakukan objek dan filter PowerShell sesuai keinginan atau keluaran ke CSV atau apa pun yang perlu Anda lakukan. Itu terstruktur sekarang.</p><p>Bergantung pada versi PowerShell Anda, Anda juga dapat menggunakan <a href=https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.utility/convertfrom-string rel="nofollow noopener" target=_blank><code>Convert-FromString</code></a> yang mengambil string baris tunggal dan mengubahnya menjadi objek juga. Sesuatu yang lain untuk dicari.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/powershell-one-liner-untuk-menampilkan-proses-pada-baris-yang-sama-dengan-port-menggunakan-masalah-netstat-b5jh2kge/#answer-1 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/348943/matt target=_blank rel="nofollow noopener"><span itemprop=name>Matt</span></a>
—
<a href=https://superuser.com/a/1215237 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=1>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=1><ul class="list-group list-group-flush"><li class=list-group-item><div>Ini sangat membantu. Terima kasih atas bantuannya.</div><div>— <a href=https://superuser.com/users/726514/ric target=_blank rel="nofollow noopener">Ric</a></div></li><li class=list-group-item><div>Solusi Anda akan ideal tetapi tampaknya itu membutuhkan setidaknya Powershell 3 atau 4. Ketika dijalankan pada mesin Windows 7 itu segera error. Apakah mungkin membuat perubahan untuk menghindari ini? Kesalahannya adalah "Tidak dapat menemukan jenis [dipesan]: pastikan bahwa rakitan yang berisi jenis ini dimuat."</div><div>— <a href=https://superuser.com/users/726514/ric target=_blank rel="nofollow noopener">Ric</a></div></li><li class=list-group-item><div>Gips itu akan menyebabkan masalah ya. Mudah untuk diatasi. Saya akan menambahkan pembaruan cepat untuk Anda.</div><div>— <a href=https://superuser.com/users/348943/matt target=_blank rel="nofollow noopener">Matt</a></div></li><li class=list-group-item><div>Informasi proses tampaknya tidak tersedia di Windows 2012 (non-R2). Kemungkinan besar itu juga tidak tersedia di Windows 8.0.</div><div>— <a href=https://superuser.com/users/3677/thorarin target=_blank rel="nofollow noopener">Thorarin</a></div></li></ul></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>-1</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-2><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>-1</div><div class=card-body><div itemprop=text><p>Lebih sederhana ...</p><pre><code>filter timestamp {"$(Get-Date -Format G): $_"};netstat -abno 1 | Select-String -Context 0,1 -Pattern LISTENING|timestamp
</code></pre></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/powershell-one-liner-untuk-menampilkan-proses-pada-baris-yang-sama-dengan-port-menggunakan-masalah-netstat-b5jh2kge/#answer-2 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/871575/jhon-willmaure target=_blank rel="nofollow noopener"><span itemprop=name>Jhon Willmaure</span></a>
—
<a href=https://superuser.com/a/1294388 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div></div></div><div class="card shadow-sm my-2"><div class=card-header>Pertanyaan Serupa</div><ul class="list-group list-group-flush"><li class=list-group-item><div><a href=/posisi-absolut-css-tidak-berfungsi-di-ms-word-bkrzi9lc/>Posisi absolut CSS tidak berfungsi di MS Word</a></div></li><li class=list-group-item><div><a href=/apakah-ada-cara-untuk-membuka-pdf-secara-otomatis-di-halaman-tertentu-agvz9pxp/>Apakah ada cara untuk membuka pdf secara otomatis di halaman tertentu?</a></div></li><li class=list-group-item><div><a href=/menggunakan-kapabilitas-virtualbox-usb-rsdhyqbw/>Menggunakan kapabilitas VirtualBox USB</a></div></li><li class=list-group-item><div><a href=/tingkatkan-kecepatan-firefox-vwkvq9vk/>Tingkatkan Kecepatan Firefox?</a></div></li><li class=list-group-item><div><a href=/profile-dan-bash-profile-diabaikan-saat-memulai-tmux-dari-bashrc-ttixqotv/>.profile dan .bash_profile diabaikan saat memulai tmux dari .bashrc?</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-mengosongkan-memori-virtual-di-ubuntu-qfk6jl94/>Bagaimana cara mengosongkan memori virtual di Ubuntu?</a></div></li><li class=list-group-item><div><a href=/mengapa-bash-terkadang-melupakan-perintah-yang-diketik-sebelumnya-0ejz2uxi/>Mengapa bash terkadang melupakan perintah yang diketik sebelumnya?</a></div></li><li class=list-group-item><div><a href=/apakah-peristiwa-yang-difilter-di-monitor-proses-disimpan-dalam-memori-atau-di-disk-lf07tnoy/>Apakah peristiwa yang difilter di Monitor Proses disimpan dalam memori atau di disk?</a></div></li><li class=list-group-item><div><a href=/tombol-volume-terkadang-mengubah-volume-relatif-di-mixer-pokpinvd/>Tombol volume terkadang mengubah volume relatif di mixer</a></div></li><li class=list-group-item><div><a href=/pemberitahuan-status-raid-di-windows-2008-g36vn9p0/>Pemberitahuan Status RAID di Windows 2008?</a></div></li></ul></div></div><div class="mt-5 bg-light"><div class=container><div class="py-4 d-flex justify-content-between small text-muted"><div>By using our site, you agree to our <a href=/terms-of-service>Terms of Service</a>, <a href=/privacy-policy>Privacy Policy</a>, and <a href=/cookie-policy>Cookie Policy</a></div><div>Berlisensi di bawah <a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="nofollow noopener">CC BY-SA 4.0</a> dengan attribusi</div></div></div></div><script src=/js/jquery-3.5.1.min.js></script><script src=/js/bootstrap.bundle.min.js></script><script>$(document).ready(function(){$("#showQuestionReplies").click(function(){$("#questionRepliesContainer").toggleClass("d-none")}),$(".show-answer-replies").click(function(){var a=$(this).data("id");$(".answer-replies-container[data-id='"+a+"']").toggleClass("d-none")})})</script></body></html>