<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><title>Terowongan transparan antara antarmuka pada host jarak jauh</title><meta name=description content="Saya perlu membuat solusi yang akan berfungsi sebagai sakelar jaringan dengan dua port: satu port terletak di satu negara dan port kedua di negara lain.                +------------ Virtual switch ----------------++---------+   |   +-------+..."><link rel=canonical href=https://www.idxstack.com/terowongan-transparan-antara-antarmuka-pada-host-jarak-jauh-yd5mxxeg/><meta property="og:title" content="Terowongan transparan antara antarmuka pada host jarak jauh"><meta property="og:description" content="Saya perlu membuat solusi yang akan berfungsi sebagai sakelar jaringan dengan dua port: satu port terletak di satu negara dan port kedua di negara lain.                +------------ Virtual switch ----------------++---------+   |   +-------+..."><meta property="og:type" content="website"><meta property="og:url" content="https://www.idxstack.com/terowongan-transparan-antara-antarmuka-pada-host-jarak-jauh-yd5mxxeg/"><meta property="og:site_name" content="IDXStack"><meta property="og:locale" content="id_ID"><meta name=twitter:card content="summary"><meta name=twitter:title content="Terowongan transparan antara antarmuka pada host jarak jauh"><meta name=twitter:description content="Saya perlu membuat solusi yang akan berfungsi sebagai sakelar jaringan dengan dua port: satu port terletak di satu negara dan port kedua di negara lain.                +------------ Virtual switch ----------------++---------+   |   +-------+..."><link rel=stylesheet href=/css/style.min.c181a38d9857323db0ab0ad950bbd049d24d2f1d58d7566522f92aae4e1057df.css><link rel=stylesheet href=/vendor/fontawesome/css/all.min.css></head><body itemscope itemtype=https://schema.org/QAPage><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><div class=container><a href=/ class=navbar-brand>IDXStack</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a href=/ class=nav-link>Beranda</a></li></ul><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a href=/about-us class=dropdown-item>About</a>
<a href=/contact class=dropdown-item>Contact</a>
<a href=/disclaimer class=dropdown-item>Disclaimer</a></div></li></ul></div></div></nav><div class="container my-2" itemprop=mainEntity itemscope itemtype=https://schema.org/Question><div class="card shadow-sm mb-2"><div class=card-body><div class=mb-2><span class="badge badge-dark">Komputer</span></div><h1 class=h3 itemprop=name>Terowongan transparan antara antarmuka pada host jarak jauh</h1><div itemprop=text><p>Saya perlu membuat solusi yang akan berfungsi sebagai sakelar jaringan dengan dua port: satu port terletak di satu negara dan port kedua di negara lain.</p><pre><code>              +------------ Virtual switch ----------------+
+---------+   |   +-------+    +----------+    +-------+   |   +--------+
|Client A |&lt;--+--&gt;| BOX 1 |&lt;--&gt;|VPN server|&lt;--&gt;| BOX 2 |&lt;--+--&gt;|Client B|
+---------+   |   +-------+    +----------+    +-------+   |   +--------+
              +--------------------------------------------+
</code></pre><p>Klien A dan Klien B harus merasakannya seperti saklar layer 2 biasa. Koneksi VPN antara dua kotak adalah OpenVPN.
Jadi saya perlu meneruskan frame Ethernet entah bagaimana melalui terowongan VPN di antara dua kotak. Kotak 1 dan 2 menjalankan Debian jessie. Saya harap tidak menulis perangkat lunak saya sendiri untuk itu :)
Adakah yang bisa menyarankan solusi yang mungkin?</p><p>P.S. Diperlukan untuk menghubungkan dua perangkat keras yang dirancang untuk bekerja <strong>hanya</strong> di LAN.</p><p><strong>UPD:</strong> Saya telah menginstal 4 VM untuk mensimulasikan pengaturan seperti itu (vpnserver dihilangkan):<br>- Semua mesin adalah kotak debian<br>- Kotak 1 dan Kotak 2 memiliki terowongan keran GRE di antara keduanya (Ethernet melalui IP)<br>- Pada Klien Antarmuka lokal yang dijembatani dengan antarmuka gretap: bridge memiliki alamat 10.0.0.253<br>- Pada antarmuka lokal Klien B yang dijembatani dengan antarmuka gretap: bridge memiliki alamat 10.0.0.254<br>- Klien A memiliki IP statis 192.168.1.1<br>- Klien B memiliki IP statis 192.168.1.2</p><p>Dari Klien A saya mengirim permintaan ICMP Echo ke 192.168.1.2 dan saya dapat melihat permintaan ARP <em>"Siapa yang memiliki 192.168.1.2, beri tahu 192.168.1.1"</em> di jembatan di Kotak 1, di jembatan di Kotak 2 dan di Klien B. <strong>Tapi</strong> Respons ARP hanya terlihat pada Klien B. Jadi respons ARP tidak akan kembali ke Box2.
Dan semua jaringan antara 10.0.0.253 dan 10.0.0.254 berfungsi dengan baik. Jadi, saya kira masalah itu disebabkan oleh menjembatani.</p><p><strong>UPD2:</strong> Sekarang saya menghapus terowongan keran GRE dan membuat jaringan reguler antara Kotak 1 dan Kotak 2. Ketika saya membuat jembatan, ping mulai berfungsi. Apa yang bisa menyebabkan masalah saat melakukan terowongan GRE?</p><p><strong>Larutan:</strong> Saya akhirnya mengonfigurasi semuanya di VM dengan GRE-TAP. Saya telah menggunakan terowongan GRE-TAP melalui jaringan biasa antara Kotak 1 dan Kotak 2. Dan kemudian saya menjembatani antarmuka tunneling dengan antarmuka lokal di setiap Kotak. Di bawah ini adalah langkah-langkah saya:</p><p><strong>Kotak 1</strong></p><pre><code>ip link add tunnel0 type gretap remote 192.168.0.2 local 192.168.0.1
brctl addbr br0
brctl addif br0 eth2  # eth2 - is a local interface on Box 1
brctl addif br0 tunnel
ip addr add 10.0.0.253 dev tunnel0
ip link set br0 up
ip link set tunnel0 up
</code></pre><p><strong>Kotak 2</strong></p><pre><code>ip link add tunnel0 type gretap remote 192.168.0.1 local 192.168.0.2
brctl addbr br0
brctl addif br0 eth2  # eth2 - is a local interface on Box 2
brctl addif br0 tunnel
ip addr add 10.0.0.254 dev tunnel0
ip link set br0 up
ip link set tunnel0 up
</code></pre><p><strong>Terimakasih untuk semua!</strong></p></div></div><div class="card-footer bg-white d-flex justify-content-between"><div><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>4</span></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/703863/victor-crimea target=_blank rel="nofollow noopener"><span itemprop=name>victor_crimea</span></a>
—
<a href=https://superuser.com/questions/1185070/transparent-tunnel-between-interfaces-on-remote-hosts target=_blank rel="nofollow noopener">Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm" id=showQuestionReplies>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 d-none" id=questionRepliesContainer><ul class="list-group list-group-flush"><li class=list-group-item><div>Ini akan sangat sepele jika Anda dapat memiliki kedua tautan klien <b>langsung</b> ke server OpenVPN. Bisakah kamu melakukan itu? Juga: apakah OpenVPN dirutekan atau dijembatani? Apakah Anda mengontrol server OpenVPN?</div><div>— <a href=https://superuser.com/users/255732/mariusmatutiae target=_blank rel="nofollow noopener">MariusMatutiae</a></div></li><li class=list-group-item><div>Iya. Saya memiliki kendali atas Boxes dan server OpenVPN, namun saya tidak dapat mengonfigurasi Klien, itulah mengapa saya tidak dapat menghubungkannya ke jaringan VPN.</div><div>— <a href=https://superuser.com/users/703863/victor-crimea target=_blank rel="nofollow noopener">victor_crimea</a></div></li><li class=list-group-item><div>Openvpn dirutekan atau dijembatani? Apakah Anda menggunakan file <i>tong besar</i> atau a <i>keran</i> antarmuka?</div><div>— <a href=https://superuser.com/users/255732/mariusmatutiae target=_blank rel="nofollow noopener">MariusMatutiae</a></div></li><li class=list-group-item><div>Saya menggunakan vtund untuk membuat sirkuit Ethernet virtual</div><div>— <a href=https://superuser.com/users/69290/majenko target=_blank rel="nofollow noopener">Majenko</a></div></li><li class=list-group-item><div>Saya menggunakan antarmuka tun untuk OpenVPN, karena awalnya diinstal bukan untuk tujuan khusus ini. Jadi saya tidak dapat dengan mudah mengubah OpenVPN untuk menggunakan antarmuka ketuk.</div><div>— <a href=https://superuser.com/users/703863/victor-crimea target=_blank rel="nofollow noopener">victor_crimea</a></div></li></ul></div></div></div><hr><h2 class=h4><span itemprop=answerCount>2</span> Jawaban</h2><div class=form-row itemprop=acceptedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>5</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-0><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>5</div><div class=card-body><div itemprop=text><p>Saya belum mencobanya sendiri, tetapi saya tahu Anda dapat menggunakan <code>gretap</code> ke lapisan terowongan 2 (ethernet) di atas lapisan 3 (ip). Menurut mis. untuk ini <a href=http://blog.asiantuntijakaveri.fi/2012/01/layer-2-over-layer-3-using-linux-built.html rel="nofollow noopener" target=_blank>catatan blog</a> , Anda menyiapkan satu antarmuka <code>gretap</code> di setiap ujung dan menjembataninya dengan antarmuka ethernet Anda. Jika saya memahami semuanya dengan benar, dalam contoh <code>172.31.0.1</code> harus menjadi alamat titik akhir VPN di Kotak 1, dan <code>172.31.0.2</code> alamat titik akhir VPN di Kotak 2. <code>10.10.10.1</code> adalah alamat LAN lokal untuk Kotak 1, dan <code>10.10.10.2</code> alamat LAN untuk Kotak 2.</p><p>Kotak 1:</p><pre><code>ip link add gretap0 type gretap local 172.31.0.1 remote 172.31.0.2
ip link set dev gretap0 up
ip link set dev eth0 up
brctl addbr br0
brctl addif br0 gretap0
brctl addif br0 eth0
ip addr add 10.10.10.1/24 dev br0
ip link set br0 up
</code></pre><p>Kotak 2:</p><pre><code>ip link add gretap0 type gretap local 172.31.0.2 remote 172.31.0.1
ip link set dev gretap0 up
ip link set dev eth0 up
brctl addbr br0
brctl addif br0 gretap0
brctl addif br0 eth0
ip addr add 10.10.10.2/24 dev br0
ip link set br0 up
</code></pre><p>Anda mungkin perlu mengubah pengaturan MTU. Saya tidak dapat menguji pengaturan ini, jadi Anda mungkin juga perlu mengubah hal-hal lain.</p><p><strong>Sunting</strong> : <a href=http://backreference.org/2013/07/23/gre-bridging-ipsec-and-nfqueue/ rel="nofollow noopener" target=_blank>Sini</a> adalah artikel yang menjelaskan masalah MTU, tampaknya sedikit terlibat. Mungkin lebih mudah dalam kasus Anda jika Anda dapat mengontrol pengaturan VPN MTU.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/terowongan-transparan-antara-antarmuka-pada-host-jarak-jauh-yd5mxxeg/#answer-0 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/327880/dirkt target=_blank rel="nofollow noopener"><span itemprop=name>dirkt</span></a>
—
<a href=https://superuser.com/a/1185077 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=0>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=0><ul class="list-group list-group-flush"><li class=list-group-item><div>Saya ingin menghindari alamat Ip di Box di sisi lokal. Bisakah saya melakukannya dengan gretap?</div><div>— <a href=https://superuser.com/users/703863/victor-crimea target=_blank rel="nofollow noopener">victor_crimea</a></div></li><li class=list-group-item><div>Hanya saja, jangan menetapkan alamat IP ke bridge jika Anda tidak membutuhkan / menginginkannya.</div><div>— <a href=https://superuser.com/users/327880/dirkt target=_blank rel="nofollow noopener">dirkt</a></div></li><li class=list-group-item><div>Saya telah mensimulasikan penyiapan yang disarankan di VM dan ada masalah dengan aliran paket. Saya telah menambahkan penjelasan untuk pertanyaan.</div><div>— <a href=https://superuser.com/users/703863/victor-crimea target=_blank rel="nofollow noopener">victor_crimea</a></div></li><li class=list-group-item><div>BTW, menggunakan antarmuka <code>tap</code> untuk OpenVPN seperti yang disebutkan dalam jawaban lain akan menjadi solusi yang lebih baik, jika keadaan memungkinkan, karena ini menghindari satu lapisan enkapsulasi tambahan.</div><div>— <a href=https://superuser.com/users/327880/dirkt target=_blank rel="nofollow noopener">dirkt</a></div></li><li class=list-group-item><div>Saya sangat setuju dengan anda. Menggunakan keran akan menyebabkan overhead yang lebih rendah untuk kasus seperti itu.</div><div>— <a href=https://superuser.com/users/703863/victor-crimea target=_blank rel="nofollow noopener">victor_crimea</a></div></li></ul></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>1</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-1><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>1</div><div class=card-body><div itemprop=text><p>Ini tidak terlalu sulit, karena yang Anda minta hanyalah agar semua lalu lintas L2 dapat melewati dari satu jaringan ke jaringan lainnya, yang merupakan fitur standar dari a <a href=https://openvpn.net/index.php/open-source/documentation/miscellaneous/76-ethernet-bridging.html rel="nofollow noopener" target=_blank>menjembatani OpenVPN</a> koneksi. Artinya:</p><ol><li><p>baik Anda mengkonfigurasi server OpenVPN (dan dua klien) untuk mengatur koneksi OpenVPN yang dijembatani (dan ingat untuk mengizinkan koneksi dari klien ke klien lain melalui <em>klien-ke-klien</em> instruksi dalam file konfigurasi server), ...</p></li><li><p>atau Anda menyingkirkan perantara, dan langsung menghubungkan Box1 dan Box2, seperti yang dibahas misalnya <a href=https://docs.openvpn.net/how-to-tutorialsguides/virtual-platforms/site-to-site-layer-2-bridging-using-openvpn-access-server/ rel="nofollow noopener" target=_blank>sini</a> atau <a href=https://www.dd-wrt.com/wiki/index.php/OpenVPN_-_Site-to-Site_Bridged_VPN_Between_Two_Routers rel="nofollow noopener" target=_blank>sini</a> .</p></li></ol><p>Di <strong>antara</strong> kasus, Anda perlu bekerja pada DHCP dan merutekan masuk <em>kedua</em> LAN, karena keduanya <strong>harus</strong> milik domain siaran yang sama. Misalnya, kami dapat memutuskan bahwa subnet yang kami gunakan adalah <em>192.168.0.0/23</em> , dengan server DHCP di LAN1 yang membagikan alamat dalam jangkauan <em>192.168.0.0/24</em> , dan server DHCP di LAN2 yang membagikan alamat dalam jangkauan <em>192.168.1.0/24</em> .</p><p>Kemudian Anda perlu menyesuaikan rute. Misalkan Box1 adalah pc di LAN1 dengan alamat 192.168.0.121, dan Box2 adalah pc di LAN2 dengan alamat IP 192.168.1.173. Kemudian di gateway LAN1 Anda perlu menambahkan rute:</p><pre><code>ip route add 192.168.1.0/24 via 192.168.0.121 
</code></pre><p>sementara di gateway LAN2 Anda perlu menambahkan:</p><pre><code>ip route add 192.168.0.0/24 via 192.168.1.173
</code></pre><p>Ini menghasilkan sejumlah lalu lintas L2 intra-situs, yang mungkin mengganggu Anda. Saya memiliki konfigurasi tiga situs seperti ini, dan saya tidak memiliki masalah dengan jumlah lalu lintas, dan koneksi 100Mb / s, tetapi YMMV. Jika Anda ingin membatasi jumlah lalu lintas L2 yang melintasi OpenVPN, Anda dapat menggunakan <em>ebtables</em> di Box1 dan Box2.</p><p>Itulah satu-satunya cara yang saya tahu untuk menyadari apa yang Anda minta.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/terowongan-transparan-antara-antarmuka-pada-host-jarak-jauh-yd5mxxeg/#answer-1 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/255732/mariusmatutiae target=_blank rel="nofollow noopener"><span itemprop=name>MariusMatutiae</span></a>
—
<a href=https://superuser.com/a/1185135 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div></div></div><div class="card shadow-sm my-2"><div class=card-header>Pertanyaan Serupa</div><ul class="list-group list-group-flush"><li class=list-group-item><div><a href=/berbeda-ip-dari-ipconfig-dan-whatismyipaddresscom-rzimqhhv/>berbeda IP dari ipconfig dan whatismyipaddress.com</a></div></li><li class=list-group-item><div><a href=/jalankan-39screen-rd39-secara-otomatis-setelah-terhubung-dari-putty-428bls53/>Jalankan 'screen -RD' secara otomatis setelah terhubung dari PuTTY</a></div></li><li class=list-group-item><div><a href=/apakah-mysql-terinstal-secara-default-dengan-os-x-leopard-105-atau-106-bztrd4br/>Apakah MySQL terinstal secara default dengan OS X Leopard 10.5 atau 10.6</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-mempercantik-prompt-perintah-windows-yang-bodoh-sq7xt234/>Bagaimana cara mempercantik prompt perintah Windows yang bodoh?</a></div></li><li class=list-group-item><div><a href=/cara-mencetak-dengan-ghostscript-dalam-mode-senyap-fyhfmiwa/>Cara mencetak dengan ghostscript dalam mode senyap</a></div></li><li class=list-group-item><div><a href=/apakah-mungkin-untuk-mengkloning-hanya-perangkat-lunak-pada-mesin-6vagllvg/>Apakah mungkin untuk mengkloning hanya perangkat lunak pada mesin?</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-ssh-menjadi-host-tanpa-memulai-byobu-eecxwidf/>Bagaimana cara SSH menjadi host tanpa memulai byobu</a></div></li><li class=list-group-item><div><a href=/paksa-bookmark-firefox-untuk-memuat-di-tab-baru-7wvqbo3i/>Paksa bookmark Firefox untuk memuat di tab baru</a></div></li><li class=list-group-item><div><a href=/tidak-dapat-memutar-video-vine-instagram-di-chrome-h3t9lhal/>Tidak dapat memutar video Vine / Instagram di Chrome</a></div></li><li class=list-group-item><div><a href=/perintah-ls-dalam-skrip-bash-mengatakan-39tidak-ada-file-atau-direktori-seperti-itu39-ml2r1bsi/>Perintah Ls dalam skrip bash mengatakan 'Tidak ada file atau direktori seperti itu'</a></div></li></ul></div></div><div class="mt-5 bg-light"><div class=container><div class="py-4 d-flex justify-content-between small text-muted"><div>By using our site, you agree to our <a href=/terms-of-service>Terms of Service</a>, <a href=/privacy-policy>Privacy Policy</a>, and <a href=/cookie-policy>Cookie Policy</a></div><div>Berlisensi di bawah <a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="nofollow noopener">CC BY-SA 4.0</a> dengan attribusi</div></div></div></div><script src=/js/jquery-3.5.1.min.js></script><script src=/js/bootstrap.bundle.min.js></script><script>$(document).ready(function(){$("#showQuestionReplies").click(function(){$("#questionRepliesContainer").toggleClass("d-none")}),$(".show-answer-replies").click(function(){var a=$(this).data("id");$(".answer-replies-container[data-id='"+a+"']").toggleClass("d-none")})})</script></body></html>