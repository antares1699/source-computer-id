<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><title>Bagaimana cara menjalankan prosedur SQL yang tersimpan di Microsoft Excel?</title><meta name=description content="Bagaimana saya bisa menjalankan prosedur tersimpan di Microsoft Excel dan mendapatkan semua data yang dikembalikannya?"><link rel=canonical href=https://www.idxstack.com/bagaimana-cara-menjalankan-prosedur-sql-yang-tersimpan-di-microsoft-excel-l5xrhwan/><meta property="og:title" content="Bagaimana cara menjalankan prosedur SQL yang tersimpan di Microsoft Excel?"><meta property="og:description" content="Bagaimana saya bisa menjalankan prosedur tersimpan di Microsoft Excel dan mendapatkan semua data yang dikembalikannya?"><meta property="og:type" content="website"><meta property="og:url" content="https://www.idxstack.com/bagaimana-cara-menjalankan-prosedur-sql-yang-tersimpan-di-microsoft-excel-l5xrhwan/"><meta property="og:site_name" content="IDXStack"><meta property="og:locale" content="id_ID"><meta name=twitter:card content="summary"><meta name=twitter:title content="Bagaimana cara menjalankan prosedur SQL yang tersimpan di Microsoft Excel?"><meta name=twitter:description content="Bagaimana saya bisa menjalankan prosedur tersimpan di Microsoft Excel dan mendapatkan semua data yang dikembalikannya?"><link rel=stylesheet href=/css/style.min.c181a38d9857323db0ab0ad950bbd049d24d2f1d58d7566522f92aae4e1057df.css><link rel=stylesheet href=/vendor/fontawesome/css/all.min.css></head><body itemscope itemtype=https://schema.org/QAPage><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><div class=container><a href=/ class=navbar-brand>IDXStack</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a href=/ class=nav-link>Beranda</a></li></ul><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a href=/about-us class=dropdown-item>About</a>
<a href=/contact class=dropdown-item>Contact</a>
<a href=/disclaimer class=dropdown-item>Disclaimer</a></div></li></ul></div></div></nav><div class="container my-2" itemprop=mainEntity itemscope itemtype=https://schema.org/Question><div class="card shadow-sm mb-2"><div class=card-body><div class=mb-2><span class="badge badge-dark">Komputer</span></div><h1 class=h3 itemprop=name>Bagaimana cara menjalankan prosedur SQL yang tersimpan di Microsoft Excel?</h1><div itemprop=text><p>Bagaimana saya bisa menjalankan prosedur tersimpan di Microsoft Excel dan mendapatkan semua data yang dikembalikannya?</p></div></div><div class="card-footer bg-white d-flex justify-content-between"><div><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>4</span></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/81809/safran-ali target=_blank rel="nofollow noopener"><span itemprop=name>Safran Ali</span></a>
—
<a href=https://superuser.com/questions/325163/how-to-execute-a-stored-sql-procedure-in-microsoft-excel target=_blank rel="nofollow noopener">Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm" id=showQuestionReplies>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 d-none" id=questionRepliesContainer><ul class="list-group list-group-flush"><li class=list-group-item><div>Saya rasa ini menunjukkan betapa pentingnya pemberian tag yang benar. <a href=http://superuser.com/questions/325163/how-to-execute-a-stored-sql-procedure-in-microsoft-excel/325172#325172 target=_blank rel="nofollow noopener">Saat saya menjawab</a> , itu <i>vba</i> tag tidak ada di sana, dan saya pikir itu bukan pertanyaan vba ...</div><div>— <a href=https://superuser.com/users/82952/takrl target=_blank rel="nofollow noopener">takrl</a></div></li></ul></div></div></div><hr><h2 class=h4><span itemprop=answerCount>3</span> Jawaban</h2><div class=form-row itemprop=acceptedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>5</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-0><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>5</div><div class=card-body><div itemprop=text><p>Ini adalah pekerjaan untuk koneksi ADODB di VBA. Berikut link dengan kode sampel untuk kueri SELECT sederhana, tetapi ini juga akan menangani prosedur yang tersimpan.</p><p><a href="http://www.ozgrid.com/forum/showthread.php?t=83016&page=1" rel="nofollow noopener" target=_blank>http://www.ozgrid.com/forum/showthread.php?t=83016&page=1</a></p><p>Item utamanya adalah kebutuhan untuk mendeklarasikan <code>ADODB.Connection</code>, <code>ADODB.Recordset</code>, dan string koneksi yang cocok dengan database Anda. Setelah membuka koneksi, Anda menjalankan pernyataan SQL Anda menggunakan sintaks seperti berikut (diambil dari tautan):</p><pre><code>With cnt 
    .CursorLocation = adUseClient 
    .Open stADO    // stADO is the connection string.
    .CommandTimeout = 0 
    Set rst = .Execute(stSQL) 
End With
</code></pre><p>Kemudian pindahkan data dari kumpulan data Anda (<code>rst</code>, di atas) ke dalam rentang menggunakan <code>Range.CopyFromRecordSet</code>.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/bagaimana-cara-menjalankan-prosedur-sql-yang-tersimpan-di-microsoft-excel-l5xrhwan/#answer-0 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/76571/excellll target=_blank rel="nofollow noopener"><span itemprop=name>Excellll</span></a>
—
<a href=https://superuser.com/a/325214 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>1</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-1><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>1</div><div class=card-body><div itemprop=text><p>Saya tidak yakin tentang inkarnasi Excel terbaru, tetapi pada tahun 2000 dan 2003 yang dapat Anda lakukan hanyalah mengakses tampilan dan menampilkan datanya di lembar excel.</p><p>Keuntungan utama dari prosedur tersimpan adalah kemampuan untuk membuat parameter hasil, tetapi untuk itu Anda memerlukan semacam UI, dan Anda memerlukan cara untuk mengubah definisi kueri secara terprogram setelah didefinisikan pertama kali dalam excel. Kami tidak menemukan cara untuk melakukan ini, tetapi menggunakan tampilan menyediakan fungsionalitas yang cukup untuk apa yang perlu kami lakukan.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/bagaimana-cara-menjalankan-prosedur-sql-yang-tersimpan-di-microsoft-excel-l5xrhwan/#answer-1 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/82952/takrl target=_blank rel="nofollow noopener"><span itemprop=name>takrl</span></a>
—
<a href=https://superuser.com/a/325172 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>1</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-2><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>1</div><div class=card-body><div itemprop=text><p>VBA ini sangat mirip dengan jawaban @ Excellll, dan saya telah menggunakannya untuk memberikan pengaruh yang baik dalam pekerjaan saya.</p><p>Gunakan fungsi utilitas kecil ini:</p><pre><code>Public Function IsEmptyRecordset(rs As Recordset) As Boolean
     IsEmptyRecordset = ((rs.BOF = True) And (rs.EOF = True))
End Function
</code></pre><p>Dan kemudian inilah fungsi besarnya (saya minta maaf atas penyelarasan paragraf yang tampak jelek):</p><pre><code>Option Explicit

Public Sub OpenConnection()
Dim conn As ADODB.Connection
Dim str As String
Dim cmd As ADODB.Command
Dim rs As ADODB.Recordset
Dim myPath
Dim fld
Dim i As Integer

On Error GoTo errlbl


'Open database connection
Set conn = New ADODB.Connection

'First, construct the connection string.

'NOTE:  YOU CAN DO THIS WITH A STRING SPELLING OUT THE ENTIRE CONNECTION...
'conn.ConnectionString = _
'    "Provider=Microsoft.Jet.OLEDB.4.0;" &amp; _
'    "Data Source=" &amp; _
'    myPath &amp; "\ConnectionTest.mdb"

'...OR WITH AN ODBC CONNECTION YOU'VE ALREADY SET UP:
conn.ConnectionString = "DSN=myDSN"

conn.Open       'Here's where the connection is opened.

Debug.Print conn.ConnectionString  'This can be very handy to help debug!

Set rs = New ADODB.Recordset
'Construct string.  This can "Select" statement constructed on-the-fly,
'str = "Select * from vwMyView order by Col1, Col2, Col3"  
'or an "Execute" statement:
str = "exec uspMyStoredProc"

rs.Open str, conn, adOpenStatic, adLockReadOnly  ‘recordset is opened here

If Not IsEmptyRecordset(rs) Then     
    rs.MoveFirst

    'Populate the first row of the sheet with recordset’s field names
    i = 0
    For Each fld In rs.Fields
        Sheet1.Cells(1, i + 1).Value = rs.Fields.Item(i).Name
        i = i + 1
    Next fld
    'Populate the sheet with the data from the recordset
    Sheet1.Range("A2").CopyFromRecordset rs     


Else
    MsgBox "Unable to open recordset, or unable to connect to database.", _
       vbCritical, "Can't get requested records"

End If

'Cleanup
rs.Close
Set rs = Nothing
conn.Close
Set conn = Nothing

exitlbl:
  Debug.Print "Error: " &amp; Err.Number
  If Err.Number = 0 Then
    MsgBox "All data has been pulled and placed on Sheet1", vbOKOnly, "All Done."
  End If
  Exit Sub
errlbl:
   MsgBox "Error #: " &amp; Err.Number &amp; ", Description:  " &amp; Err.Description, _     vbCritical, "Error in OpenConnection()"
Exit Sub
'Resume exitlbl
End Sub
</code></pre><p>Semoga ini membantu.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/bagaimana-cara-menjalankan-prosedur-sql-yang-tersimpan-di-microsoft-excel-l5xrhwan/#answer-2 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/55392/f106dart target=_blank rel="nofollow noopener"><span itemprop=name>F106dart</span></a>
—
<a href=https://superuser.com/a/325234 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div></div></div><div class="card shadow-sm my-2"><div class=card-header>Pertanyaan Serupa</div><ul class="list-group list-group-flush"><li class=list-group-item><div><a href=/apakah-mungkin-untuk-menjadwalkan-laptop-saya-untuk-membisukan-dan-menyuarakan-pada-waktu-tertentu-rbatjtfu/>Apakah mungkin untuk menjadwalkan laptop saya untuk membisukan dan menyuarakan pada waktu tertentu?</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-melihat-konten-volume-ebs-yang-dilampirkan-ke-instans-ec2-melalui-terminal-kkhz2zrv/>Bagaimana cara melihat konten volume EBS yang dilampirkan ke instans EC2 melalui Terminal?</a></div></li><li class=list-group-item><div><a href=/ekstensi-pgcrypto-diinstal-tetapi-fungsinya-tidak-tersedia-en9uuzqh/>Ekstensi pgcrypto diinstal tetapi fungsinya tidak tersedia</a></div></li><li class=list-group-item><div><a href=/apakah-disarankan-untuk-memperbarui-ke-driver-grafis-intel-non-oem-di-laptop-7ireqohi/>Apakah disarankan untuk memperbarui ke driver grafis Intel non-OEM di laptop?</a></div></li><li class=list-group-item><div><a href=/notepad-mengasumsikan-ekstensi-file-txt-saat-memuat-dari-baris-perintah-fpgcwg8y/>Notepad ++ mengasumsikan ekstensi file .txt saat memuat dari baris perintah</a></div></li><li class=list-group-item><div><a href=/cara-mengaktifkan-quotpenerusan-paketquot-di-os-x-xbdtapvl/>Cara mengaktifkan "penerusan paket" di OS X</a></div></li><li class=list-group-item><div><a href=/listrik-statis-mengikat-halaman-selama-pencetakan-4seatiz8/>listrik statis mengikat halaman selama pencetakan</a></div></li><li class=list-group-item><div><a href=/apakah-buku-kindle-bebas-drm-masih-dapat-dibaca-di-aplikasi-kindle-untuk-pc-8nykm0e5/>Apakah buku Kindle bebas DRM masih dapat dibaca di aplikasi Kindle untuk PC?</a></div></li><li class=list-group-item><div><a href=/tidak-dapat-menyingkirkan-ask-toolbar-di-windows-8-cyml1ojl/>Tidak dapat menyingkirkan Ask Toolbar di Windows 8</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-memastikan-keaslian-sebuah-gambar-5trcxhwi/>Bagaimana cara memastikan keaslian sebuah gambar?</a></div></li></ul></div></div><div class="mt-5 bg-light"><div class=container><div class="py-4 d-flex justify-content-between small text-muted"><div>By using our site, you agree to our <a href=/terms-of-service>Terms of Service</a>, <a href=/privacy-policy>Privacy Policy</a>, and <a href=/cookie-policy>Cookie Policy</a></div><div>Berlisensi di bawah <a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="nofollow noopener">CC BY-SA 4.0</a> dengan attribusi</div></div></div></div><script src=/js/jquery-3.5.1.min.js></script><script src=/js/bootstrap.bundle.min.js></script><script>$(document).ready(function(){$("#showQuestionReplies").click(function(){$("#questionRepliesContainer").toggleClass("d-none")}),$(".show-answer-replies").click(function(){var a=$(this).data("id");$(".answer-replies-container[data-id='"+a+"']").toggleClass("d-none")})})</script></body></html>