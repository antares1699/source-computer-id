<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><title>Bagaimana cara melakukan SSH dengan benar ke server di belakang NAT dengan tetap menjaga keamanan seketat mungkin?</title><meta name=description content="Saya memiliki VPC di Amazon AWS. Ada Server NAT yang berjalan di Subnet Publik yang terhubung ke Gateway Internet. Saya memiliki banyak server yang berjalan di berbagai subnet pribadi dalam VPC. Saya..."><link rel=canonical href=https://www.idxstack.com/bagaimana-cara-melakukan-ssh-dengan-benar-ke-server-di-belakang-nat-dengan-tetap-menjaga-keamanan-seketat-mungkin-u1ovhnfd/><meta property="og:title" content="Bagaimana cara melakukan SSH dengan benar ke server di belakang NAT dengan tetap menjaga keamanan seketat mungkin?"><meta property="og:description" content="Saya memiliki VPC di Amazon AWS. Ada Server NAT yang berjalan di Subnet Publik yang terhubung ke Gateway Internet. Saya memiliki banyak server yang berjalan di berbagai subnet pribadi dalam VPC. Saya..."><meta property="og:type" content="website"><meta property="og:url" content="https://www.idxstack.com/bagaimana-cara-melakukan-ssh-dengan-benar-ke-server-di-belakang-nat-dengan-tetap-menjaga-keamanan-seketat-mungkin-u1ovhnfd/"><meta property="og:site_name" content="IDXStack"><meta property="og:locale" content="id_ID"><meta name=twitter:card content="summary"><meta name=twitter:title content="Bagaimana cara melakukan SSH dengan benar ke server di belakang NAT dengan tetap menjaga keamanan seketat mungkin?"><meta name=twitter:description content="Saya memiliki VPC di Amazon AWS. Ada Server NAT yang berjalan di Subnet Publik yang terhubung ke Gateway Internet. Saya memiliki banyak server yang berjalan di berbagai subnet pribadi dalam VPC. Saya..."><link rel=stylesheet href=/css/style.min.c181a38d9857323db0ab0ad950bbd049d24d2f1d58d7566522f92aae4e1057df.css><link rel=stylesheet href=/vendor/fontawesome/css/all.min.css></head><body itemscope itemtype=https://schema.org/QAPage><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><div class=container><a href=/ class=navbar-brand>IDXStack</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a href=/ class=nav-link>Beranda</a></li></ul><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a href=/about-us class=dropdown-item>About</a>
<a href=/contact class=dropdown-item>Contact</a>
<a href=/disclaimer class=dropdown-item>Disclaimer</a></div></li></ul></div></div></nav><div class="container my-2" itemprop=mainEntity itemscope itemtype=https://schema.org/Question><div class="card shadow-sm mb-2"><div class=card-body><div class=mb-2><span class="badge badge-dark">Komputer</span></div><h1 class=h3 itemprop=name>Bagaimana cara melakukan SSH dengan benar ke server di belakang NAT dengan tetap menjaga keamanan seketat mungkin?</h1><div itemprop=text><p>Saya memiliki VPC di Amazon AWS. Ada Server NAT yang berjalan di Subnet Publik yang terhubung ke Gateway Internet. Saya memiliki banyak server yang berjalan di berbagai subnet pribadi dalam VPC. Saya ingin SSH ke server yang ada di subnet pribadi. Semua server saya menjalankan AWS Linux (CentOS).</p><p>Saat ini, saya dapat melakukan SSH ke Server NAT menggunakan kunci pribadi saya. Server NAT memungkinkan koneksi SSH hanya dari IP pengembangan saya saat ini. Kemudian saya dapat SSH ke server di subnet pribadi hanya jika saya mengatur Login SSH di server tersebut, atau jika saya meletakkan file kunci di server NAT dan kemudian menggunakannya untuk SSH. Demi keamanan, sepertinya saya tidak boleh melakukan salah satu dari hal ini.</p><p>Adakah cara praktik terbaik yang disukai untuk membuat hubungan ini? Sepertinya harus ada cara untuk terhubung dengan satu panggilan SSH dari mesin pengembangan rumah saya yang menjalankan Apple OSX.</p></div></div><div class="card-footer bg-white d-flex justify-content-between"><div><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>4</span></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/69669/t-brian-jones target=_blank rel="nofollow noopener"><span itemprop=name>T. Brian Jones</span></a>
—
<a href=https://superuser.com/questions/826805/how-do-i-properly-ssh-into-a-server-behind-a-nat-while-maintaining-the-tightest target=_blank rel="nofollow noopener">Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm" id=showQuestionReplies>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 d-none" id=questionRepliesContainer><ul class="list-group list-group-flush"><li class=list-group-item><div>lupa bertanya - OS klien mana yang Anda gunakan? Yang saya jelaskan wirks di Unix / Linux, tetapi teknik ini juga berfungsi di Windows dengan PuTTY. Cukup berantakan untuk mengatur penerusan port dengan PuTTY dan membuatnya mengerti itu harus menggunakan nama lain sebagai localhost untuk kunci yang disajikan dengan ...</div><div>— <a href=https://superuser.com/users/72257/florenz-kley target=_blank rel="nofollow noopener">Florenz Kley</a></div></li><li class=list-group-item><div>Semua server menjalankan Amazon Linux (CentOS) dan saya menjalankan OSX secara lokal. Menambahkan detail ini ke pertanyaan.</div><div>— <a href=https://superuser.com/users/69669/t-brian-jones target=_blank rel="nofollow noopener">T. Brian Jones</a></div></li><li class=list-group-item><div>Luar biasa! itu hanya pengaturan yang saya gunakan, OS X di sisi klien. Sisi server tidak terlalu penting. Lihat jawaban saya - edit entri host "terowongan" di ~ / .ssh / config Anda dan tambahkan beberapa entri yang menggunakan terowongan tersebut.</div><div>— <a href=https://superuser.com/users/72257/florenz-kley target=_blank rel="nofollow noopener">Florenz Kley</a></div></li></ul></div></div></div><hr><h2 class=h4><span itemprop=answerCount>3</span> Jawaban</h2><div class=form-row itemprop=acceptedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>3</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-0><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>3</div><div class=card-body><div itemprop=text><p>Anda tidak boleh meletakkan kunci rahasia Anda di gateway, dan Anda tidak perlu :-)</p><p>atur konfigurasi SSH lokal Anda sehingga Anda dapat menggunakan gateway NAT untuk penerusan port saat Anda membutuhkannya:</p><p>buat entri di <code>~/.ssh/config</code> Anda yang mengatur penerusan lokal ke host yang ingin Anda sambungkan:</p><pre><code>Host natgw-fwd
        User ec2-user
        HostKeyAlias natgw-fwd.my.domain
        HostName 54.182.32.11
        LocalForward 1025 10.0.2.1:22
</code></pre><p>lalu tambahkan satu entri per host yang diteruskan dengan <code>HostKeyAlias</code>:</p><pre><code>Host internal-one
        User ec2-user
        HostKeyAlias internal-one.ec2.internal
        HostName localhost
        Port 1025
</code></pre><p>bawa terowongan ke dalam satu cangkang:</p><pre><code>ssh -C -v natgw-fwd
</code></pre><p>dan sambungkan ke host internal di shell lain:</p><pre><code>ssh internal-one
</code></pre><p>Saat menggunakan banyak koneksi "cepat + pendek" selain satu atau dua shell, seperti alat seperti dsh, latensi untuk penyiapan dan penghancuran koneksi tunggal menjadi lebih terlihat, dan saya menggunakan <code>ControlMaster</code> dan <code>ControlPath</code> untuk mengaktifkan berbagi koneksi. Batasan tidak mengganggu saya karena saya jarang menggunakan agen atau X11 dalam skenario seperti itu.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/bagaimana-cara-melakukan-ssh-dengan-benar-ke-server-di-belakang-nat-dengan-tetap-menjaga-keamanan-seketat-mungkin-u1ovhnfd/#answer-0 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/72257/florenz-kley target=_blank rel="nofollow noopener"><span itemprop=name>Florenz Kley</span></a>
—
<a href=https://superuser.com/a/826833 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=0>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=0><ul class="list-group list-group-flush"><li class=list-group-item><div>INI BEKERJA BESAR. Memecahkan masalah saya berikutnya yang SSHing dari Editor Teks GUI (Coda) saya. Beberapa catatan ... Anda hanya perlu entri LocalForward pertama di konfigurasi Host natgw-fwd. Juga, untuk orang lain, HostKeyAlias ​​bisa apa saja. Selanjutnya, jika Anda menggunakan kunci publik untuk masuk ke server, Anda harus menyetel direktif <code>IdentityFile</code> untuk kedua host ke lokasi file kunci publik Anda. Terakhir, saat masuk dengan editor teks seperti Coda atau TextWrangler, pertama-tama <code>$ssh -C natgw-fwd</code> dari baris perintah. Kemudian login dengan editor teks Anda dengan menghubungkan melalui SFTP ke <code>localhost</code> pada port <code>1025</code>.</div><div>— <a href=https://superuser.com/users/69669/t-brian-jones target=_blank rel="nofollow noopener">T. Brian Jones</a></div></li><li class=list-group-item><div>@ T.BrianJones senang mendengarnya bekerja untuk Anda. Dua komentar: 1) jika Anda menggunakan ssh-agent Anda tidak perlu mengkonfigurasi <code>IdentityFile</code>, itu akan mencoba setiap identitas yang dimuat di rantai kunci agen 2) Saya sering berpindah jaringan, tetapi perlu terhubung ke host yang sama, jadi saya tetap <code>Host</code> entri stabil, dan konfigurasikan satu entri "penerusan lingkungan X" dan satu entri "lingkungan Y" lainnya, dengan pernyataan <code>LocalForward</code> yang sama</div><div>— <a href=https://superuser.com/users/72257/florenz-kley target=_blank rel="nofollow noopener">Florenz Kley</a></div></li><li class=list-group-item><div>Tips tambahan: 1) Ya, Anda dapat memiliki lebih dari satu direktif LocalForward per host. 2) Berikan opsi -N ke perintah ssh untuk membuka terowongan jika Anda tidak akan menjalankan perintah apa pun, yaitu Anda <i>hanya</i> membuka terowongan. 3) Juga berikan opsi -f ke perintah ssh yang membuka terowongan untuk menjalankannya di latar belakang.</div><div>— <a href=https://superuser.com/users/200246/dgvid target=_blank rel="nofollow noopener">dgvid</a></div></li></ul></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>3</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-1><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>3</div><div class=card-body><div itemprop=text><p>Saya melakukan beberapa penelitian dan menemukan sebuah artikel yang tampaknya terkait dengan apa yang Anda tanyakan.</p><blockquote><p>Server SSH dan bastion</p><p>Secara default, instans Linux di EC2 menggunakan file kunci SSH untuk autentikasi, bukan nama pengguna dan sandi SSH. Menggunakan file kunci dapat mengurangi kemungkinan seseorang mencoba menebak kata sandi untuk mendapatkan akses ke instance. Namun menggunakan pasangan kunci dengan bastion host dapat menimbulkan tantangan — menghubungkan ke instance di subnet pribadi memerlukan kunci pribadi, tetapi Anda tidak boleh menyimpan kunci pribadi di bastion.</p><p>Salah satu solusinya adalah dengan menggunakan penerusan agen SSH (ssh-agent) pada klien. Ini memungkinkan administrator untuk terhubung dari bastion ke instance lain tanpa menyimpan kunci pribadi di bastion tersebut. Itulah pendekatan yang akan saya bahas di posting ini.</p></blockquote><p><a href=http://blogs.aws.amazon.com/security/post/Tx3N8GFK85UN1G6/Securely-connect-to-Linux-instances-running-in-a-private-Amazon-VPC rel="nofollow noopener" target=_blank>http://blogs.aws.amazon.com/security/post/Tx3N8GFK85UN1G6/Securely-connect-to-Linux-instances-running-in-a-private-Amazon-VPC</a></p><p>Semoga Anda akan menemukan solusi dalam membuat bastion server dan menggunakan penerusan agen SSH di klien Anda seperti yang direkomendasikan artikel ini.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/bagaimana-cara-melakukan-ssh-dengan-benar-ke-server-di-belakang-nat-dengan-tetap-menjaga-keamanan-seketat-mungkin-u1ovhnfd/#answer-1 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/379946/don-king target=_blank rel="nofollow noopener"><span itemprop=name>Don King</span></a>
—
<a href=https://superuser.com/a/826825 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>0</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-2><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>0</div><div class=card-body><div itemprop=text><p>Jawaban @Don King sangat membantu dan ini dia <a href=http://blogs.aws.amazon.com/security/post/Tx3N8GFK85UN1G6/Securely-connect-to-Linux-instances-running-in-a-private-Amazon-VPC rel="nofollow noopener" target=_blank>tutorial</a> dia menyarankan. Ini memiliki instruksi untuk OSX dan Windows.</p><p>Berikut adalah ringkasan dari apa yang saya lakukan saat masuk dari mesin OSX lokal. Ini mengasumsikan bahwa infrastruktur dasar di VPC Anda sudah benar. Lihat ini <a href=http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Scenario2.html rel="nofollow noopener" target=_blank>tutorial</a> untuk detailnya.</p><ol><li><p>Buka koneksi SSH keluar di grup keamanan NAT yang memungkinkan koneksi ke grup keamanan server di subnet pribadi.</p></li><li><p>Buka koneksi SSH masuk pada grup keamanan server di subnet pribadi yang memungkinkan koneksi dari grup keamanan NAT.</p></li><li><p>Di OSX, tambahkan public_key.pem Anda ke rantai kunci lokal Anda: <code>ssh-add -K .aws/public_key.pem</code></p></li><li><p>SSH dari mesin lokal Anda ke NAT menggunakan -A (ssh-agent): <code>ssh -A ec2-user@ip_of_nat</code></p></li><li><p>SSH dari NAT ke server di subnet publik: <code>ssh ec2-user@ip_of_private_server</code></p></li></ol><p><strong>Potensi Masalah:</strong></p><ul><li>pastikan ForwardAgent disetel ke yes di file OSX / etc / ssh_config Anda. Ini harus ya secara default.</li></ul></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/bagaimana-cara-melakukan-ssh-dengan-benar-ke-server-di-belakang-nat-dengan-tetap-menjaga-keamanan-seketat-mungkin-u1ovhnfd/#answer-2 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/69669/t-brian-jones target=_blank rel="nofollow noopener"><span itemprop=name>T. Brian Jones</span></a>
—
<a href=https://superuser.com/a/826897 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=2>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=2><ul class="list-group list-group-flush"><li class=list-group-item><div>itu dua langkah per koneksi, sulit untuk membuat skrip karena ini (lupakan dsh) dan menggunakan penerusan auth dianggap bermasalah pada host bersama. Tutorialnya bagus, tetapi mengapa saya ingin mengetik barang dua kali ketika saya dapat memiliki shell saya dengan satu perintah?</div><div>— <a href=https://superuser.com/users/72257/florenz-kley target=_blank rel="nofollow noopener">Florenz Kley</a></div></li><li class=list-group-item><div>Saya akhirnya menggunakan solusi @Florenz Kley. Ini membutuhkan sedikit lebih banyak pengaturan, tetapi memecahkan masalah untuk dapat menggunakan SSH dari editor teks GUI seperti Coda atau TextWrangler. Lihat komentar saya tentang solusi itu untuk detailnya.</div><div>— <a href=https://superuser.com/users/69669/t-brian-jones target=_blank rel="nofollow noopener">T. Brian Jones</a></div></li></ul></div></div></div></div></div><div class="card shadow-sm my-2"><div class=card-header>Pertanyaan Serupa</div><ul class="list-group list-group-flush"><li class=list-group-item><div><a href=/linux-sesuai-perintah-dengan-presisi-detik-t5cfhwvf/>Linux sesuai perintah dengan presisi detik</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-menggunakan-wmic-untuk-membunuh-contoh-cmdexe-yang-mencari-dengan-baris-perintahnya-cirjxpwp/>Bagaimana cara menggunakan wmic untuk membunuh contoh cmd.exe yang mencari dengan baris perintahnya?</a></div></li><li class=list-group-item><div><a href=/cara-mengaktifkan-menonaktifkan-perangkat-keras-dari-baris-perintah-windows-7-4i3hau8r/>Cara mengaktifkan / menonaktifkan perangkat keras dari baris perintah Windows 7</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-membuat-ctrl-k-menampilkan-beranda-google-biasa-di-firefox-miwt4psx/>Bagaimana cara membuat ctrl-k menampilkan beranda Google biasa di Firefox?</a></div></li><li class=list-group-item><div><a href=/membuat-alias-untuk-npm-menggunakan-cmder-di-windows-5f9gn08s/>Membuat alias untuk NPM menggunakan cmder di Windows</a></div></li><li class=list-group-item><div><a href=/tingkatkan-versi-dari-server-2008-x64-ke-windows-7-x64-wfiqgta3/>Tingkatkan versi dari Server 2008 x64 ke Windows 7 x64</a></div></li><li class=list-group-item><div><a href=/apa-perbedaan-antara-ukuran-byte-untuk-dd-2gh3alce/>Apa perbedaan antara ukuran byte untuk DD</a></div></li><li class=list-group-item><div><a href=/keluarkan-item-yang-muncul-2-kali-dan-lebih-banyak-xamgklbl/>Keluarkan item yang muncul 2 kali dan lebih banyak</a></div></li><li class=list-group-item><div><a href=/bagaimana-saya-bisa-terus-memantau-penggunaan-ram-komputer-saya-ijffkgzk/>Bagaimana saya bisa terus memantau penggunaan RAM komputer saya?</a></div></li><li class=list-group-item><div><a href=/bwapp-sambungan-gagal-quotakses-ditolak-untuk-39root39-at-39localhost39-penggunaquot-saat-mengklik-instal-ti4yszak/>bWAPP: Sambungan gagal: "Akses ditolak untuk 'root' @ 'localhost' pengguna" saat mengklik instal</a></div></li></ul></div></div><div class="mt-5 bg-light"><div class=container><div class="py-4 d-flex justify-content-between small text-muted"><div>By using our site, you agree to our <a href=/terms-of-service>Terms of Service</a>, <a href=/privacy-policy>Privacy Policy</a>, and <a href=/cookie-policy>Cookie Policy</a></div><div>Berlisensi di bawah <a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="nofollow noopener">CC BY-SA 4.0</a> dengan attribusi</div></div></div></div><script src=/js/jquery-3.5.1.min.js></script><script src=/js/bootstrap.bundle.min.js></script><script>$(document).ready(function(){$("#showQuestionReplies").click(function(){$("#questionRepliesContainer").toggleClass("d-none")}),$(".show-answer-replies").click(function(){var a=$(this).data("id");$(".answer-replies-container[data-id='"+a+"']").toggleClass("d-none")})})</script></body></html>