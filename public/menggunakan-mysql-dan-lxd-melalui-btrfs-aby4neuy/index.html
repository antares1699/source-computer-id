<!doctype html><html lang=id><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><title>Menggunakan MySQL dan LxD melalui Btrfs</title><meta name=description content="Saya memiliki workstation Ubuntu 16.04, dengan filesystem ext4.  Saat bermain dengan LxD, saya ingin memiliki file  secepat kilat  kemampuan memotret (karena gambar saya biasanya besar). Kemampuan ini, menurut pemahaman saya, hanya dapat..."><link rel=canonical href=https://www.idxstack.com/menggunakan-mysql-dan-lxd-melalui-btrfs-aby4neuy/><meta property="og:title" content="Menggunakan MySQL dan LxD melalui Btrfs"><meta property="og:description" content="Saya memiliki workstation Ubuntu 16.04, dengan filesystem ext4.  Saat bermain dengan LxD, saya ingin memiliki file  secepat kilat  kemampuan memotret (karena gambar saya biasanya besar). Kemampuan ini, menurut pemahaman saya, hanya dapat..."><meta property="og:type" content="website"><meta property="og:url" content="https://www.idxstack.com/menggunakan-mysql-dan-lxd-melalui-btrfs-aby4neuy/"><meta property="og:site_name" content="IDXStack"><meta property="og:locale" content="id_ID"><meta name=twitter:card content="summary"><meta name=twitter:title content="Menggunakan MySQL dan LxD melalui Btrfs"><meta name=twitter:description content="Saya memiliki workstation Ubuntu 16.04, dengan filesystem ext4.  Saat bermain dengan LxD, saya ingin memiliki file  secepat kilat  kemampuan memotret (karena gambar saya biasanya besar). Kemampuan ini, menurut pemahaman saya, hanya dapat..."><link rel=stylesheet href=/css/style.min.c181a38d9857323db0ab0ad950bbd049d24d2f1d58d7566522f92aae4e1057df.css><link rel=stylesheet href=/vendor/fontawesome/css/all.min.css></head><body itemscope itemtype=https://schema.org/QAPage><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><div class=container><a href=/ class=navbar-brand>IDXStack</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a href=/ class=nav-link>Beranda</a></li></ul><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a href=/about-us class=dropdown-item>About</a>
<a href=/contact class=dropdown-item>Contact</a>
<a href=/disclaimer class=dropdown-item>Disclaimer</a></div></li></ul></div></div></nav><div class="container my-2" itemprop=mainEntity itemscope itemtype=https://schema.org/Question><div class="card shadow-sm mb-2"><div class=card-body><div class=mb-2><span class="badge badge-dark">Komputer</span></div><h1 class=h3 itemprop=name>Menggunakan MySQL dan LxD melalui Btrfs</h1><div itemprop=text><p>Saya memiliki workstation Ubuntu 16.04, dengan filesystem ext4.</p><ol><li>Saat bermain dengan LxD, saya ingin memiliki file <strong>secepat kilat</strong> kemampuan memotret (karena gambar saya biasanya besar). Kemampuan ini, menurut pemahaman saya, hanya dapat dicapai jika sistem file pendukung adalah sistem file CoW seperti Btrfs.</li></ol><p><em>(Catatan: Satu-satunya peringatan terkait kinerja utama untuk Btrf yang saya temukan sejauh ini adalah penggunaan yang disarankan dari bendera pemasangan <code>noatime</code>.)</em></p><ol start=2><li>Tetapi karena saya juga memiliki instance MySQL pada sistem ini yang kinerjanya tidak ingin saya lihat menderita (relatif terhadap sistem file ext4), saya memutuskan untuk melakukan pemeriksaan terakhir untuk setiap masalah potensial dengan peralihan saya ke MySQL yang didukung Btrfs. Dan, <a href=https://mariadb.com/blog/what-best-linux-filesystem-mariadb rel="nofollow noopener" target=_blank>Lihat apa yang kutemukan</a> :</li></ol><blockquote><p>Biasanya yang terbaik adalah me-mount Btrfs dengan opsi <code>'nodatacow'</code>, menonaktifkan copy-on-write, karena COW menyebabkan fragmentasi, dish thrashing, dan lonjakan CPU dan RAM ketika Anda memiliki banyak penulisan acak.</p></blockquote><p>Sekarang, itu tampaknya menjadi peredam yang nyata!</p><p><strong>Pertanyaan:</strong> Apakah ada cara agar saya dapat memiliki snapshotting cepat dan instance MySQL yang berkinerja baik dengan Btrfs?</p></div></div><div class="card-footer bg-white d-flex justify-content-between"><div><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>4</span></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/126082/harry target=_blank rel="nofollow noopener"><span itemprop=name>Harry</span></a>
—
<a href=https://superuser.com/questions/1142695/using-mysql-and-lxd-over-btrfs target=_blank rel="nofollow noopener">Sumber</a></div></div></div><hr><h2 class=h4><span itemprop=answerCount>2</span> Jawaban</h2><div class=form-row itemprop=acceptedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>4</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-0><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>4</div><div class=card-body><div itemprop=text><p><strong>Fragmentasi adalah efek samping yang sebagian besar tidak dapat dihindari dari sistem file yang dirancang dengan copy-on-write.</strong> Itu juga yang memungkinkan snapshot sistem file hampir gratis di tempat pertama.</p><p>Alasannya cukup sederhana: Setiap kali sebuah blok diubah, blok baru harus ditulis ke beberapa lokasi selain dari blok asli. Jadi meskipun file awalnya bersebelahan, itu tidak akan terjadi setelah diubah.</p><p>Saya tidak tahu bagaimana Btrfs <code>nodatacow</code> berinteraksi dengan snapshot, tetapi saya merasa bahwa saat Anda memiliki snapshot pada dataset, Anda memaksakan setidaknya sebagian perilaku copy-on-write tidak peduli flag apa yang Anda gunakan; jika tidak, bagaimana Anda bisa mengakses data lama melalui snapshot?</p><p>Namun, <strong>ini tidak diberikan bahwa ini akan sangat mempengaruhi kinerja MySQL Anda,</strong> karena dua alasan:</p><ul><li>Disk modern benar-benar cukup cepat untuk beban kerja pengguna tunggal (yang menurut saya paling Anda minati karena Anda menyebutkan bahwa sistem Anda adalah "stasiun kerja")</li><li>Sistem operasi modern memiliki algoritme caching yang cukup baik, sehingga mengurangi kebutuhan untuk benar-benar mencapai penyimpanan fisik</li></ul><p>Sekadar memberi Anda gambaran, saya menjalankan ZFS sendiri (dari mana Btrfs meminjam banyak ide), dan saat ini ada scrub yang sedang berlangsung. Kumpulan yang dimaksud adalah raidz2 enam disk, yang tidak benar-benar dikenal karena kinerjanya yang luar biasa, secara fisik didukung oleh enam disk 7200 rpm (dua SATA, empat SAS) yang juga tidak terlalu dikenal untuk IOPS bintang pada khususnya. Sebuah scrub ZFS menavigasi seluruh pohon Merkle pada disk, membaca semua data, dan memverifikasi checksum pada semuanya untuk memastikan semuanya membaca kembali seperti yang ditulis sebelumnya; dalam kasus saya, menghitung hash SHA-256 untuk semua hal di sepanjang jalan. Kecepatan scrub saat ini (setelah melewati bagian awal yang padat metadata, yang melibatkan pencarian berat) sedang melayang <strong>sekitar 200 MB / s</strong> dan benar-benar mendaki dengan lambat. Dan itu sebenarnya <em>piring</em> I / O, tanpa melibatkan caching (karena caching tidak masuk akal saat Anda ingin memverifikasi apa yang ada di penyimpanan persisten).</p><p>Tentu, sangat mungkin Anda akan melihat beberapa penurunan kinerja dari fragmentasi jika Anda pindah ke sistem file salin-saat-tulis. Tapi Anda tidak bisa makan kue dan menyimpannya juga; jika cuplikan cepat dan berbiaya rendah adalah sesuatu yang Anda inginkan, kemungkinan besar Anda harus melepaskan sesuatu yang lain untuk mendapatkannya.</p><p><strong>Apa yang akan saya lakukan dalam kasus Anda adalah patokan.</strong> Siapkan beberapa penyimpanan Btrfs, letakkan salinan database MySQL di sana, dan lihat bagaimana keduanya bekerja di bawah beban kerja yang wajar.</p></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/menggunakan-mysql-dan-lxd-melalui-btrfs-aby4neuy/#answer-0 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/53590/user target=_blank rel="nofollow noopener"><span itemprop=name>user</span></a>
—
<a href=https://superuser.com/a/1142731 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=0>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=0><ul class="list-group list-group-flush"><li class=list-group-item><div>Apakah ada cara agar saya dapat mempertahankan sistem file ext4 utama OS host saya sebagaimana adanya (untuk MySQL dll), tetapi entah bagaimana membuat LxD menggunakan direktori <code>/var/lib/lxcfs</code> dan <code>/var/lib/lxd</code> yang didukung Btrfs? Misalnya, saya dapat membuat 'perangkat' berbasis file 1TB pada host ext4fs saya, memasangnya sebagai perangkat loop, memformatnya dengan Btrfs dan 'entah bagaimana' (tidak tahu bagaimana caranya!) Membuat instalasi LxD saya menggunakan itu <code>/var/lib/...</code> direktori dari perangkat Btrfs ini.</div><div>— <a href=https://superuser.com/users/126082/harry target=_blank rel="nofollow noopener">Harry</a></div></li><li class=list-group-item><div>@Harry saya curiga ada. ZFS mendukung vdev yang didukung file dengan baik (meskipun ini bukan pengaturan yang disarankan, itu <i>aku s</i> sangat berguna untuk pengujian), dan saya tidak melihat mengapa Btrfs akan berbeda. Paling banyak, Anda perlu menggunakan <code>losetup</code> untuk mengkonfigurasi perangkat loopback yang didukung oleh file tersebut. Meskipun saya sangat merekomendasikan untuk tidak menggunakan <i>jarang</i> file untuk tujuan dukungan sistem file kecuali murni sebagai pengujian; karakteristik kinerja sepertinya <i>mengerikan</i> karena Anda akan mendapatkan minimal <i>dua</i> lapisan fragmentasi, bukan satu: File dukungan, dan konten sistem file.</div><div>— <a href=https://superuser.com/users/53590/user target=_blank rel="nofollow noopener">user</a></div></li></ul></div></div></div></div></div><div class=form-row itemprop=suggestedAnswer itemscope itemtype=https://schema.org/Answer><div class="col-12 col-md-2 col-lg-1"><div class="card shadow-sm mb-2 d-none d-md-block"><div class="card-body text-center px-1 py-3"><i class="far fa-heart fa-fw text-danger"></i><span itemprop=upvoteCount>2</span></div></div></div><div class="col-12 col-md-10 col-lg-11"><div class="card mb-2 shadow-sm" id=answer-1><div class="card-header d-block d-md-none"><i class="far fa-heart fa-fw text-danger"></i>2</div><div class=card-body><div itemprop=text><p>Saya mencoba komentar saya sendiri, dan semuanya tampaknya berfungsi dengan baik. Alternatif yang lebih baik masih diterima.</p><p>Inilah yang saya lakukan.</p><pre><code># 1. Initial, onetime setup.
#   1.a) Create a sparse, 20G file.
      $ truncate -s 20G disk.20g

#   1.b) Format the loopback device with Btrfs.
      $ losetup /dev/loop0 disk.20g
      $ mkfs.btrfs /dev/loop0

# 2. Do this every time you wish to actually start using LxD.
# Note: Replace '/dev/loop0' with whatever loop-device is free on your system.
  $ sudo service lxd stop
  $ sudo mkdir -p /var/lib/lxd
  $ sudo mount -o noatime /dev/loop0 /var/lib/lxd
  $ sudo service lxd start

# 3. Do this to gracefully 'shutdown' the effects of Step 2.
  $ sudo service lxd stop
  $ sudo umount /var/lib/lxd
  $ losetup -d /dev/loop0
  $ sudo service lxd start
</code></pre><p>Jadi, untuk mengulangi:</p><ol><li>Sistem file utama OS host saya adalah Ext4. File <code>disk.20g</code> di atas berada pada sistem file ini saja. Sistem file ini dapat terus menjadi host MySQL dan perangkat lunak lain yang kinerjanya dapat dipengaruhi secara negatif oleh Btrfs.</li><li>LxD menyimpan image dan containernya di partisi Btrfs. Ini memungkinkan pengambilan gambar yang sangat cepat.</li></ol></div></div><div class="card-footer text-right bg-white d-flex justify-content-between"><div><a href=https://www.idxstack.com/menggunakan-mysql-dan-lxd-melalui-btrfs-aby4neuy/#answer-1 itemprop=url>Bagikan</a></div><div itemprop=author itemscope itemtype=https://schema.org/Person><a href=https://superuser.com/users/126082/harry target=_blank rel="nofollow noopener"><span itemprop=name>Harry</span></a>
—
<a href=https://superuser.com/a/1142941 rel="nofollow noopener" target=_blank>Sumber</a></div></div></div><div class=form-row><div class="col-2 col-lg-1"></div><div class="col-10 col-lg-11"><div class=mb-2><button class="btn btn-secondary btn-sm show-answer-replies" data-id=1>Tampilkan Balasan</button></div><div class="card shadow-sm mb-2 answer-replies-container d-none" data-id=1><ul class="list-group list-group-flush"><li class=list-group-item><div>Tapi kenapa tidak menggunakan partisi?</div><div>— <a href=https://superuser.com/users/219095/daniel-b target=_blank rel="nofollow noopener">Daniel B</a></div></li><li class=list-group-item><div>Tentu saja bisa. Dalam kasus saya, saya hanya memiliki 1 drive fisik dengan ext4fs, tanpa ruang untuk pengeditan partisi lebih lanjut.</div><div>— <a href=https://superuser.com/users/126082/harry target=_blank rel="nofollow noopener">Harry</a></div></li></ul></div></div></div></div></div><div class="card shadow-sm my-2"><div class=card-header>Pertanyaan Serupa</div><ul class="list-group list-group-flush"><li class=list-group-item><div><a href=/apa-definisi-microsoft-untuk-pertahankan-dengan-berikutnya-pertahankan-baris-bersama-dan-kontrol-janda-yatim-piatu-bjja60ck/>Apa definisi Microsoft untuk `pertahankan dengan berikutnya`,` pertahankan baris bersama, `dan` kontrol janda / yatim piatu? `</a></div></li><li class=list-group-item><div><a href=/ubah-pdf-berwarna-menjadi-putih-hitam-scmguvzb/>Ubah PDF berwarna menjadi putih / hitam</a></div></li><li class=list-group-item><div><a href=/lisensi-windows-8-pada-pc-baru-dapatkah-saya-menghapus-hdd-7wlmibqe/>Lisensi Windows 8 pada PC baru - dapatkah saya menghapus HDD?</a></div></li><li class=list-group-item><div><a href=/excel-masukan-pengguna-tetapi-tetap-menggunakan-rumus-untuk-dua-sel-melingkar-ely6g9xj/>Excel - masukan pengguna tetapi tetap menggunakan rumus untuk dua sel melingkar</a></div></li><li class=list-group-item><div><a href=/apa-yang-terjadi-dengan-pemasangan-google-chrome-saya-pbneqs0s/>Apa yang terjadi dengan Pemasangan Google Chrome saya</a></div></li><li class=list-group-item><div><a href=/usb-ke-hdmi-hanya-menggunakan-kabel-aawyeuby/>USB ke HDMI hanya menggunakan kabel</a></div></li><li class=list-group-item><div><a href=/seret-dan-lepas-menggunakan-touchpad-notebook-nc7c3hpd/>Seret dan lepas menggunakan touchpad notebook?</a></div></li><li class=list-group-item><div><a href=/apakah-ada-batasan-jumlah-perangkat-yang-dapat-saya-gunakan-dengan-catu-daya-2xydrcwc/>Apakah ada batasan jumlah perangkat yang dapat saya gunakan dengan catu daya</a></div></li><li class=list-group-item><div><a href=/apa-itu-sandforce-internal-f787nso5/>Apa itu SandForce_Internal?</a></div></li><li class=list-group-item><div><a href=/bagaimana-cara-mengakses-mini-pc-saya-raspberrypi-mk802-mele-a1000-via-apc-melalui-ethernet-wifi-tanpa-memiliki-monitor-vpeqcwbm/>Bagaimana cara mengakses mini-pc saya (RaspberryPi / MK802 / Mele A1000 / VIA APC) melalui ethernet / wifi tanpa memiliki Monitor?</a></div></li></ul></div></div><div class="mt-5 bg-light"><div class=container><div class="py-4 d-flex justify-content-between small text-muted"><div>By using our site, you agree to our <a href=/terms-of-service>Terms of Service</a>, <a href=/privacy-policy>Privacy Policy</a>, and <a href=/cookie-policy>Cookie Policy</a></div><div>Berlisensi di bawah <a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="nofollow noopener">CC BY-SA 4.0</a> dengan attribusi</div></div></div></div><script src=/js/jquery-3.5.1.min.js></script><script src=/js/bootstrap.bundle.min.js></script><script>$(document).ready(function(){$("#showQuestionReplies").click(function(){$("#questionRepliesContainer").toggleClass("d-none")}),$(".show-answer-replies").click(function(){var a=$(this).data("id");$(".answer-replies-container[data-id='"+a+"']").toggleClass("d-none")})})</script></body></html>