{"title":"Bagaimana saya dapat menggunakan Monit untuk memantau layanan yang tidak memiliki file / var / run / pid atau bagaimana cara membuat file pid?","draft":false,"url":"/bagaimana-saya-dapat-menggunakan-monit-untuk-memantau-layanan-yang-tidak-memiliki-file-var-run-pid-atau-bagaimana-cara-membuat-file-pid-1ecjlg8p","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["systemd","pid","monit"],"snippet":"Saya menggunakan Debian 9.8  Saya memiliki layanan yang menjalankan program dotnet saya. Saya ingin memantaunya dengan monit tetapi di semua contoh, Anda perlu merujuk file .pid di / var / run tetapi...","body":"<p> Saya menggunakan Debian 9.8 </p>\n\n<p> Saya memiliki layanan yang menjalankan program dotnet saya. Saya ingin memantaunya dengan monit tetapi di semua contoh, Anda perlu merujuk file .pid di / var / run tetapi program dotnet saya tidak memiliki file .pid di / var / run. </p>\n\n<p> Jadi saya menambahkan PIDFile = / var / run / testservice.pid ke file .service untuk layanan saya tetapi tidak membuat file saat saya memulainya. </p>\n\n<p> Di sinilah saya berada </p>\n\n<p> ini adalah file .service saya </p> <pre><code>[Unit]\nDescription=Test Service\nWants=network-online.target influxdb.service\nAfter=network-online.target influxdb.service\n\n[Service]\nUser=testservice\nGroup=mainapp\nSyslogIdentifier=testservice\nPIDFile=/var/run/testservice.pid\n\nRestart=on-failure\nTimeoutStopSec=5\nRestartSec=10\n\nExecStart=/usr/bin/dotnet /mainapp/app/TestSystemdService.dll\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>","source":"https://superuser.com/questions/1409899/how-can-i-use-monit-to-monitor-a-service-that-does-not-have-a-var-run-pid-file","author":"<a href=\"https://superuser.com/users/368794/thecolonel26\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">TheColonel26</span></a>","replies":[],"answers":[{"answer":"<p> Jika yang Anda inginkan hanyalah mengetahui apakah layanan sedang berjalan, Anda dapat meminta systemd: </p> <pre><code>systemctl is-active TestApp.service\n</code></pre> <p> Anda juga dapat memeriksa apakah itu tidak aktif secara khusus karena kegagalan yang diketahui: </p> <pre><code>systemctl is-failed TestApp.service\n</code></pre> <p><a href=\"https://mmonit.com/monit/documentation/monit.html#PROGRAM-STATUS-TEST\" rel=\"nofollow noopener\" target=\"_blank\"> Menurut dokumen, </a> ini dapat dimasukkan ke dalam monit sebagai <code>check program â€¦ with path</code>: </p> <pre><code>check program TestApp with path \"systemctl --quiet is-active TestApp\"\n    if status != 0 then ...\n</code></pre> <hr>\n\n<p> Perhatikan bahwa systemd&#39;s <code>PIDFile=</code> adalah untuk memberi tahu init ke mana harus <em> Baca </em> PID dari. Jika daemon itu sendiri tidak membuat pidfile, systemd pasti tidak akan mengganggu. Jika Anda benar-benar membutuhkannya, Anda dapat memiliki <code>ExecStartPost=/bin/sh -c \"echo $MAINPID &gt; /run/testapp.pid\"</code> atau yang serupa. </p>","votes":"7","source":"https://superuser.com/a/1409917","author":"<a href=\"https://superuser.com/users/1686/user1686\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">user1686</span></a>","replies":[]},{"answer":"<p> Monit juga memiliki opsi untuk mencocokkan proses menggunakan regex. </p>\n\n<p> Jadi, pertama-tama Anda akan melakukannya dari shell: (untuk pengujian) </p>\n\n<p> <code>monit procmatch 'program'</code> </p>\n\n<p> Ini akan mencocokkan proses dengan uptime tertinggi.\nKemudian Anda dapat menambahkan konfigurasi monit: </p> <pre><code>check process myprogram matching 'progr.*'\n     start program = /bin/app\n     stop program = something..\n</code></pre>","votes":"5","source":"https://superuser.com/a/1409972","author":"<a href=\"https://superuser.com/users/374350/fugitive\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">fugitive</span></a>","replies":[]}]}
