{"title":"jumlah vlookup menggunakan rumus array","draft":false,"url":"/jumlah-vlookup-menggunakan-rumus-array-hqu0trwp","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["microsoft-excel","worksheet-function"],"snippet":"Saya memiliki tabel pembayaran seperti itu:  account | amount--------+-------  101   | 3  101   | 5  102   | 7  103   | 9  Saya menamai rentang tabel ini &quot;pembayaran&quot;. Kolom pertamanya saya sebut...","body":"<p> Saya memiliki tabel pembayaran seperti itu: </p> <pre><code>account | amount\n--------+-------\n  101   | 3\n  101   | 5\n  102   | 7\n  103   | 9\n</code></pre> <p> Saya menamai rentang tabel ini &quot;pembayaran&quot;. Kolom pertamanya saya sebut &quot;akun&quot;. Kolom keduanya saya sebut &quot;jumlah&quot;. </p>\n\n<p> Saya juga memiliki tabel lain yang menetapkan akun ke grup: </p> <pre><code>account | group\n--------+-------\n  101   | 1\n  102   | 1\n  103   | 2\n</code></pre> <p> Saya menamai rentang tabel ini &quot;grup&quot;. </p>\n\n<p> Sekarang saya ingin menjumlahkan semua pembayaran akun grup 1 hanya menggunakan satu rumus, tanpa menggunakan kolom tambahan. Saya mencoba melakukannya dengan menggunakan rumus array seperti: </p> <pre><code>sum(if(vlookup(accounts,groups,2,false)=1,amounts,0))\n</code></pre> <p> Saya juga mencoba rumus array seperti itu: </p> <pre><code>sumif(if(vlookup(accounts,groups,2,false)=1,amounts,0))\n</code></pre> <p> Rumus ini tidak berfungsi. Saya rasa saya tahu mengapa - tampaknya fungsi <code>vlookup</code> tidak mengembalikan array ketika digunakan dalam rumus array satu sel. </p>\n\n<p> Jadi, bagaimana cara menghitungnya menggunakan satu rumus? </p>","source":"https://superuser.com/questions/557447/sum-of-vlookup-using-array-formula","author":"<a href=\"https://superuser.com/users/156440/user983447\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">user983447</span></a>","replies":[],"answers":[{"answer":"<p> Hampir 7 tahun kemudian, saya membawa solusi <code>VLOOKUP()</code> dengan rumus array tunggal :) </p>\n\n<p><a href=\"https://stackoverflow.com/questions/47187863/can-excels-index-function-return-array/59311618#59311618\" target=\"_blank\" rel=\"nofollow noopener\"> https://stackoverflow.com/questions/47187863/can-excels-index-function-return-array/59311618#59311618 </a></p>\n\n<p> Rumus dengan seluruh kolom akan memerlukan konstruksi <code>IFERROR(VLOOKUP();0)</code> untuk menangani tajuk, jika tidak, SUM akan mengembalikan kesalahan <code>#VALUE</code>. </p>\n\n<p><a href=\"https://i.stack.imgur.com/JphJ0.png\" rel=\"nofollow noopener\" target=\"_blank\"> Tangkapan layar Excel </a></p> <pre><code>    A         B       C   D         E       F   G       H\n  +—————————+———————+———+—————————+———————+———+———————+————————————————\n1 | account | group |   | account | group |   | group | total amount\n  |---------+-------+---+---------+-------+---+-------+----------------\n2 | 101     | 1     |   | 101     | 1     |   | 1     | {FORMULA HERE}\n3 | 102     | 1     |   | 102     | 1     |   |       | \n4 | 103     | 2     |   | 103     | 2     |   |       | \n</code></pre> <blockquote>\n  <p> <code>{FORMULA HERE}</code> </p>\n</blockquote>\n\n<p> en-us </p> <pre><code>=SUM(IF(IFERROR(VLOOKUP(N(IF({1},$A:$A)),$D:$E,2,0),0)=$G$2,$B:$B,0))\n</code></pre> <p> fr-fr </p> <pre><code>=SOMME(SI(SIERREUR(RECHERCHEV(N(SI({1};$A:$A));$D:$E;2;0);0)=$G$2;$B:$B;0))\n</code></pre> <p> Validasi rumus array dengan <kbd> CTRL </kbd> + <kbd> BERGESER </kbd> + <kbd> MEMASUKKAN </kbd></p>","votes":"2","source":"https://superuser.com/a/1509855","author":"<a href=\"https://superuser.com/users/375442/hymced\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">hymced</span></a>","replies":[]},{"answer":"<p> Menurut saya, Anda dapat mencapai apa yang Anda cari menggunakan rumus berikut: </p> <pre><code>=SUMPRODUCT(B1:B4*(LOOKUP(A1:A4,C1:C3,D1:D3)=1))\n</code></pre> <p> <code>=1</code> mengacu pada nomor grup yang Anda cari akunnya. Perhatikan bahwa ini adalah rumus biasa, bukan rumus larik. </p>\n\n<p> Saya telah menggunakan referensi sel biasa sebagai lawan dari wilayah bernama, karena menurut saya itu membuatnya lebih mudah untuk menghubungkan rumus ke lembar XLS. </p>\n\n<p> Tangkapan layar berikut menunjukkan di mana nilai yang berbeda berada dan menyertakan rumus yang sedikit lebih umum yang dapat Anda gunakan untuk melakukan perhitungan yang sama untuk grup yang berbeda dengan menyeret sudut kanan bawah sel <code>F1</code>. </p>\n\n<p><img src=\"https://i.stack.imgur.com/CSZT1.png\" alt=\"Screenshot showing values and more generic function\" class=\"img-fluid d-block my-2\" loading=\"lazy\"></p>\n\n<p> Jika Anda ingin tetap menggunakan nama, Anda harus memperkenalkan nama yang berbeda untuk kolom dengan akun. rumusnya akan terlihat seperti ini: </p> <pre><code>=SUMPRODUCT(Payments*(LOOKUP(Accounts1,Accounts2,Groups)=1))\n</code></pre> <p> Demi kelengkapan, simak dulu <a href=\"http://support.microsoft.com/kb/324986\" rel=\"nofollow noopener\" target=\"_blank\"> Cara menggunakan fungsi LOOKUP di Excel </a> untuk kondisi di mana Anda dapat menggunakan <code>LOOKUP</code>. </p>","votes":"3","source":"https://superuser.com/a/557448","author":"<a href=\"https://superuser.com/users/165694/reinier-torenbeek\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Reinier Torenbeek</span></a>","replies":[{"reply":"Menggunakan LOOKUP adalah pendekatan yang valid, Reinier, tetapi ada beberapa kemungkinan kerugian - pertama untuk <code>LOOKUP</code> agar berfungsi dengan benar, &quot;rentang pencarian&quot; [C1: C3] harus diurutkan menaik (sesuai contoh, tetapi saya tidak tahu apakah itu bisa dijamin) dan kedua jika salah satu kode akun1 tidak muncul di daftar akun2 maka Anda akan mendapatkan kesalahan atau &quot;kecocokan palsu&quot; - pendekatan saya tidak memiliki potensi kerugian tersebut","author":"<a href=\"https://superuser.com/users/111645/barry-houdini\" target=\"_blank\" rel=\"nofollow noopener\">barry houdini</a>"},{"reply":"@barryhoudini Untuk pernyataan masalah, <code>LOOKUP</code> adalah fungsi yang benar. Dan sisi baiknya, bukankah menurut Anda formula yang dihasilkan lebih elegan dan lebih mudah dirawat daripada, misalnya, milik Anda ;-)? Tetapi dari sudut pandang pendidikan, Anda benar, saya seharusnya menyebutkan itu. Saya memperpanjang jawabannya.","author":"<a href=\"https://superuser.com/users/165694/reinier-torenbeek\" target=\"_blank\" rel=\"nofollow noopener\">Reinier Torenbeek</a>"},{"reply":"@ user983447 Senang bisa membantu. Lihat tautan yang saya tambahkan, atau komentar barry houdini, untuk kondisi di mana pendekatan ini menggunakan <code>LOOKUP</code> bekerja.","author":"<a href=\"https://superuser.com/users/165694/reinier-torenbeek\" target=\"_blank\" rel=\"nofollow noopener\">Reinier Torenbeek</a>"},{"reply":"lebih elegan dan lebih mudah dirawat? Ya, pasti, jawaban yang bagus! Mungkin saya mencoba untuk mengatasi masalah yang tidak ada","author":"<a href=\"https://superuser.com/users/111645/barry-houdini\" target=\"_blank\" rel=\"nofollow noopener\">barry houdini</a>"}]},{"answer":"<p> Ya, Anda benar, <code>VLOOKUP</code> tidak akan mengembalikan array sehingga Anda memerlukan pendekatan lain. Asumsikan bahwa kolom pertama grup disebut <code>accounts2</code> dan kolom kedua adalah <code>numbers</code> kemudian coba rumus array ini, </p> <pre><code>=SUM(IF(ISNUMBER(MATCH(accounts,IF(numbers=1,accounts2),0)),amounts))\n</code></pre> <p> konfirmasi dengan <kbd> CTRL </kbd> + <kbd> BERGESER </kbd> + <kbd> MEMASUKKAN </kbd></p>","votes":"2","source":"https://superuser.com/a/557449","author":"<a href=\"https://superuser.com/users/111645/barry-houdini\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">barry houdini</span></a>","replies":[{"reply":"Sejauh yang saya bisa lihat, itu tidak berhasil.","author":"<a href=\"https://superuser.com/users/156440/user983447\" target=\"_blank\" rel=\"nofollow noopener\">user983447</a>"},{"reply":"apakah Anda menggunakan CTRL + SHIFT + ENTER? Jika Anda menggunakan kombinasi tombol itu, Anda akan mendapatkan {and} di sekitar rumus dan mudah-mudahan juga mendapatkan hasil yang benar","author":"<a href=\"https://superuser.com/users/111645/barry-houdini\" target=\"_blank\" rel=\"nofollow noopener\">barry houdini</a>"}]}]}
