{"title":"sed - melakukan hanya penggantian yang cocok pertama (ke-n)?","draft":false,"url":"/sed-melakukan-hanya-penggantian-yang-cocok-pertama-ke-n-pacy8qwe","votes":"4","answers_count":"6","categories":["Komputer"],"tags":["bash","sed"],"snippet":"Pertimbangkan saya memiliki file berikut:  echo \"1234123412341234\" &gt; ztest  Di sini saya hanya ingin mengubah 1...","body":"<p> Pertimbangkan saya memiliki file berikut: </p> <pre><code>echo \"1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\n\" &gt; ztest\n</code></pre> <p> Di sini saya hanya ingin mengubah <code>1</code> yang pertama menjadi <code>5</code> dan membiarkan yang lainnya tetap utuh. </p>\n\n<p> Saya tahu <code>sed</code> memiliki perintah <code>quit</code> - jadi saya mencoba yang berikut: </p> <pre><code>$ sed 's/1/{5;q}/' ztest \n{5;q}\n2\n3\n4\n{5;q}\n2\n3\n4\n{5;q}\n2\n3\n4\n{5;q}\n2\n3\n4\n</code></pre> <p> Ini mengubah semua baris, jadi itu tidak baik. Jadi, saya coba ini: </p> <pre><code>$ sed '{s/1/5/;q}' ztest \n5\n</code></pre> <p> Sekarang, ini tampaknya melakukan seperti yang diminta - mengubah baris pertama dan keluar; namun, saya ingin baris lainnya utuh! ( <em> karena ini, pada dasarnya memiliki efek mengganti seluruh file dengan satu &#39;5&#39; </em> ) </p>\n\n<p> Jadi saya bingung sintaks seperti apa yang dibutuhkan? Perhatikan bahwa saya memerlukan ini untuk mengubah baris &quot;awal&quot; dalam file gigabyte sebaris (menggunakan <code>sed -i</code>); jadi saya ingin <code>sed</code> hanya mencari dan mengganti di bagian singkat pertama - dan setelah itu, baris keluaran tidak berubah ( <em> sejak <code>sed -i</code> bagaimanapun membuang ke dalam file temp pertama, dan kemudian menimpa aslinya </em> ); berharap dapat menghemat waktu pemrosesan. </p>\n\n<p> Terima kasih sebelumnya atas jawaban apa pun, <br> Bersulang! </p>\n\n<p> EDIT: lupa subquestion: apakah mungkin untuk memperpanjang ini ke n pertandingan pertama? (katakanlah, dalam file di atas, dua &#39;1 pertama diubah menjadi 5 - sisanya adalah keluaran kata demi kata?) </p>","source":"https://superuser.com/questions/394282/sed-perform-only-first-nth-matched-replacement","author":"<a href=\"https://superuser.com/users/39752/sdaau\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">sdaau</span></a>","replies":[{"reply":"Apakah Anda terjebak dengan <code>sed</code> saja?","author":"<a href=\"https://superuser.com/users/71809/mat\" target=\"_blank\" rel=\"nofollow noopener\">Mat</a>"},{"reply":"HI @ Mat - tidak juga; hanya yang pertama yang saya gunakan ketika saya tidak mengganti file teks sebaris - saran lain apa pun dipersilakan!","author":"<a href=\"https://superuser.com/users/39752/sdaau\" target=\"_blank\" rel=\"nofollow noopener\">sdaau</a>"},{"reply":"situasi yang sama <a href=\"http://stackoverflow.com/questions/148451/how-to-use-sed-to-replace-only-the-first-occurrence-in-a-file\" target=\"_blank\" rel=\"nofollow noopener\"> sini </a>","author":"User"},{"reply":"Terima kasih banyak untuk tautan itu, @selman - Saya suka trik dengan baris 0 ( <i> seperti pada <code>0,&#47;Apple&#47;{s&#47;Apple&#47;Banana&#47;}</code> </i> ) dari sana - selamat!","author":"<a href=\"https://superuser.com/users/39752/sdaau\" target=\"_blank\" rel=\"nofollow noopener\">sdaau</a>"}],"answers":[{"answer":"<p> Saya telah melihatnya di tempat lain di situs ini: </p> <pre><code>sed '/1/{s/1/5/;:a;n;ba}' ztest\n</code></pre> <p> Jadi setelah Anda menemukan kejadian pertama, Anda mengulang sampai akhir baris membaca dan mencetak file. </p>\n\n<p><strong> Memperbarui </strong></p>\n\n<p> Itu dapat ditingkatkan untuk hanya menggantikan pertandingan ke-N. Idenya adalah untuk menyimpan <code>X</code> di setiap pertandingan di ruang tunggu, dan ketika semua <code>X</code> ada di sana, putar hingga akhir file. Di bawah, skrip yang menggantikan kejadian ke-2: </p> <pre><code>sed '/1/{G;s/\\nX\\{1\\}//;tend;x;s/^/X/;x;P;d};p;d;:end;s/1/5/;:a;n;ba'\n</code></pre> <p> Perhatikan bahwa Anda perlu meletakkan (N-1) antara <code>\\{</code> dan <code>\\}</code>. </p>\n\n<p><strong> Perbarui 2 </strong></p>\n\n<p> Saya menyadari bahwa <code>P;d</code> di atas tidak berguna jika <code>p;d</code> â€‹â€‹diganti dengan <code>P;d</code>. Jadi solusi yang lebih sederhana adalah: </p> <pre><code>sed '/1/{G;s/\\nX\\{1\\}//;tend;x;s/^/X/;x};P;d;:end;s/1/5/;:a;n;ba'\n</code></pre>","votes":"8","source":"https://superuser.com/a/394284","author":"<a href=\"https://superuser.com/users/90834/jfg956\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">jfg956</span></a>","replies":[{"reply":"Terima kasih banyak untuk @jfgagne itu - Saya berharap <code>sed</code> bisa merujuk ke pertandingan ke-n; dan senang melihat contoh (saya harus memoles sintaks <code>sed</code> saya, meskipun :)) Cheers!","author":"<a href=\"https://superuser.com/users/39752/sdaau\" target=\"_blank\" rel=\"nofollow noopener\">sdaau</a>"},{"reply":"Satu peringatan. Perintah sed OS / X (bahkan di El Capitan) tidak mengenali {} dan hanya akan menyepak dengan pesan kesalahan berikut: <code>sed: 1: &quot;&#47;1&#47;{s&#47;1&#47;5&#47;;:a;n;ba}&quot;: unexpected EOF (pending }&#39;s)</code>","author":"<a href=\"https://superuser.com/users/109777/tdwong-star\" target=\"_blank\" rel=\"nofollow noopener\">tdwong.star</a>"}]},{"answer":"<p> Tidak tahu apakah itu bisa dilakukan dengan <code>sed</code>, tapi inilah versi <code>awk</code>. </p> <pre><code>awk 'BEGIN {matches=0}\n     matches &lt; 2 &amp;&amp; /1/ { sub(/1/,\"5\"); matches++ }\n     { print $0 }' ztest \n</code></pre> <p> Ini akan menggantikan <code>1</code> dengan <code>5</code> untuk dua pertandingan pertama <code>1</code>. (Ubah <code>2</code> di sana untuk menambah / mengurangi jumlah pertandingan yang Anda inginkan.) <br> Setelah itu, file akan dicetak apa adanya. </p>","votes":"4","source":"https://superuser.com/a/394283","author":"<a href=\"https://superuser.com/users/71809/mat\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Mat</span></a>","replies":[{"reply":"Terima kasih banyak untuk itu, @Mat - omong-omong, jawaban asli <code>sed</code> Anda menuntun saya <a href=\"http://superuser.com/a/394291/39752\" target=\"_blank\" rel=\"nofollow noopener\"> jawaban ini </a> ; tapi saya rasa saya lebih suka spesifikasi jumlah pertandingan langsung. Bersulang!","author":"<a href=\"https://superuser.com/users/39752/sdaau\" target=\"_blank\" rel=\"nofollow noopener\">sdaau</a>"}]},{"answer":"<p> Ini mungkin berhasil untuk Anda (GNU sed): </p> <pre><code>sed '0,/1/s//5/' file\n</code></pre>","votes":"2","source":"https://superuser.com/a/394307","author":"<a href=\"https://superuser.com/users/115456/potong\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">potong</span></a>","replies":[{"reply":"Terima kasih @potong, mau menjelaskan lebih banyak lagi?","author":"<a href=\"https://superuser.com/users/203539/xpt\" target=\"_blank\" rel=\"nofollow noopener\">xpt</a>"}]},{"answer":"<p> Berkat jawaban pertama @ Mat (di atas StackOverflow, sekarang dihapus), sintaks untuk <code>sed</code> hanya menggantikan kecocokan pada baris pertama adalah: </p> <pre><code>sed  '1s/1/5/' ztest\n</code></pre> <p> Namun, Anda harus mengetahui secara eksplisit nomor baris tempat melakukan pertandingan. </p>\n\n<p> Jadi jika saya tahu filenya seperti di atas, maka dua <code>1</code> yang pertama muncul di baris 1 dan 5; jadi untuk dua pertandingan pertama, saya dapat menginstruksikan <code>sed</code> untuk menerapkan ekspresi antara baris 1 dan (katakanlah) 6 - sintaks untuk rentang baris (alamat) pada <code>sed</code> menjadi koma (<code>,</code>): </p> <pre><code>$ sed  '1,6s/1/5/' ztest\n5\n2\n3\n4\n5\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\n</code></pre> <p> Demikian pula, kemunculan kedua dan ketiga dari <code>1</code> ada di baris 5 dan 9 - jadi saya juga dapat menggunakan rentang, katakanlah, dari baris 3 ke baris 10 untuk mengubah kemunculan kedua dan ketiga dari <code>1</code>: </p> <pre><code>$ sed  '3,10s/1/5/' ztest\n1\n2\n3\n4\n5\n2\n3\n4\n5\n2\n3\n4\n1\n2\n3\n4\n</code></pre> <p> .... yang saya kira menjawab pertanyaan saya dalam istilah <code>sed</code>; meskipun saya berharap saya bisa menentukan jumlah pertandingan secara langsung ( <em> seperti pada solusi <code>awk</code> oleh <a href=\"https://superuser.com/a/394283/39752\" target=\"_blank\" rel=\"nofollow noopener\"> @Tikar </a></em> ). </p>","votes":"1","source":"https://superuser.com/a/394291","author":"<a href=\"https://superuser.com/users/39752/sdaau\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">sdaau</span></a>","replies":[]},{"answer":"<p> Gunakan pola <code>:a;n;ba</code> sekali lagi: </p> <pre><code>$ sed '/1/{s//5/;:A;/1/{s//5/;:B;n;bB};n;bA}'\n</code></pre>","votes":"1","source":"https://superuser.com/a/394388","author":"<a href=\"https://superuser.com/users/39544/kev\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">kev</span></a>","replies":[]},{"answer":"<p> Gunakan ini sederhana:\nsed &#39;s / 1/5 /&#39; ztest </p>","votes":"-3","source":"https://superuser.com/a/1618885","author":"<a href=\"https://superuser.com/users/1263781/mehdi\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Mehdi</span></a>","replies":[]}]}
