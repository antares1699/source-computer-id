{"title":"Akses PowerShell ditolak ke sertifikat: \\ CurrentUser \\ My","draft":false,"url":"/akses-powershell-ditolak-ke-sertifikat-currentuser-my-j53fmydl","votes":"4","answers_count":"4","categories":["Komputer"],"tags":["powershell","certificate","code-signing"],"snippet":"PS cert:\\currentuser\\my&gt; dir  Get-ChildItem : Access is denied.At line:1 char:3+ dir &lt;&lt;&lt;&lt;  Saya tidak dapat mengakses salah satu sertifikat penandatanganan kode saya untuk menandatangani skrip PowerShell. Saya dapat membuka MMC,...","body":"<pre><code>PS cert:\\currentuser\\my&gt; dir  \nGet-ChildItem : Access is denied.\nAt line:1 char:3\n+ dir &lt;&lt;&lt;&lt;\n</code></pre> <p> Saya tidak dapat mengakses salah satu sertifikat penandatanganan kode saya untuk menandatangani skrip PowerShell. Saya dapat membuka MMC, Sertifikat, dan melihat bahwa sertifikat penandatanganan kode saya diinstal dan valid di komputer saya (Windows XP SP 3). </p>\n\n<p> Hal aneh lainnya adalah saya tidak dapat mengakses drive jaringan yang dipetakan dari PowerShell, tetapi saya dapat melihatnya dengan baik di Windows Explorer dan jendela DOS. </p>\n\n<p> Saya telah mencopot PowerShell, mem-boot ulang, dan menginstal ulang PowerShell 1, tetapi masih memiliki masalah yang sama. </p>\n\n<p><strong> EDIT: </strong> Akun saya sehari-hari di mesin ini BUKAN administrator, tetapi saya memiliki akun administrator yang dapat saya gunakan untuk tugas-tugas yang memerlukannya. Sertifikat penandatanganan kode diberikan ke akun saya sehari-hari, dan saya tidak perlu menjadi administrator untuk menandatangani kode. Saya tidak yakin bagaimana memberikan hak akun ini ke penyimpanan sertifikat. </p>\n\n<p><strong> EDIT 2: </strong> Aku lari <a href=\"http://en.wikipedia.org/wiki/Process_Monitor#FileMon\" rel=\"nofollow noopener\" target=\"_blank\"> FileMon </a> dan <a href=\"http://en.wikipedia.org/wiki/Process_Monitor#RegMon\" rel=\"nofollow noopener\" target=\"_blank\"> RegMon </a> untuk melihat apa yang akses saya ditolak. <code>cert:CurrentUser\\My</code> adalah folder <code>C:\\Documents and Settings\\USERNAME\\Application Data\\Microsoft\\SystemCertificates\\My\\Certificates</code>. Itu juga menolak akses saya ke <code>C:\\Documents and Settings\\USERNAME\\Local Settings\\Temp</code>. Saya dapat membuka Explorer dan mendapatkan file di folder ini tanpa masalah. Saya sementara memberikan <code>Everyone</code> hak penuh ke folder ini dan masih menerima pesan akses ditolak dari PowerShell. </p>\n\n<p> Google belum mengungkapkan banyak. Apa yang harus saya lakukan? </p>\n\n<p> Pesan dari log peristiwa Windows PowerShell: </p> <pre><code>Provider Health: Attempting to perform the GetChildItems operation on  \nthe 'Certificate' provider failed for path '\\currentuser\\my'. Access is denied.\n\nDetails: \nProviderName=Certificate\nExceptionClass=ProviderInvocationException\nErrorCategory=InvalidOperation\nErrorId=GetChildrenProviderException\nErrorMessage=Attempting to perform the GetChildItems operation on  \n       the 'Certificate' provider failed for path '\\currentuser\\my'.  \n       Access is denied.\n\nSeverity=Warning\nSequenceNumber=146\n\nHostName=ConsoleHost\nHostVersion=1.0.0.0\n     .....  \n</code></pre>","source":"https://superuser.com/questions/174878/powershell-access-denied-to-cert-currentuser-my","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Bratch</span></a>","replies":[{"reply":"Mungkin pertanyaan bodoh, tetapi apakah folder itu sebenarnya bernama &#39;milikku&#39;? Sepertinya nama folder yang lebih panjang telah terpotong di antara &#39;saya&#39; dan yang lainnya.","author":"<a href=\"https://superuser.com/users/41423/boot13\" target=\"_blank\" rel=\"nofollow noopener\">boot13</a>"},{"reply":"Itu adalah nama folder, Anda dapat membuka PowerShell dan mendapatkannya, dan itu berfungsi sebagai pengguna lain. PS D: \\ Projects&gt; cd cert: PS cert: \\&gt; cd CurrentUser Sertifikat PS: \\ CurrentUser&gt; cd Sertifikat PS saya: \\ CurrentUser \\ My&gt; dir Get-ChildItem: Akses ditolak.","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\">Bratch</a>"}],"answers":[{"answer":"<p> Sepertinya Anda memiliki masalah izin. </p>\n\n<p> Apakah ini akun admin di PC ini, apakah Anda tunduk pada kontrol domain, dan apakah ada kebijakan grup yang diaktifkan? </p>\n\n<p> Saya menduga PC ini terkunci lebih dari yang diinginkan PowerShell. Beberapa admin tidak mengizinkannya berjalan sama sekali karena mungkin saja melakukan beberapa kerusakan. </p>\n\n<p> Saat kamu lari\n<code>Set-ExecutionPolicy RemoteSigned</code>\napakah kamu mendapatkan kesalahan? </p>","votes":"5","source":"https://superuser.com/a/174882","author":"<a href=\"https://superuser.com/users/43645/jnk\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">JNK</span></a>","replies":[{"reply":"Poin bagus, saya telah mengedit pertanyaan tentang menjadi administrator. Ada kontrol domain dan kebijakan grup yang berlaku, jadi saya perlu memeriksa dengan I.S. tentang mereka. Sebagai seorang programmer, saya menulis skrip, dan akun admin saya berfungsi dengan baik, hanya saja akun pengguna ini tidak. Menetapkan kebijakan eksekusi menolak saya mengakses kunci &quot;HKEY_LOCAL_MACHINE \\ SOFTWARE \\ Microsoft \\ PowerShell \\ 1 \\ ShellIds \\ Microsoft.PowerShell.&quot; Saya memeriksa dengan I.S. sekarang ...","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\">Bratch</a>"},{"reply":"Saya dapat mengedit kunci registri itu dengan tangan, tetapi tidak dapat mengaturnya dari PowerShell. PowerShell berjalan seperti saya, jadi saya tidak mengerti mengapa ada perbedaan.","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\">Bratch</a>"},{"reply":"Tidak ada kontrol domain atau kebijakan grup yang akan mencegah saya menjalankan PowerShell dan mendapatkan akses ke penyimpanan sertifikat. Itu terjadi karena tidak memiliki izin untuk mengakses penyimpanan sertifikat, dan saya tidak yakin bagaimana cara mendapatkan hak tersebut sehingga PowerShell dapat mengakses sertifikat.","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\">Bratch</a>"},{"reply":"Diterima karena menyebutkan kebijakan grup.","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\">Bratch</a>"}]},{"answer":"<p> PowerShell dijalankan melalui .NET Framework. Saya tidak menggunakan XP untuk sementara waktu, sedikit jika saya ingat dengan benar, ada beberapa pengguna NET yang aneh di daftar pengguna. Saya tidak pernah sempat memikirkan untuk apa itu, tetapi mungkin Anda perlu memberikan hak NTFS pengguna itu ke direktori yang dimaksud. </p>","votes":"2","source":"https://superuser.com/a/174926","author":"<a href=\"https://superuser.com/users/8972/paradroid\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">paradroid</span></a>","replies":[{"reply":"Ini mungkin masalahnya, tetapi saya tidak yakin di mana harus menetapkan izin pengguna untuk penyimpanan sertifikat. Kotak XP saya akan segera diganti dengan kotak Windows 7, jadi saya akan menghadapi masalah baru, tetapi sampai saat itu saya masih perlu menandatangani skrip.","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\">Bratch</a>"},{"reply":"Jadi PowerShell tidak benar-benar berjalan seperti saya? Ini menunjukkan nama pengguna saya di pengelola tugas.","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\">Bratch</a>"},{"reply":"Saya hanya mencoba memikirkan kemungkinan mengapa tampaknya ada masalah izin.","author":"<a href=\"https://superuser.com/users/8972/paradroid\" target=\"_blank\" rel=\"nofollow noopener\">paradroid</a>"}]},{"answer":"<p> Saya menemukan mengapa ini terjadi. Jika saya baru saja menjalankan PowerShell dari menu, saya mengalami masalah saat mengakses sertifikat dan sumber daya lainnya. Misalnya, jika saya hanya menjalankannya dan menavigasi ke direktori home saya dan menjalankan &quot;dir&quot;, saya mendapatkan ini: </p> <pre><code>PS C:\\Documents and Settings\\username&gt; dir\nGet-ChildItem : Access to the path 'C:\\Documents and Settings\\username' is denied.\nAt line:1 char:3\n+ dir &lt;&lt;&lt;&lt;\nPS C:\\Documents and Settings\\username&gt;\n</code></pre> <p> Namun saya dapat menggunakan Windows Explorer atau jendela DOS untuk berhasil membuat daftar isinya. </p>\n\n<p> Apa yang berhasil adalah ketika saya mengklik kanan pada PowerShell dan memilih &quot;Run As,&quot; biarkan pada pengguna saat ini, dan hapus centang pada &quot;Protect my computer and data from unauthorized program activity.&quot; Setelah ini saya dapat membuat daftar direktori home saya dan saya dapat mengakses sertifikat yang saya perlukan untuk menandatangani kode saya. </p>\n\n<p> Pengaturan DEP saya berwarna abu-abu, yang berarti mereka didorong oleh kebijakan grup, atau saya perlu naikkan ke Administrator untuk mengubahnya. Saya masuk sebagai Administrator dan menemukan bahwa DEP aktif hanya untuk program dan layanan Windows yang penting. Saya kira PowerShell termasuk dalam kategori ini. Sekarang setelah saya dapat mengakses sertifikat, saya menemukan bahwa kunci pribadi tidak dapat ditemukan. Saya rasa ini bisa diperbaiki dengan menerbitkan kembali sertifikat. </p>","votes":"1","source":"https://superuser.com/a/351718","author":"<a href=\"https://superuser.com/users/2942/bratch\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Bratch</span></a>","replies":[]},{"answer":"<p> Coba jalankan <code>Set-ExecutionPolicy Unrestricted</code> di PowerShell </p>","votes":"0","source":"https://superuser.com/a/800462","author":"<a href=\"https://superuser.com/users/359695/jsaddwater\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">jsaddwater</span></a>","replies":[]}]}
