{"title":"Bagaimana saya bisa logoff dan pergi ke stand-by melalui skrip Win XP?","draft":false,"url":"/bagaimana-saya-bisa-logoff-dan-pergi-ke-stand-by-melalui-skrip-win-xp-igmfteor","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["windows-xp","script","sleep"],"snippet":"Saya mencari cara untuk menulis skrip (dalam bentuk apa pun) yang akan mengeluarkan saya dari akun Windows lokal saya dan juga segera membuat komputer tidur / siaga. Saya telah menemukan solusi yang...","body":"<p> Saya mencari cara untuk menulis skrip (dalam bentuk apa pun) yang akan mengeluarkan saya dari akun Windows lokal saya dan juga segera membuat komputer tidur / siaga. Saya telah menemukan solusi yang dapat melakukan satu atau yang lain tetapi tidak logoff dan kemudian tidur semua dalam satu skrip. Perintah SHUTDOWN tidak menawarkan ini dan saya juga tidak dapat menemukan opsi lain. </p>\n\n<p> Ini untuk Win XP, SP3 sekarang tetapi suatu hari nanti saya akan menginginkan solusi Windows 7 juga. </p>\n\n<p> Terima kasih atas ide atau penjelasan mengapa hal ini tidak memungkinkan. :) </p>","source":"https://superuser.com/questions/122432/how-can-i-logoff-and-go-to-stand-by-via-win-xp-script","author":"<a href=\"https://superuser.com/users/23119/peter\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Peter</span></a>","replies":[],"answers":[{"answer":"<p> Melihat <a href=\"http://technet.microsoft.com/en-us/sysinternals/bb897541\" rel=\"nofollow noopener\" target=\"_blank\"> PsShutdown </a> . Harus melakukan apa yang Anda inginkan. </p>","votes":"2","source":"https://superuser.com/a/224578","author":"<a href=\"https://superuser.com/users/59497/kutscherait\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">KutscheraIT</span></a>","replies":[{"reply":"Dan bagaimana saran Anda agar kami menggunakan PsShutdown untuk tujuan itu?","author":"<a href=\"https://superuser.com/users/19097/ant\" target=\"_blank\" rel=\"nofollow noopener\">AnT</a>"}]},{"answer":"<p> File batch ini HEBAT! Saya telah menambahkan beberapa penyesuaian untuk membuatnya bekerja dengan Windows XP dan juga meminimalkan jumlah waktu untuk menunggu tugas terjadwal Siaga. Tugas terjadwal hanya berjalan setiap menit, jadi saya menyetel waktu tunggu maksimum menjadi 1 menit, 15 detik. Sekarang saya bisa Logout dan Standby dengan satu klik sederhana pada ikon file batch! </p>\n\n<p> Inilah cara saya menyiapkannya, selangkah demi selangkah: </p>\n\n<ol>\n<li><p> Buat direktori <code>\"C:\\MyProg\"</code> </p></li>\n<li><p> Buat dan simpan file teks <code>\"C:\\MyProg\\Standby.bat\"</code> </p> <pre><code> rem * Standby *  \n rundll32.exe powrprof.dll,SetSuspendState\n</code></pre> </li>\n<li><p> Buat dan simpan file teks &quot;C: \\ MyProg \\ Logoff-Standby.bat&quot; </p> <pre><code> rem * Logoff &amp; Standby *  \n rem  \n rem from http://superuser.com/questions/122432/how-can-i-logoff-and-go-to-stand-by-via-win-xp-script\n\n rem  \n rem * Find time to schedule the standby task *  \n rem  \n rem Get current time hours, minutes, and seconds  \n set curtime=%time%  \n set curhh=%curtime:~0,2%  \n set curhh=%curhh: =%  \n set curmm=%curtime:~3,2%  \n set curmm=%curmm: =%  \n set curss=%curtime:~6,2%  \n set curss=%curss: =%  \n rem Set values for near seconds, minutes, and hours  \n rem Scheduled tasks can only run at a new minute, so bump the time up by 1 min, 15 sec and then round down to zero seconds\n set /a nearss=%curss% + 15  \n set /a nearmm=%curmm% + 1  \n set /a nearhh=%curhh%  \n if %nearss% gtr 59 (  \n     set /a nearss=%nearss% - 60  \n     set /a nearmm=%nearmm% + 1  \n )  \n if %nearmm% gtr 59 (  \n     set /a nearmm=%nearmm% - 60  \n     set /a nearhh=%nearhh% + 1  \n )  \n if %nearhh% gtr 23 set /a nearhh=%nearhh% - 24  \n rem Add leading zero to minutes and hours  \n if %nearmm% lss 10 set nearmm=0%nearmm%  \n if %nearhh% lss 10 set nearhh=0%nearhh%  \n rem Set neartime to result rounded down to zero seconds  \n set neartime=%nearhh%:%nearmm%:00  \n rem  \n rem * Schedule task to standby *  \n rem  \n schtasks /create /tn \"standby\" /tr C:\\MyProg\\standby.bat /sc once /st %neartime% /ru System  \n rem  \n rem * Logout *  \n rem  \n shutdown -l -f\n</code></pre> </li>\n<li><p> Klik kanan <strong> <code>C:\\MyProg\\Logoff-Standby.bat</code> </strong> &gt; <strong> Kirim ke </strong> &gt; <strong> Desktop (buat pintasan) </strong></p></li>\n</ol>","votes":"5","source":"https://superuser.com/a/236863","author":"<a href=\"https://superuser.com/users/64396/fred\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Fred</span></a>","replies":[{"reply":"sering kali lebih baik mengomentari jawaban orang lain daripada memposting jawaban Anda sendiri dengan beberapa penyesuaian. Tetapi karena Anda belum memiliki cukup perwakilan untuk berkomentar, Anda dimaafkan untuk saat ini ;-)","author":"<a href=\"https://superuser.com/users/1548/ivo-flipse\" target=\"_blank\" rel=\"nofollow noopener\">Ivo Flipse</a>"},{"reply":"Ya kamu benar; Saya tidak memiliki tombol komentar. Saya ingin memastikan bahwa siapa pun yang mencari dapat menemukan jawaban yang sama dengan yang saya lakukan dengan beberapa perbaikan. Perbaikan utama adalah penggunaan perintah &quot;shutdown -l&quot; daripada &quot;rundll32 user32.dll, ExitWindowsEx&quot;. Saya pikir solusi aslinya sangat cerdik. Saya tidak akan pernah memikirkannya sendiri, dan saya tidak dapat menemukan solusi lain untuk ini yang bahkan mendekati.","author":"<a href=\"https://superuser.com/users/64396/fred\" target=\"_blank\" rel=\"nofollow noopener\">Fred</a>"},{"reply":"Perlu satu perbaikan lagi. Saat menjadwalkan tugas, jamnya harus 2 digit dengan awalan nol jika lebih awal dari 10: 00a. Saya harus menambahkan baris ini: jika% nearhh% lss 10 disetel nearhh = 0% nearhh% Saya menambahkan ini ke jawaban saya.","author":"<a href=\"https://superuser.com/users/64396/fred\" target=\"_blank\" rel=\"nofollow noopener\">Fred</a>"},{"reply":"solusi yang indah. saya akan menyalin :)","author":"<a href=\"https://superuser.com/users/40201/kokbira\" target=\"_blank\" rel=\"nofollow noopener\">kokbira</a>"},{"reply":"Saya selalu menggunakan for untuk mengekstrak jam, menit dan detik dari% time%. Tapi di mana kelelawar Anda mendapatkan waktu saat ini? Anda lupa% waktu%?","author":"<a href=\"https://superuser.com/users/40201/kokbira\" target=\"_blank\" rel=\"nofollow noopener\">kokbira</a>"}]},{"answer":"<p> Buat file batch, </p> <pre><code>schtasks /create /tn \"sleep\" /tr c:\\scripts\\sleep.bat /sc once /st %neartime% /ru System\nrundll32 user32.dll,ExitWindowsEx\n</code></pre> <p> baris pertama membuat tugas terjadwal yang menjalankan sleep.bat sebagai pengguna sistem 1 menit dari sekarang. Baris kedua mencatat Anda. </p>\n\n<p> Di file sleep.bat Anda perlu menambahkan baris berikut yang akan mengirim PC ke mode sleep. </p> <pre><code>rundll32.exe powrprof.dll,SetSuspendState\n</code></pre> <p> Di file batch pertama Anda perlu menentukan jam berapa sekarang 1 menit dari sekarang (% neartime%) </p> <pre><code>set curtime=%time%\nset curhh=%curtime:~0,2%\nset curhh=%curhh: =%\nset curmm=%curtime:~3,2%\nset curmm=%curmm: =%\nif \"%curmm:~0,1%\" == \"0\" set curmm=%curmm:~1,1%\nset /a nearmm=%curmm% + 2\nset /a nearhh=%curhh%\nif %nearmm% gtr 59 (\n    set /a nearmm=nearmm% - 60\n    SET /A nearhh=%nearhh% + 1\n)\nif %nearmm% gtr 59 if %nearhh% gtr 23 set /a nearhh=%nearhh% - 24\nif %nearmm% lss 10 set nearmm=0%nearmm%\nset neartime=%nearhh%:%nearmm%\n</code></pre> <p> Ini tidak akan instan tetapi akan otomatis. </p>\n\n<p> Atau Anda dapat mengatur pc Anda untuk mengunci ketika melanjutkan dari tidur, dan kemudian perintah tidur sendiri akan mengunci stasiun (meskipun ini tidak membuat Anda keluar, tutupnya!) </p>","votes":"3","source":"https://superuser.com/a/122515","author":"<a href=\"https://superuser.com/users/31372/charles-gargent\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Charles Gargent</span></a>","replies":[{"reply":"Wow, ini terlihat sangat bagus. Saya akan mencobanya secepatnya. Apakah Anda sudah mengetahui ini atau apakah Anda baru saja memikirkannya untuk saya? :)","author":"<a href=\"https://superuser.com/users/23119/peter\" target=\"_blank\" rel=\"nofollow noopener\">Peter</a>"},{"reply":"% Neartime% sudah saya miliki, sisanya adalah tebakan, saya belum pernah benar-benar mencoba mematikan PC dari akun sistem.","author":"<a href=\"https://superuser.com/users/31372/charles-gargent\" target=\"_blank\" rel=\"nofollow noopener\">Charles Gargent</a>"},{"reply":"lihat juga perintah &quot;at&quot;","author":"<a href=\"https://superuser.com/users/40201/kokbira\" target=\"_blank\" rel=\"nofollow noopener\">kokbira</a>"}]}]}
