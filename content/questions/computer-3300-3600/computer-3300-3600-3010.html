{"title":"Bagaimana cara menginstal pembaruan dan mematikan dari baris perintah?","draft":false,"url":"/bagaimana-cara-menginstal-pembaruan-dan-mematikan-dari-baris-perintah-xoadrrqm","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["command-line","windows-vista","shutdown","windows-update"],"snippet":"Saya tahu bahwa ada cara sederhana untuk mematikan komputer di command prompt, tetapi apakah mungkin untuk melakukan pembaruan sistem dan kemudian mematikan komputer di command prompt?  Misalnya, ketika Vista perlu menginstal pembaruan,...","body":"<p> Saya tahu bahwa ada cara sederhana untuk mematikan komputer di command prompt, tetapi apakah mungkin untuk melakukan pembaruan sistem dan kemudian mematikan komputer di command prompt? </p>\n\n<p> Misalnya, ketika Vista perlu menginstal pembaruan, itu akan membiarkan saya menginstal dan mematikan dengan mengklik tombol <code>Shut Down</code> (sambil menurunkan tombol matikan normal ke dalam menu). Jadi apakah ada perintah untuk melakukan ini di command prompt? </p>","source":"https://superuser.com/questions/351703/how-can-i-install-updates-and-shut-down-from-the-command-line","author":"<a href=\"https://superuser.com/users/95296/mendez\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">mendez</span></a>","replies":[],"answers":[{"answer":"<p> Tidak ada cara baris perintah bawaan untuk menginstal paksa pembaruan yang menunggu sebelum shutdown / reboot (Saya pernah mendengar desas-desus bahwa itu ada di Windows 8, tetapi belum diperiksa). </p>\n\n<p> Taruhan terbaik Anda adalah membuat skrip (VBS, PowerScript, atau sejenisnya) yang akan melakukan pembaruan dan kemudian mematikan sistem. </p>\n\n<p> Sebagai contoh: </p> <pre><code>' NAME : &lt;wusforceupdate&gt;\n' AUTHOR : &lt;Samuel lambert&gt;\n' COMMENT : &lt;Find-Download-Install-reboot (with windows update system WUS)&gt;\n' www.wsus.info/forums/lofiversion/index.php?t5454.html\n\n'Shutdown flags;\n const nLog_Off          =  0 \n const nForced_Log_Off   =  4  '( 0 + 4 ) \n const nShutdown         =  1\n const nForced_Shutdown  =  5  '( 1 + 4 ) \n const nReboot           =  2\n const nForced_Reboot    =  6  '( 2 + 4 )\n const nPower_Off        =  8\n const nForced_Power_Off = 12  '( 8 + 4 )\n\nShutdownOption = nForced_Reboot\n\n'Monthly log;\ndt = date() : nMonth = Year(dt)*1e2 + Month(dt)\nsLogFile = \"C:\\WUSforceupdate-\" &amp; nMonth &amp; \".log\"\n\n\nSet updateSession = CreateObject(\"Microsoft.Update.Session\")\nSet updateSearcher = updateSession.CreateupdateSearcher()\n\nSet searchResult = _\nupdateSearcher.Search(\"IsInstalled=0 and Type='Software'\")\n\nSet File = CreateObject(\"Scripting.FileSystemObject\")\nSet LogFile = File.OpenTextFile(sLogFile, 8, True)\n\nLogFile.WriteLine(\"***************************************************************\")\nLogFile.WriteLine( \"START TIME : \" &amp; now)\nLogFile.WriteLine( \"Searching for updates...\" &amp; vbCRLF)\nLogFile.WriteLine( \"List of applicable items on the machine:\")\n\nFor I = 0 To searchResult.Updates.Count-1\n  Set update = searchResult.Updates.Item(I)\n  LogFile.WriteLine( I + 1 &amp; \"&gt; \" &amp; update.Title)\nNext\n\nSet WshShell = WScript.CreateObject(\"WScript.Shell\")\n\nIf searchResult.Updates.Count = 0 Then\n  LogFile.WriteLine( \"There are no applicable updates.\")\n  WshShell.popup \"There are no applicable updates.\",1\n  ShutDown(ShutdownOption)  '&lt;-- O P T I O N A L\n  Wscript.quit\nEnd If\n\nLogFile.WriteLine( vbCRLF &amp; \"Creating collection of updates to download:\")\n\nSet updatesToDownload = CreateObject(\"Microsoft.Update.UpdateColl\")\n\nFor I = 0 to searchResult.Updates.Count-1\n  Set update = searchResult.Updates.Item(I)\n  LogFile.WriteLine( I + 1 &amp; \"&gt; adding: \" &amp; update.Title )\n  updatesToDownload.Add(update)\nNext\n\nLogFile.WriteLine( vbCRLF &amp; \"Downloading updates...\")\n\nSet downloader = updateSession.CreateUpdateDownloader() \ndownloader.Updates = updatesToDownload\ndownloader.Download()\n\nLogFile.WriteLine( vbCRLF &amp; \"List of downloaded updates:\")\n\nFor I = 0 To searchResult.Updates.Count-1\n  Set update = searchResult.Updates.Item(I)\n  If update.IsDownloaded Then\n    LogFile.WriteLine( I + 1 &amp; \"&gt; \" &amp; update.Title )\n  End If\nNext\n\nSet updatesToInstall = CreateObject(\"Microsoft.Update.UpdateColl\")\n\nLogFile.WriteLine( vbCRLF &amp; _\n   \"Creating collection of downloaded updates to install:\" )\n\nFor I = 0 To searchResult.Updates.Count-1\n  set update = searchResult.Updates.Item(I)\n  If update.IsDownloaded = true Then\n    'WshShell.popup \"installing...\" &amp; vbNewLine &amp; update.Title,1\n    LogFile.WriteLine( I + 1 &amp; \"&gt; adding: \" &amp; update.Title )\n    updatesToInstall.Add(update) \n  End If\nNext\n\nlogFile.WriteLine( \"Installing updates...\")\nSet installer = updateSession.CreateUpdateInstaller()\ninstaller.Updates = updatesToInstall\nSet installationResult = installer.Install()\n\n'Output results of install\nLogFile.WriteLine( \"Installation Result: \" &amp; installationResult.ResultCode )\nLogFile.WriteLine( \"Reboot Required: \" &amp; installationResult.RebootRequired &amp; vbCRLF )\n\nLogFile.WriteLine( \"Listing of updates installed \" _\n    &amp; \"and individual installation results:\" )\n\nFor I = 0 to updatesToInstall.Count - 1\n  LogFile.WriteLine( I + 1 &amp; \"&gt; \" &amp; updatesToInstall.Item(i).Title _ \n    &amp; \": \" &amp; installationResult.GetUpdateResult(i).ResultCode ) \nNext\n\nIf installationResult.RebootRequired = -1 then\n  LogFile.WriteLine( \"RebootRequired\")\n  ' &lt;-- normally now you should call for a R E B O O T.....\nEnd if\n\nShutDown(ShutdownOption)  '&lt;-- O P T I O N A L\n\nLogFile.WriteLine( \"STOP TIME : \" &amp; now)\nLogFile.WriteLine(\"***************************************************************\")\nLogFile.Close\n\nwscript.echo \"Updates are installed\"\n\n\nFunction ShutDown(sFlag)\n wscript.sleep 600\n  Set OScoll = GetObject( _\n     \"winmgmts:{(Shutdown)}\").ExecQuery( _\n     \"Select * from Win32_OperatingSystem\") \n  For Each osObj in OScoll\n    osObj.Win32Shutdown(sFlag)\n  Next\nEnd Function\n</code></pre>","votes":"6","source":"https://superuser.com/a/351716","author":"<a href=\"https://superuser.com/users/23133/%c6%ac%e1%b4%87c%ca%9c%ce%b9%e1%b4%87007\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Ƭᴇcʜιᴇ007</span></a>","replies":[{"reply":"wow semua kode itu lol! Saya akan mencobanya, terima kasih atas bantuannya.","author":"<a href=\"https://superuser.com/users/95296/mendez\" target=\"_blank\" rel=\"nofollow noopener\">mendez</a>"},{"reply":"@mendez Ya, itu contoh yang cukup menyeluruh. :)","author":"<a href=\"https://superuser.com/users/23133/%c6%ac%e1%b4%87c%ca%9c%ce%b9%e1%b4%87007\" target=\"_blank\" rel=\"nofollow noopener\">&#x1AC;&#x1D07;c&#x29C;&#x3B9;&#x1D07;007</a>"}]},{"answer":"<ul>\n<li><p><a href=\"http://wuinstall.com/\" rel=\"nofollow noopener\" target=\"_blank\"> WuInstall </a> 1.2 atau lebih tinggi mampu melakukan apa yang Anda inginkan. Tetapi situs web mengatakan bahwa setelah uji coba terbatas waktu Anda berakhir, Anda harus membeli lisensi. Lisensi hanya dijual dalam multi-paket besar: multi-paket terkecil seharga USD $ 250. </p>\n\n<p> Saya menggunakan WuInstall 1.1, yang merupakan freeware. Itu dapat menginstal pembaruan dan reboot, tetapi tidak dapat menginstal pembaruan dan mematikan. </p>\n\n<p> aku sudah menulis <a href=\"https://superuser.com/a/370091/51958\" target=\"_blank\" rel=\"nofollow noopener\"> lebih lanjut tentang WuInstall </a> di tempat lain. </p></li>\n<li><p> Hanya penasaran: Mengapa Anda ingin menginstal pembaruan dan menutup tanpa mengklik mouse? Jika Anda memiliki lab dari banyak komputer yang identik, pertimbangkan untuk menggunakan WSUS dan / atau perangkat lunak lain. Atau mungkin Anda bisa mengikis dengan perangkat lunak pemutaran makro. </p></li>\n</ul>","votes":"1","source":"https://superuser.com/a/382505","author":"<a href=\"https://superuser.com/users/51958/jasonspiro\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">jasonspiro</span></a>","replies":[]}]}
