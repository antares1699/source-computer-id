{"title":"Cara memfilter daftar wmic diskdrive dengan benar","draft":false,"url":"/cara-memfilter-daftar-wmic-diskdrive-dengan-benar-g4usgi4q","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["powershell","wmi","wmic"],"snippet":"Saya mencoba menyaring hasil dari daftar wmic dengan where-object tapi sayangnya ini tidak berhasil.  wmic diskdrive list brief  | Where-Object -Property &quot;Caption&quot; -Contains &quot;Samsung&quot;  Hasil yang difilter kosong, hasil yang tidak difilter...","body":"<p> Saya mencoba menyaring hasil dari daftar wmic dengan <code>where-object</code> tapi sayangnya ini tidak berhasil. </p> <pre><code>wmic diskdrive list brief  | Where-Object -Property &quot;Caption&quot; -Contains &quot;Samsung&quot;\n</code></pre> <p> Hasil yang difilter kosong, hasil yang tidak difilter seperti ini: </p> <pre><code>Caption                       DeviceID            Model                Partitions  Size\n\nHGST HUH721212ALE600          \\\\.\\PHYSICALDRIVE1  HGST HUH721212ALE600 1           12000132426240\nOCZ-VERTEX3                   \\\\.\\PHYSICALDRIVE3  OCZ-VERTEX3          1           240054796800\nSamsung SSD 970 EVO Plus 1TB  \\\\.\\PHYSICALDRIVE5  Samsung SSD 970 EVO Plus 1TB  4           1000202273280\nST16000NM001G-2KK103          \\\\.\\PHYSICALDRIVE4  ST16000NM001G-2KK103 1           16000900392960\nST6000NM0024-1HT17Z           \\\\.\\PHYSICALDRIVE0  ST6000NM0024-1HT17Z  1           6001172513280\nSamsung SSD 840 PRO Series    \\\\.\\PHYSICALDRIVE2  Samsung SSD 840 PRO Series    1           512105932800\n</code></pre> <p> Bagaimana cara memfilter dengan benar? </p>\n<p> Pada akhirnya, saya ingin mendapatkan <code>DeviceID</code>, mis., <code>PHYSICALDRIVE5</code> </p>","source":"https://superuser.com/questions/1580076/how-to-properly-filter-a-wmic-diskdrive-list","author":"<a href=\"https://superuser.com/users/907728/soleil\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Soleil</span></a>","replies":[{"reply":"apakah ada alasan untuk TIDAK menggunakan cmdlet PoSh bawaan untuk ini? jika tidak, maka coba ini ... &gt;&gt;&gt; <code>Get-Disk | Where-Object Manufacturer -Match &#39;crucial&#39;</code> &lt;&lt;&lt; bagi saya, yang memberikan info untuk SSD tunggal saya. [ <i> menyeringai </i> ]","author":"<a href=\"https://superuser.com/users/962415/lee-dailey\" target=\"_blank\" rel=\"nofollow noopener\">Lee_Dailey</a>"}],"answers":[{"answer":"<p> WMIC bukan cmdlet PowerShell, dan tidak berisi properti yang dicari <code>Where-Object</code>. </p>\n<p> Anda dapat memverifikasi ini dengan mencoba menyalurkan perintah Anda ke <code>Get-Member</code>. </p>\n<p> Menggunakan <code>Select-String</code> seperti yang disebutkan dalam jawaban lain adalah cara terbaik untuk memfilter output apa pun di PowerShell dan patut diingat. </p>\n<p> Anda juga bisa mendapatkan informasi yang Anda peroleh dari WMIC dari cmdlet PowerShell, dan kemudian semua pemfilteran PowerShell dan perintah properti menjadi hidup. </p> <pre><code>Get-CimInstance Win32_DiskDrive | Where-Object {$_.Caption -like &quot;*samsung*&quot; }\n</code></pre> <p> Menjalankan ini di sistem saya dengan AMD menghasilkan: </p> <pre><code>PS C:\\Users\\ishmael&gt; Get-CimInstance Win32_DiskDrive | Where-Object {$_.Caption -like &quot;*AMD*&quot; }\n\nDeviceID           Caption                                   Partitions Size          Model\n--------           -------                                   ---------- ----          -----\n\\\\.\\PHYSICALDRIVE2 AMD-RAID Samsung SSD 970 SCSI Disk Device 3          1000202273280 AMD-RAID Samsung SSD 970 SCSI Disk Device\n\\\\.\\PHYSICALDRIVE1 AMD-RAID Array 2  SCSI Disk Device        1          999091860480  AMD-RAID Array 2  SCSI Disk Device\n</code></pre> <hr>\n<p><strong> Perincian Perintah </strong></p>\n<p><em> Get-CimInstance </em></p>\n<p> Cmdlet CIM ditambahkan sebagai pengganti Cmdlet WMI. CIM adalah singkatan dari Common Information Model dan digunakan dalam contoh ini untuk mengakses kumpulan informasi standar tentang Windows. <a href=\"https://www.dmtf.org/standards/cim\" rel=\"nofollow noopener\" target=\"_blank\"> DMTF </a> <a href=\"https://www.red-gate.com/simple-talk/sysadmin/powershell/powershell-day-to-day-admin-tasks-wmi-cim-and-pswa/\" rel=\"nofollow noopener\" target=\"_blank\"> RedGate </a> <a href=\"https://docs.microsoft.com/en-us/powershell/module/cimcmdlets/?view=powershell-7\" rel=\"nofollow noopener\" target=\"_blank\"> MS CimCmdlets </a></p>\n<p><em> Win32_DiskDrive </em></p>\n<p> Salah satu kelas CIM yang tersedia untuk kueri. Ada banyak kelas CIM. Cobalah <code>Get-CimClass Win32*</code> untuk mendapatkan gambaran tentang tipe kelas CIM yang tersedia yang merupakan awalan dengan Win32. </p>\n<p><em> | </em></p>\n<p> Pipa. Mengirim keluaran di sebelah kiri ke perintah di sebelah kanan. </p>\n<p><em> Dimana-Objek </em></p>\n<p> Where-Object dapat digunakan untuk memfilter output PowerShell yang telah disalurkan ke sana. Untuk melihat objek jenis apa yang dapat difilter, gunakan perintah pipe terlebih dahulu ke <code>Get-Member</code>, yang akan menampilkan daftar objek yang mungkin. </p>\n<p><em> {$ _. Seperti teks &quot; <em> samsung </em> &quot;} </em></p>\n<ul>\n<li> <code>$_</code> adalah sintaks PowerShell untuk <em> diri </em> . Mengacu pada input yang disalurkan. </li>\n<li> <code>.Caption</code> objek anggota <code>$_</code> yang ingin kami tanyakan </li>\n<li> <code>-like</code> Operator perbandingan PowerShell yang memungkinkan pola wildcard <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_comparison_operators?view=powershell-7\" rel=\"nofollow noopener\" target=\"_blank\"> Operator PS </a></li>\n<li> <code>&quot;*samsung*&quot;</code> string pencarian kami, tanda bintang wildcard memimpin dan mengikuti string kami untuk memastikan kami cocok <em> samsung </em> di mana saja di output. Mengabaikan karakter pengganti utama akan menampilkan hasil yang hanya dimulai dengan <em> samsung </em> . </li>\n</ul>","votes":"8","source":"https://superuser.com/a/1580083","author":"<a href=\"https://superuser.com/users/1206819/jim-diroff-ii\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Jim Diroff II</span></a>","replies":[]},{"answer":"<h3 class=\"h5\"> Saya mencoba menyaring hasil dari daftar <code>wmic</code> dengan <code>where-object</code> tetapi ini tidak berhasil. </h3>\n<blockquote>\n<p> Saya menggunakan: </p> <pre><code>wmic diskdrive list brief  | Where-Object -Property &quot;Caption&quot; -Contains &quot;Samsung&quot;\n</code></pre> </blockquote>\n<p> Untuk menemukan baris yang berisi string &quot;Samsung&quot; gunakan perintah berikut: </p> <pre><code>wmic diskdrive list brief  | select-string -pattern &quot;Samsung*&quot;\n</code></pre> <p> Dengan contoh Anda, seharusnya mengembalikan: </p> <pre><code>Samsung SSD 970 EVO Plus 1TB  \\\\.\\PHYSICALDRIVE5  Samsung SSD 970 EVO Plus 1TB  4           1000202273280\nSamsung SSD 840 PRO Series    \\\\.\\PHYSICALDRIVE2  Samsung SSD 840 PRO Series    1           512105932800\n</code></pre>","votes":"5","source":"https://superuser.com/a/1580079","author":"<a href=\"https://superuser.com/users/337631/davidpostill\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">DavidPostill</span></a>","replies":[]},{"answer":"<p> ini tidak langsung menjawab pertanyaan Anda. [ <em> menyeringai </em> ] namun, ini memberikan lebih banyak versi &quot;powershell-ish&quot; dari panggilan WMIC.exe yang Anda gunakan. </p>\n<p> apa yang dilakukannya ... </p>\n<ul>\n<li> setel string target untuk difilter </li>\n<li> mendapatkan info disk untuk semua disk </li>\n<li> menyaring disk yang tidak diinginkan </li>\n<li> membangun objek baru hanya dengan properti yang diinginkan <br> item WMIC &quot;DeviceID&quot; tampaknya dipetakan ke properti &quot;.DiskNumber&quot;. </li>\n<li> memangkas &quot;sekumpulan spasi kosong&quot; yang tidak diinginkan di properti nomor seri saya </li>\n<li> mengirimkannya ke $ Var </li>\n<li> menampilkannya di layar </li>\n</ul>\n<p> ini kodenya ... </p> <pre><code>$Maker = 'crucial'\n\n$TargetDiskInfo = Get-Disk |\n    Where-Object -Property FriendlyName -Match $Maker |\n    Select-Object -Property DiskNumber, Manufacturer, Model,\n        # the SN on my ssd has a BUNCH of leading whitespace\n        #    the &quot;.Trim()&quot; gets rid of that\n        @{n = 'SerialNumber'; e = {$_.SerialNumber.Trim()}}\n\n$TargetDiskInfo\n</code></pre> <p> hasil ... </p> <pre><code>DiskNumber Manufacturer Model            SerialNumber\n---------- ------------ -----            ------------\n         0 Crucial_     CT1024MX200S     153910A893E4\n</code></pre>","votes":"1","source":"https://superuser.com/a/1580134","author":"<a href=\"https://superuser.com/users/962415/lee-dailey\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Lee_Dailey</span></a>","replies":[]}]}
