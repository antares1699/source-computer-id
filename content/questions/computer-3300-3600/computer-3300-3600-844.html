{"title":"Bukan format keluaran yang sama dari `df` di distribusi Linux yang berbeda","draft":false,"url":"/bukan-format-keluaran-yang-sama-dari-df-di-distribusi-linux-yang-berbeda-nz3zrniy","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["linux","ubuntu","centos","df"],"snippet":"Di Ubuntu, keluaran dari perintah ini  df --exclude={tmpfs,devtmpfs,squashfs,overlay} | sed -e /^Filesystem/d | awk '{print $6 &quot; &quot; $1 &quot; &quot; $3 &quot; &quot; $4 &quot; &quot; $5}'  aku s:  / /dev/mapper/dockerVG-rootLV...","body":"<p> Di Ubuntu, keluaran dari perintah ini </p> <pre><code>df --exclude={tmpfs,devtmpfs,squashfs,overlay} | sed -e /^Filesystem/d | awk '{print $6 &quot; &quot; $1 &quot; &quot; $3 &quot; &quot; $4 &quot; &quot; $5}'\n</code></pre> <p> aku s: </p> <pre><code>/ /dev/mapper/dockerVG-rootLV 8110496 40591632 17%\n/dockerssd /dev/mapper/ssdVG-ssdLV 214133656 274642488 44%\n/dockerhdd /dev/mapper/hddVG-hddLV 83278236 1385191240 6%\n/var/lib/docker /dev/mapper/hddVG-dockerLV 76046204 412729940 16%\n</code></pre> <p> Itulah yang saya butuhkan. </p>\n<p> Di CentOS 6 saya mendapatkan output ini: </p> <pre><code> /dev/mapper/vg_rproxy-lv_root\n 51475068 43192316 12% /\n/boot /dev/sda1 82688 379364 18%\n /dev/mapper/vg_rproxy-lv_home\n 77349888 73119692 1% /home\n</code></pre> <p> Ini berantakan. </p>\n<p> Output penuh dari CentOS 6: </p> <pre><code>$ df\nFilesystem           1K-blocks    Used Available Use% Mounted on\n/dev/mapper/vg_rproxy-lv_root\n                      51475068 5661336  43192292  12% /\ntmpfs                   957140       0    957140   0% /dev/shm\n/dev/sda1               487652   82688    379364  18% /boot\n/dev/mapper/vg_rproxy-lv_home\n                      77349888  294352  73119692   1% /home\n</code></pre> <p> Apa masalahnya? Bagaimana cara memperbaikinya? </p>","source":"https://superuser.com/questions/1599648/not-the-same-output-format-from-df-in-different-linux-distributions","author":"<a href=\"https://superuser.com/users/1237093/piduna\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Piduna</span></a>","replies":[],"answers":[{"answer":"<h3 class=\"h5\"> tl; dr </h3>\n<p> Gunakan <code>df -P</code>. </p>\n<hr>\n<h3 class=\"h5\"> Jawaban lengkap </h3>\n<p> <code>/dev/mapper/vg_rproxy-lv_root</code> dan <code>/dev/mapper/vg_rproxy-lv_home</code> adalah string yang relatif panjang. Muncul <code>df</code> di CentOS <em> memutuskan </em> untuk membagi entri mereka menjadi dua baris, ini memutus logika saat Anda ingin mengurai keluaran lebih jauh. </p>\n<p> Di terminal sempit, ini mungkin hal yang baik, membuat keluaran semi-kolom yang dapat dibaca manusia meskipun ruang horizontal terbatas. Saya lebih suka ini tidak terjadi ketika <code>df</code> menulis ke non-tty (pipa dalam kasus Anda). </p>\n<p><em> Mungkin </em> <code>df</code> di Ubuntu berperilaku serupa jika entri dalam kolom <code>Filesystem</code> panjang; mungkin Anda tidak mengalami ini karena milik Anda relatif pendek. Saya tidak tahu, ini tidak penting. Yang penting adalah <code>df</code> adalah alat POSIX dan harus diikuti <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/utilities/df.html\" rel=\"nofollow noopener\" target=\"_blank\"> spesifikasi </a> . Tetapi spesifikasi tersebut secara eksplisit menyatakan: </p>\n<blockquote>\n<p> Implementasi historis <code>df</code> sangat bervariasi dalam keluaran defaultnya. Oleh karena itu, perlu untuk mendeskripsikan keluaran default secara longgar untuk mengakomodasi semua implementasi historis yang diketahui dan menambahkan opsi portabel (<code>-P</code>) untuk memberikan informasi dalam format portabel. </p>\n</blockquote>\n<p> Tentang opsi: </p>\n<blockquote>\n<p> <code>-P</code> <br> Hasilkan keluaran dalam format yang dijelaskan di bagian STDOUT. </p>\n</blockquote>\n<p> Dan akhirnya bagian yang relevan dari bagian STDOUT (penekanan saya): </p>\n<blockquote>\n<p> Penerapannya dapat menyesuaikan jarak antara baris header dan baris data individu sehingga informasi disajikan dalam kolom yang teratur. </p>\n<p> Output yang tersisa <strong> dengan <code>-P</code> </strong> terdiri dari <strong> satu baris informasi untuk setiap sistem file yang ditentukan </strong> . Garis-garis ini akan diformat sebagai berikut: </p> <pre><code>&quot;%s %d %d %d %d%% %s\\n&quot;, &lt;file system name&gt;, &lt;total space&gt;,\n    &lt;space used&gt;, &lt;space free&gt;, &lt;percentage used&gt;,\n    &lt;file system root&gt;\n</code></pre> </blockquote>\n<p> Jadi <code>df</code> diperbolehkan untuk mengeluarkan keluaran apapun, kecuali Anda menggunakan <code>-P</code>. Tanpa <code>-P</code> beberapa implementasi dari <code>df</code> dapat menghasilkan keluaran yang dapat diprediksi dan diuraikan, yang lainâ€¦ tidak begitu banyak. Perilaku mereka mungkin atau mungkin tidak didokumentasikan dengan cukup baik. Oleh karena itu secara umum, saat mengurai keluaran <code>df</code> Anda harus selalu menggunakan <code>-P</code>. </p>\n<p> Hanya menambahkan <code>-P</code> mungkin cukup untuk memperbaiki masalah khusus Anda. </p>\n<p> Catatan <code>-P</code> hanya mengatur format. Keseluruhan spesifikasi POSIX hanya berlaku di lokal POSIX. Selain itu, implementasi modern <code>df</code> cenderung menggunakan blok 1024-byte secara default, sedangkan POSIX menyatakan default-nya adalah 512. Dalam Debian 10 <code>df</code> saya dari GNU coreutils kembali ke default POSIX ketika <code>POSIXLY_CORRECT</code> diatur di lingkungan. Portably Anda dapat memaksa blok 1024-byte dengan <code>-k</code>. </p>\n<p> Ini adalah perintah portabel yang menghasilkan (hampir) keluaran yang dapat diuraikan: </p> <pre><code>LC_ALL=POSIX df -Pk\n</code></pre> <p> Hampir dapat diuraikan, karena entri dalam kolom <code>Filesystem</code> mungkin berisi spasi, saya kira; meskipun dalam OS yang dikonfigurasi dengan baik, mereka tidak melakukannya. </p>\n<p> Anda dapat menghilangkan <code>LC_ALL=POSIX</code> dan masih mendapatkan hasil yang diharapkan, tetapi secara umum harus ada untuk parsing. Misalnya. di bahasa Polandia saya <code>sed -e /^Filesystem/d</code> Anda tidak berfungsi karena saya mendapatkan istilah Polandia untuk &quot;filesystem&quot; dari <code>df</code> saya. <code>LC_ALL=POSIX</code> memperbaiki ini. Masih milikku <em> pribadi </em> preferensi untuk tidak bergantung pada apa pun di header. Saya akan menggunakan <code>sed 1d</code> atau <code>tail -n +2</code>; atau delegasikan tugas ke <code>awk</code>, karena <code>awk</code> sudah ada dalam pipeline Anda. Ini akan menjadi: </p> <pre><code>LC_ALL=POSIX df -Pk --exclude={tmpfs,devtmpfs,squashfs,overlay} \\\n| awk 'NR&gt;1 {print $6 &quot; &quot; $1 &quot; &quot; $3 &quot; &quot; $4 &quot; &quot; $5}'\n</code></pre> <p> Akhirnya <code>--exclude=</code> bukanlah pilihan portabel. Rupanya ini berfungsi untuk Anda di kedua sistem yang dimaksud, itu mungkin tidak berfungsi di sistem lain. </p>","votes":"10","source":"https://superuser.com/a/1599668","author":"<a href=\"https://superuser.com/users/432690/kamil-maciorowski\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Kamil Maciorowski</span></a>","replies":[{"reply":"Atau gunakan <code>findmnt --df --json</code> untuk memanfaatkan format parsable yang didukung secara luas.","author":"<a href=\"https://superuser.com/users/1845/ephemient\" target=\"_blank\" rel=\"nofollow noopener\">ephemient</a>"}]}]}
