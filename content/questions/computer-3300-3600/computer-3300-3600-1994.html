{"title":"Bagaimana Anda bisa melakukan SSH ke nama host yang tidak dikenal dengan kunci yang diketahui?","draft":false,"url":"/bagaimana-anda-bisa-melakukan-ssh-ke-nama-host-yang-tidak-dikenal-dengan-kunci-yang-diketahui-3vl8yayo","votes":"4","answers_count":"5","categories":["Komputer"],"tags":["networking","ssh"],"snippet":"Saya memiliki mesin yang terhubung ke jaringan perusahaan melalui VPN. Ketika saya terhubung ke VPN, itu selalu memberi saya nama host dan alamat ip yang berbeda. Nama host selalu jauh- [oktet terakhir...","body":"<p> Saya memiliki mesin yang terhubung ke jaringan perusahaan melalui VPN. Ketika saya terhubung ke VPN, itu selalu memberi saya nama host dan alamat ip yang berbeda. Nama host selalu jauh- [oktet terakhir dari alamat ip]. Kapanpun saya ingin melakukan SSH ke komputer saya, pertama-tama saya harus menjalankan &quot;nama host -A&quot; untuk melihat apa nama host itu. Masalahnya adalah, saya tidak selalu tahu apa nama host saya ketika saya perlu mengakses komputer. (Jika saya pergi ke tempat komputer secara fisik berada untuk menemukan nama host, itu mengalahkan kebutuhan saya untuk SSH.) </p>\n\n<p> Bisakah saya menggunakan SSH dan mencoba setiap nama host / ip di subnet sampai menemukan satu yang cocok dengan file kunci yang benar? </p>\n\n<hr>\n\n<p> Saya menggunakan laptop windows (juga terhubung melalui vpn) dengan cygwin ke ssh ke mesin Ubuntu 12.04. Saya tidak yakin mengapa saya mendapatkan nama host yang berbeda ketika saya terhubung ke vpn, tetapi ini adalah jaringan perusahaan, jadi mereka dapat melakukan apa pun yang mereka inginkan. </p>","source":"https://superuser.com/questions/603689/how-can-you-ssh-to-an-unknown-host-name-with-a-known-key","author":"<a href=\"https://superuser.com/users/229010/user229010\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">user229010</span></a>","replies":[{"reply":"Saya tidak yakin saya mengerti, apakah ini mesin virtual atau fisik? Mengapa nama host berubah? OK untuk IP, tapi nama hostnya? Bagaimanapun, apakah menjalankan skrip pada mesin jarak jauh yang menanyakan nama hostnya dan mempostingnya di suatu tempat sebagai opsi?","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\">terdon</a>"},{"reply":"Anda dapat melakukan ping siaran (<code>ping -b</code> di Linux, tidak yakin di Windows), dan mengidentifikasi mesin Anda melalui alamat MAC-nya dengan menampilkan tabel ARP (<code>arp</code> di Linux, <code>arp -a</code> di Windows).","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"@mpy dia masih harus terhubung ke mesin remote untuk itu kan?","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\">terdon</a>"},{"reply":"@terdon: Saya pikir siarannya akan cukup untuk mengisi tabel arp. Tes cepat berhasil mengidentifikasi beberapa mesin, tetapi tidak untuk semua ... tidak melihat pola, ada penjelasan yang pasti, tetapi saya bukan ahli jaringan.","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"@mpy dia terhubung melalui VPN. Jika VPN dirutekan, dan tidak dijembatani, ping siaran tidak akan dimungkinkan. Siaran biasanya tidak melintasi router. Selain itu, host Linux sering kali dikonfigurasi untuk tidak menanggapi ping siaran.","author":"<a href=\"https://superuser.com/users/2057/zoredache\" target=\"_blank\" rel=\"nofollow noopener\">Zoredache</a>"},{"reply":"Saya mencoba &quot;arp -a&quot; dan sayangnya sepertinya semua mesin yang terhubung melalui vpn menunjukkan alamat mac yang sama.","author":"<a href=\"https://superuser.com/users/229010/user229010\" target=\"_blank\" rel=\"nofollow noopener\">user229010</a>"}],"answers":[{"answer":"<h3 class=\"h5\"> Ini bukan portscan </h3>\n\n<p> Di sini kita hanya akan menggunakan utilitas ssh dasar <code>ssh-keyscan</code> dan <code>ssh-keygen</code> untuk koneksi jaringan / konversi kunci. </p>\n\n<h3 class=\"h5\"> Jika Anda tahu sidik jari server </h3>\n\n<p> dan ingin mencarinya maka Anda dapat melakukan: </p> <pre><code>for x in {1..254}; do ssh-keyscan 10.0.0.$x &gt; /tmp/ssh-scan.log 2&gt; /dev/null; cat /tmp/ssh-scan.log; ssh-keygen -lf /tmp/ssh-scan.log | grep -v 'not a public key file' ; done\n</code></pre> <p> dan itu akan mencetak sidik jari untuk semua host yang ditemukan. Baris di atas akan melewati 10.0.0.1 - 10.0.0.254, mencoba mendapatkan kunci publik dari setiap host dan akhirnya mengubah kunci publik menjadi sidik jari dan menampilkannya. Pesan kesalahan paling umum diarahkan ke lubang hitam yang ditemukan dari <code>/dev</code>. </p>\n\n<h3 class=\"h5\"> Atau mungkin mencari kunci publik </h3>\n\n<p> Kemudian hal yang sama tanpa konverter sidik jari, menampilkan kunci publik untuk semua host <em> antara </em> 10.0.0.0 dan 10.0.0.255: </p> <pre><code>for x in {1..254}; do ssh-keyscan 10.0.0.$x 2&gt; /dev/null; done\n</code></pre> <h3 class=\"h5\"> Jawaban akhir, ssh seek&#39;n&#39;connect script </h3>\n\n<p> Awalnya diposting oleh <a href=\"https://superuser.com/users/229010\" target=\"_blank\" rel=\"nofollow noopener\"> pengguna229010 </a> sebagai komentar, saya hanya membersihkannya :-) </p> <pre><code>for i in {1..255}; do \n    echo trying remote-$i\n    ping -w 1 -c 1 remote-$i &gt; /dev/null\n    if [ $? -eq 0 ]; then\n        # this is a live ip\n        echo remote-$i is up\n        if ssh-keyscan remote-ca$i | grep $expected_key -m1 -c &gt; /dev/null; then\n            # this is my machine\n            ssh remote-$i\n            exit 0\n        fi\n    fi\ndone\n</code></pre>","votes":"2","source":"https://superuser.com/a/603794","author":"<a href=\"https://superuser.com/users/132604/sampo-sarrala-codidact-org\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Sampo Sarrala - codidact.org</span></a>","replies":[{"reply":"Sempurna, inilah yang saya coba pikirkan bagaimana melakukannya. Saya menambahkan ping untuk melihat apakah saya dapat mempercepatnya sedikit: <code>for i in {1..255} ; do</code> `echo mencoba jarak jauh- $ i`` ping -w 1 -c 1 remote- $ i&gt; / dev / null` `if [$? -eq 0]; lalu` `# ini adalah ip` langsung` echo remote- $ i up` `jika ssh-keyscan remote-ca $ i | grep $ expected_key -m1 -c&gt; / dev / null; lalu` `# ini adalah mesin saya`` ssh remote- $ i` `exit 0`` fi` `fi` <code>done</code>","author":"<a href=\"https://superuser.com/users/229010/user229010\" target=\"_blank\" rel=\"nofollow noopener\">user229010</a>"},{"reply":"Saya minta maaf atas komentar yang berantakan ... Saya mencoba untuk mengeditnya, tetapi kemudian jendela pengeditan 5 menit saya kedaluwarsa dan tidak mengizinkan saya memperbaikinya.","author":"<a href=\"https://superuser.com/users/229010/user229010\" target=\"_blank\" rel=\"nofollow noopener\">user229010</a>"},{"reply":"@ user229010 Terima kasih telah membagikan bagian Anda sendiri, saya telah mengeditnya di ...","author":"<a href=\"https://superuser.com/users/132604/sampo-sarrala-codidact-org\" target=\"_blank\" rel=\"nofollow noopener\">Sampo Sarrala - codidact.org</a>"},{"reply":"Ini adalah solusi yang cukup bagus dengan asumsi kumpulan kemungkinan alamat ip Anda kecil, dan perangkat lunak pendeteksi intrusi perusahaan Anda tidak segera mem-boot Anda.","author":"<a href=\"https://superuser.com/users/164610/mattpark\" target=\"_blank\" rel=\"nofollow noopener\">MattPark</a>"}]},{"answer":"<p> Anda memiliki beberapa opsi di sini, dari yang paling sederhana hingga yang paling rumit. Tidak mengherankan ini berjalan baik, lebih baik, lebih baik. </p>\n\n<ol>\n<li><p><strong> Gunakan crontab untuk memperbarui file pada sistem jarak jauh dengan nama host Anda pada beberapa interval. </strong><br>\n<em> Buat / Edit Crontab: </em> <code>crontab -e</code> <br>\n<em> Tambahkan Entri Crontab: </em> Untuk membuat pekerjaan yang memperbarui file setiap jam selama hari kerja hanya di akhir pekan gunakan contoh ini: <br> <pre>\n00 09-18 * * 1-5 ssh usr@example.com \"echo $(hostname -A) > ubuntuhost.name\"</pre> </p></li>\n<li><p><strong> Gunakan crontab untuk mengirimkan nama host Anda ke email Anda pada interval tertentu. </strong><br>\n<em> Instal Mailutils: </em> <code>sudo apt-get update &amp;&amp; sudo apt-get install mailutils</code> Catatan: pilih &#39;koneksi internet&#39; jika diminta oleh instalasi mailutils, harus menjadi pilihan pertama. <br>\n<em> Buat / Edit Crontab: </em> <code>crontab -e</code> <br>\n<em> Tambahkan Entri Crontab: </em> Untuk membuat pekerjaan yang mengirimi Anda email setiap jam selama hari kerja hanya pada akhir pekan, dengan baris subjek dari nama host, gunakan contoh ini: <br> <pre>\n00 09-18 * * 1-5 mail -s \"Ubuntu $(hostname -A)\" you@you.com &lt; /dev/null </pre> </p></li>\n<li><p><strong> Gunakan NetworkManager Dispatcher untuk mengirim email ke nama host Anda saat ini setiap kali koneksi berubah. </strong><br> Letakkan skrip ini di /etc/NetworkManager/dispatcher.d, beri nama &quot;50emailhostname&quot; </p></li>\n</ol> <pre>\n#!/bin/sh -e\n#make sure I'm executable (chmod 775)\n\necho \"interface: $1, action: $2\" >> /tmp/interface.log #debug\n\nif [ \"$1\" = \"eth0\" ] && [ \"$2\" = \"up\" ]\nthen\n  mail -s \"Ubuntu $(hostname -A)\" you@you.com > /tmp/interface.log #debug\nelse\n  echo \"false\" >> /tmp/interface.log #debug\nfi\n\nexit\n</pre> <p><strong> Catatan: </strong></p>\n\n<ul>\n<li> Anda mungkin perlu mengubah &quot;eth0&quot; di skrip menjadi &quot;vpn0&quot; atau semacamnya\ntergantung klien Anda </li>\n<li> Anda mungkin perlu mengubah &quot;up&quot; menjadi &quot;vpn-up&quot; </li>\n<li> Gunakan pernyataan debug untuk mendapatkan perilaku yang diinginkan! </li>\n<li> <code>tail -f /tmp/interfaces.log</code> di jendela terpisah untuk melihat apa yang dilakukannya </li>\n<li> Mulai ulang layanan jaringan sesuai kebutuhan dengan restart manajer jaringan layanan </li>\n<li> Komentari pernyataan debug setelah selesai </li>\n<li> Anda bisa mendapatkan alamat ip alih-alih nama host dengan sesuatu seperti <br> <code>$(ifconfig | awk -F':' '/inet addr/&amp;&amp;!/127.0.0.1/{split($2,_,\" \");print _[1]}')</code> </li>\n</ul>","votes":"5","source":"https://superuser.com/a/603773","author":"<a href=\"https://superuser.com/users/164610/mattpark\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">MattPark</span></a>","replies":[{"reply":"Saya pikir solusi email lebih aman daripada mencoba memperbarui file. Mesin host-nya juga terhubung melalui VPN, jadi, (tanpa mengetahui secara pasti) ada kemungkinan besar bahwa nama host / IP-nya tunduk pada keanehan yang sama seperti remote.","author":"<a href=\"https://superuser.com/users/202319/kent\" target=\"_blank\" rel=\"nofollow noopener\">Kent</a>"},{"reply":"bagus, +1. Mengapa Anda mengambil <code>&#47;dev&#47;null</code> sebagai masukan untuk <code>mail</code>? Atau <code>&lt;</code> seharusnya <code>&gt;</code>?","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\">terdon</a>"},{"reply":"@terdon Terima kasih! Saya akan mengakui bahwa saya bangga dengan yang ini dan telah memikirkan beberapa penggunaan alternatif untuk skrip yang saya tulis untuk nomor 3. Saya sebenarnya menguji semua ini juga. Sedangkan untuk menggunakan / dev / null sebagai masukan untuk email, ia meminta isi pesan jika Anda tidak menyediakannya, dan karena kami meletakkan nama host di baris subjek, badan nol sangat ideal. Mungkin ada cara yang lebih baik untuk melakukannya, tetapi saya tahu cara ini berhasil.","author":"<a href=\"https://superuser.com/users/164610/mattpark\" target=\"_blank\" rel=\"nofollow noopener\">MattPark</a>"},{"reply":"+1 Ini cara yang bagus untuk menghindari <i> kehilangan tuan rumah saya? </i> situasi, terbukti berfungsi dengan baik ... jika Anda ingat untuk melakukan ini sebelum alamat berubah :)","author":"<a href=\"https://superuser.com/users/132604/sampo-sarrala-codidact-org\" target=\"_blank\" rel=\"nofollow noopener\">Sampo Sarrala - codidact.org</a>"},{"reply":"Anda juga dapat mengedit ini untuk mengirim alamat ip vs. nama host","author":"<a href=\"https://superuser.com/users/164610/mattpark\" target=\"_blank\" rel=\"nofollow noopener\">MattPark</a>"}]},{"answer":"<p> Akan lebih masuk akal jika mesin jarak jauh melaporkan IP-nya di suatu tempat. Misalnya dengan menjalankan crontab yang terhubung ke mesin lokal Anda melalui ssh dan menulis nama host ke file. Jika Anda memperbarui pertanyaan Anda dengan lebih detail (OS apa? Apakah mesin lokal Anda dapat diakses melalui jaringan?) Saya dapat memberitahu Anda bagaimana melakukan ini. </p>\n\n<p> Bagaimanapun, untuk mencoba semua IP di subnet, dengan asumsi Anda telah menginstal <code>arp</code>, Anda dapat melakukan sesuatu seperti ini: </p> <pre><code>for ip in `arp | grep -v Add | awk '{print $1}'`; do ssh $ip; done\n</code></pre>","votes":"1","source":"https://superuser.com/a/603696","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">terdon</span></a>","replies":[{"reply":"iterasi pada tabel arp tidak akan terlalu berguna jika dia terhubung dari jarak jauh melalui VPN yang menawarkan koneksi layer 3 (diarahkan) alih-alih koneksi layer 2 (dijembatani).","author":"<a href=\"https://superuser.com/users/2057/zoredache\" target=\"_blank\" rel=\"nofollow noopener\">Zoredache</a>"},{"reply":"Saya <code>arp</code> (Linux / Debian / OpenSuSE) tidak memiliki parameter <code>-e</code>, juga tidak <code>arp</code> menunjukkan <code>Add</code> untuk grep. OS apa yang Anda gunakan?","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"Lupakan bagian itu dengan &quot;Tambah&quot;. Saya mengabaikan <code>-v</code> ... <code>Add</code> adalah kependekan dari <code>Address</code>.","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"Memutar ssh ke urutan IP dapat membuat Anda bersahabat dengan admin jaringan perusahaan; tergantung pada apa yang ada di ujung lain dari IP, dll ...","author":"<a href=\"https://superuser.com/users/202319/kent\" target=\"_blank\" rel=\"nofollow noopener\">Kent</a>"},{"reply":"@mpy Debian, maaf <code>-e</code> adalah sesuatu yang saya ingat dari OS lain, Anda benar itu tidak ada.","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\">terdon</a>"}]},{"answer":"<p> Anda dapat mempercepat dengan mengekspos beberapa layanan yang mudah ditanyakan dan tidak mungkin dimiliki oleh mesin lain (tentu saja SSH juga akan melakukannya, tetapi memeriksa dengan <code>ssh</code> lebih lama, dan portscanning untuk <code>ssh</code> tidak disukai). </p>\n\n<p> Gunakan <a href=\"http://www.advanced-ip-scanner.com/\" rel=\"nofollow noopener\" target=\"_blank\"> pemindai port yang dapat dikonfigurasi </a> untuk memindai seluruh subnet mencari layanan yang satu itu. Mesin yang memiliki layanan itu adalah yang Anda cari. </p>\n\n<p> Namun, solusi terbaik adalah berbicara dengan administrator jaringan dan memperbarui DNS pada koneksi VPN. </p>","votes":"0","source":"https://superuser.com/a/603780","author":"<a href=\"https://superuser.com/users/166800/lserni\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">LSerni</span></a>","replies":[]},{"answer":"<p> Jika Anda ingin melakukan bruteforce IP mana yang digunakan oleh mesin ubuntu Anda, OpenSSH memiliki alat yang disebut ssh-keyscan untuk memindai jaringan untuk kunci host ssh: </p> <pre><code>for ((a=0;a&lt;255;a++)); do echo 198.51.100.$a; done | ssh-keyscan -f -H &gt; ssh_id_list\n</code></pre> <p> Anda hanya perlu tahu yang mana server Anda. Anda bisa mendapatkannya langsung dari server Anda, atau Anda bisa menggunakan fakta bahwa klien Anda menyimpannya saat pertama kali terhubung, ke ~ / .ssh / known_hosts: </p> <pre><code>ssh-keygen -F last_ip_you_used_to_connect -l\n</code></pre> <p> Kemudian grep ssh-keyscan dengan itu. </p>\n\n<hr>\n\n<p> Kemungkinan lain adalah dengan menggunakan mDNS: Ini adalah solusi DNS terdistribusi yang bekerja dengan baik dalam kondisi bahwa VPN mengizinkan lalu lintas multicast. Ini diinstal secara default pada desktop Ubuntu (jika <code>hostname -A</code> menampilkan <code>yourhostname.local</code>, itu bagus). Jika kebetulan, iTunes (atau perangkat lunak Apple lainnya yang menginstal Bonjour) diinstal di windows, maka Anda cukup terhubung ke <code>yourhostname.local</code> dan itu akan berfungsi di luar kotak. Jika tidak, jika Anda memiliki mesin Ubuntu lain dengan alamat ip yang diketahui dan penjawab mDNS diinstal, cukup sambungkan dan minta untuk menyelesaikan atau ping <code>yourhostname.local</code> </p>","votes":"0","source":"https://superuser.com/a/603798","author":"<a href=\"https://superuser.com/users/153119/batchyx\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">BatchyX</span></a>","replies":[]}]}
