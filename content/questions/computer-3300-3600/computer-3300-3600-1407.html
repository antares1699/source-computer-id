{"title":"osx: secara selektif men-zip sejumlah besar file: - @ opsi OK?","draft":false,"url":"/osx-secara-selektif-men-zip-sejumlah-besar-file-at-opsi-ok-qtb6popl","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["macos","command-line","bash","zip"],"snippet":"Saya perlu membuat pengarsipan file zip ~ 100k file dari direktori yang berisi ~ 500k file. Saya mendapatkan kesalahan &quot;daftar argumen terlalu panjang&quot; ketika saya mencoba perintah yang jelas:  zip archive.zip *pattern*.txt...","body":"<p> Saya perlu membuat pengarsipan file zip ~ 100k file dari direktori yang berisi ~ 500k file. Saya mendapatkan kesalahan &quot;daftar argumen terlalu panjang&quot; ketika saya mencoba perintah yang jelas: </p> <pre><code>zip archive.zip *pattern*.txt                        # fails\nzip archive.zip `find . -name \"*pattern*.txt\"`       # fails\n</code></pre> <p> Salah satu pendekatannya adalah menggunakan opsi <code>-@</code> untuk memberi makan daftar file melalui stdin: </p> <pre><code>find . -name \"*pattern*.txt\" | zip -@ archive.zip\n</code></pre> <p> Namun, halaman manual <code>zip</code> mengatakan: </p>\n\n<blockquote>\n  <p> Jika daftar file ditentukan sebagai - @ [Bukan di MacOS], zip akan mengambil daftar file input dari input standar, bukan dari baris perintah. </p>\n</blockquote>\n\n<p> Ini adalah &quot;Bukan di MacOS&quot; yang mengganggu saya. Saya melanjutkan dan mencoba opsi <code>-@</code>, dan tampaknya berhasil; tapi saya merasa gugup tentang apakah itu benar-benar melakukan pekerjaan yang benar (mengarsipkan semua file, utuh). </p>\n\n<p> Inilah pertanyaan saya: </p>\n\n<ol>\n<li> Mengapa <code>-@</code> tidak baik-baik saja di MacOS? </li>\n<li> Apakah ada beberapa versi MacOS / bash / zip yang peringatan ini benar, dan yang lainnya tidak? Apakah ini peringatan yang sudah usang, dan jika ya, di manakah garis pemisahnya? </li>\n<li> Apa pendekatan yang layak untuk masalah ini tanpa menggunakan <code>-@</code>? </li>\n</ol>\n\n<p> Perhatikan bahwa solusi yang diberikan di sini <a href=\"https://superuser.com/questions/272696/zip-argument-list-too-long-80-000-files-in-overall\" target=\"_blank\" rel=\"nofollow noopener\"> zip: Daftar argumen terlalu panjang (keseluruhan 80.000 file) </a> tidak akan bekerja; Saya perlu mengarsipkan beberapa, tidak semua, file di direktori. </p>\n\n<p> Saya menjalankan Mac OS 10.7.5. Berikut beberapa info versinya: </p> <pre><code>$ bash --version\nGNU bash, version 3.2.48(1)-release (x86_64-apple-darwin11)\n$ zip --version\nThis is Zip 3.0 (July 5th 2008), by Info-ZIP.\n...\nCompiled with gcc 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00) for Unix (Mac OS X) on Jun 24 2011.\n</code></pre>","source":"https://superuser.com/questions/575326/osx-selectively-zip-large-number-of-files-option-ok","author":"<a href=\"https://superuser.com/users/212518/andrewtinka\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">andrewtinka</span></a>","replies":[],"answers":[{"answer":"<p> Pertama-tama, </p> <pre><code>zip archive.zip `find . -name \"*pattern*.txt\"`\n</code></pre> <p> aku s <strong> tidak pernah </strong> sebuah ide bagus. Nama file dapat berisi spasi, karakter baris baru, bagian yang dapat diartikan sebagai sakelar dan lainnya. </p>\n\n<p> Untuk melakukan tindakan untuk setiap file yang ditemukan, Anda dapat menggunakan <a href=\"https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/find.1.html\" rel=\"nofollow noopener\" title=\"man find\" target=\"_blank\"> <code>-exec</code> </a> beralih atau <a href=\"https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man1/xargs.1.html\" rel=\"nofollow noopener\" title=\"man xargs\" target=\"_blank\"> xargs </a> . </p> <pre><code>find . -name \"*pattern*.txt\" -exec zip archive.zip {} +\n</code></pre> <p> akan menambahkan file satu per satu ke file zip. Di sini, <code>{}</code> melambangkan file yang sedang diproses. </p>\n\n<p> Mengakhiri argumen <code>-exec</code> dengan <code>+</code> bukan <code>;</code> menyebabkan find memproses beberapa file sekaligus (sebanyak mungkin tanpa menghasilkan kesalahan yang sama seperti yang Anda dapatkan), yang seharusnya jauh lebih cepat untuk sejumlah besar file. </p> <pre><code>find . -name \"*pattern*.txt\" -print0 | xargs -0 zip archive.zip\n</code></pre> <p> pada dasarnya melakukan hal yang sama. xargs memproses beberapa file sekaligus secara default. </p>\n\n<p> Sakelar <code>-print0</code> untuk mencari dan <code>-0</code> beralih ke xargs membuat mereka menggunakan karakter null sebagai pemisah file untuk menangani dengan benar nama file yang aneh. </p>\n\n<p> Saya tidak tahu mengapa <code>-@</code> tidak direkomendasikan untuk Mac OS <sup> 1 </sup> , tetapi <code>find ... | zip -@</code> akan melakukannya <strong> tidak </strong> menangani nama file yang aneh (khususnya, nama file yang mengandung karakter baris baru) dengan benar. Ini benar terlepas dari sistem operasinya. </p>\n\n<hr>\n\n<p><sup> 1 </sup> Saya m <em> menebak </em> ini hanya berlaku untuk Mac OS hingga versi 9.x, karena Mac OS menggunakan carriage return sebagai karakter baris baru, sementara <code>zip -@</code> mengharapkan umpan baris. </p>","votes":"6","source":"https://superuser.com/a/575337","author":"<a href=\"https://superuser.com/users/101836/dennis\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Dennis</span></a>","replies":[]},{"answer":"<p> Dennis benar, ini tentang OS 9. Saya melihat kode sumber untuk Zip 3.0. Di direktori platform <code>macos/</code>, ada catatan yang berbunyi: </p>\n\n<blockquote>\n  <p> Porta ini untuk versi Mac sebelum Mac OS X. Karena Mac OS X dibuat di Unix,\n  gunakan port Unix untuk Mac OS X. - 7 Juni 2008 </p>\n</blockquote>\n\n<p> Selain itu, file <code>zip.c</code> membungkus deklarasi opsi baris perintah pada <code>#ifndef MACOS</code>. Dengan kata lain, jika saya menjalankan port &quot;MacOS&quot; pada <code>zip</code>, opsi <code>-@</code> akan gagal. </p>\n\n<p> Dennis juga memberikan jawaban untuk &quot;cara yang layak untuk menyelesaikan tugas tanpa <code>-@</code>&quot;, yaitu, </p> <pre><code>find . -name \"*pattern*.txt\" -print0 | xargs -0 zip archive.zip\n</code></pre> <p> Saya setuju bahwa ini adalah cara terbaik untuk melanjutkan agar aman dari nama file &quot;aneh&quot; (nama file dengan spasi, baris baru, dll). Namun, ada penalti kinerja. <code>xargs</code> akan memanggil <code>zip</code> beberapa kali, dengan sejumlah besar nama file diteruskan sebagai parameter baris perintah setiap kali. <code>zip</code> akan menambahkan file tersebut ke <code>archive.zip</code> pada setiap pemanggilan. Tetapi <code>zip</code> perlu membaca <code>archive.zip</code> yang lebih besar pada setiap pemanggilan, yang membutuhkan lebih banyak waktu seiring kemajuan pekerjaan. </p>\n\n<p><strong> Jika </strong> kamu tahu <strong> tentunya </strong> bahwa nama file yang dimaksud tidak memiliki karakter patologis seperti spasi atau baris baru, lalu single-pass </p> <pre><code>find . -name \"*pattern*.txt\" | zip -@ archive.zip\n</code></pre> <p> akan lebih cepat; dan berfungsi dengan baik di OS X, karena <code>zip</code> di OS X sebenarnya adalah port Unix. Peringatan di halaman manual tidak berlaku. </p>","votes":"3","source":"https://superuser.com/a/575721","author":"<a href=\"https://superuser.com/users/212518/andrewtinka\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">andrewtinka</span></a>","replies":[]},{"answer":"<p> Seperti yang ditunjukkan oleh informasi versi Anda, kode dasar (dan mungkin juga dokumentasinya) cukup lama, sementara itu MacOS telah berubah sedikit. Selain itu, build tersebut jauh lebih baru daripada kode dasar, mungkin ada perubahan pada kode / konfigurasi untuk build yang tidak pernah berhasil dimasukkan ke dalam dokumentasi. </p>\n\n<p> Bagaimanapun, lebih baik periksa (dengan contoh kecil mungkin) bahwa perintah berfungsi, dan benar-benar menyimpan file yang diminta. Jika itu penting, jangan percaya kotak berwarna dengan bagian yang hilang di situs Internet acak ... </p>","votes":"0","source":"https://superuser.com/a/575346","author":"<a href=\"https://superuser.com/users/187275/vonbrand\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">vonbrand</span></a>","replies":[]}]}
