{"title":"Menguji status keluar grep dengan pipa dan variabel tidak berhasil","draft":false,"url":"/menguji-status-keluar-grep-dengan-pipa-dan-variabel-tidak-berhasil-a0exwt3i","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["bash","grep","pipe","brackets"],"snippet":"Saya perlu perintah bash test sesingkat mungkin (tes braket) untuk mengevaluasi hasil grep pipa dengan variabel sebagai argumen pencarian. Saya menguji, apakah string baru ada di dalam array - memipakan isi array...","body":"<p> Saya perlu perintah bash test sesingkat mungkin (tes braket) untuk mengevaluasi hasil grep pipa dengan variabel sebagai argumen pencarian. Saya menguji, apakah string baru ada di dalam array - memipakan isi array sebagai baris ke grep dan memeriksa kode keluar. Tapi entah bagaimana itu tidak berhasil. Tidak menemukan nilai dalam larik. Saya telah mencoba dengan berbagai cara tanda kurung, tanda kurung, tanda kutip, titik koma tidak berhasil.\nAda apa disini? </p> <pre><code>#! /bin/bash\nstartLineNrs=();\nstartLineNrs+=(\"45\");\nstartLineNrs+=(\"280\");\nstartLineNrs+=(\"80\");\nstartLineNr=\"280\";\necho \"\\$startLineNrs:\" ${#startLineNrs[@]};\nprintf '%s\\n' \"${startLineNrs[@]}\";\n[ \"$(printf '%s\\n' ${startLineNrs[@]} | grep -xq ${startLineNr})\" ] &amp;&amp; { echo $?; echo Found ;} || { echo $?; echo Not found ;}\n</code></pre> <p> Pada dasarnya saya ingin memahami if ... then construct versus the brackets test. Metode if ... then berfungsi: </p> <pre><code>if !( printf '%s\\n' \"${startLineNrs[@]}\" | grep -xq \"${startLineNr}\" ); then startLineNrs+=(\"$startLineNr\") ; fi\n</code></pre>","source":"https://superuser.com/questions/1305355/testing-grep-exit-status-with-pipe-and-variable-unsuccessful","author":"<a href=\"https://superuser.com/users/385226/uldics\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">uldics</span></a>","replies":[{"reply":"FYI, <code>$?</code> hanya mengembalikan status keluar terakhir pipa, jika Anda memiliki rangkaian pipa yang lebih panjang Anda mungkin ingin $ PIPESTATUS","author":"<a href=\"https://superuser.com/users/307834/xen2050\" target=\"_blank\" rel=\"nofollow noopener\">Xen2050</a>"}],"answers":[{"answer":"<p> Untuk membuat perintah <code>&amp;&amp;</code>--<code>||</code> berfungsi, coba: </p> <pre><code>printf '%s\\n' ${startLineNrs[@]} | grep -xq ${startLineNr}  &amp;&amp; { echo $?; echo Found ;} || { echo $?; echo Not found ;}\n</code></pre> <p> Catatan: </p>\n\n<ol>\n<li><p> Perintah uji (<code>[</code>) dan substitusi perintah (<code>$(...)</code>) tidak diperlukan. </p></li>\n<li><p> Kehalusan dari konstruksi <code>a &amp;&amp; b || c</code> adalah bahwa <code>c</code> akan dijalankan tidak hanya jika <code>a</code> gagal tetapi juga jika <code>b</code> gagal. Karena <code>b</code> Anda terdiri dari <code>echo</code> pernyataan yang biasanya berhasil, ini biasanya tidak menjadi masalah. </p></li>\n<li><p> Untuk metode lain untuk menguji keanggotaan array, lihat <a href=\"https://stackoverflow.com/questions/3685970/check-if-a-bash-array-contains-a-value\" target=\"_blank\" rel=\"nofollow noopener\"> &quot;Periksa apakah array Bash berisi nilai&quot; </a> . </p></li>\n</ol>","votes":"3","source":"https://superuser.com/a/1305360","author":"<a href=\"https://superuser.com/users/277295/john1024\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">John1024</span></a>","replies":[]},{"answer":"<p> Cara yang benar untuk menulis pernyataan if Anda adalah: </p> <pre><code>if printf '%s\\n' \"${startLineNrs[@]}\" | grep -xq \"$startLineNr\"; then\n  # your logic\nfi\n</code></pre> <p> Masalah dengan pernyataan pengujian Anda <code>[...]</code> adalah bahwa <code>[</code> atau <code>test</code> memperlakukan <code>\"$(printf '%s\\n' ${startLineNrs[@]} | grep -xq ${startLineNr})</code> sebagai string, dan tidak menjalankannya sebagai substitusi perintah. Karena ini adalah string yang tidak kosong, ini akan selalu bernilai true. </p>","votes":"3","source":"https://superuser.com/a/1305359","author":"<a href=\"https://superuser.com/users/654416/codeforester\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">codeforester</span></a>","replies":[]}]}
