{"title":"SSH dari jarak jauh ke Bash di Ubuntu pada Windows","draft":false,"url":"/ssh-dari-jarak-jauh-ke-bash-di-ubuntu-pada-windows-x32vjnur","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["networking","ssh","windows-subsystem-for-linux"],"snippet":"Jawaban ini  bekerja bagi saya untuk dapat ssh ke subsistem Linux dari localhost, tetapi itu tidak cukup untuk membiarkan saya masuk dari jarak jauh.  Saya sudah:  Jalankan item Bash Start Menu sebagai...","body":"<p><a href=\"https://superuser.com/a/1114162/634819\" target=\"_blank\" rel=\"nofollow noopener\"> Jawaban ini </a> bekerja bagi saya untuk dapat ssh ke subsistem Linux dari localhost, tetapi itu tidak cukup untuk membiarkan saya masuk dari jarak jauh. </p>\n\n<p> Saya sudah: </p>\n\n<ol>\n<li> Jalankan item Bash Start Menu sebagai administrator; </li>\n<li> Membuat semua <code>/etc/ssh/sshd_config</code> modifikasi yang direkomendasikan dalam jawaban tertaut di atas; </li>\n<li> Diubah dari port 22 ke port 2222 untuk mencoba menghindari masalah keamanan apa pun dengan menggunakan port sistem; </li>\n<li> Diverifikasi bahwa melakukan <code>ssh trey@localhost -p 2222</code> berfungsi seperti yang diharapkan. </li>\n</ol>\n\n<p> Namun, itu tidak memungkinkan saya untuk masuk dari host lain di LAN saya. Jika saya menghentikan layanan (<code>sudo service ssh stop</code>) dan berjalan dalam mode debug (<code>sudo /usr/sbin/sshd -d</code>), saya mendapatkan output berikut: </p> <pre><code>sudo: unable to resolve host SYCORAX\ndebug1: sshd version OpenSSH_6.6.1, OpenSSL 1.0.1f 6 Jan 2014\ndebug1: key_parse_private2: missing begin marker\ndebug1: read PEM private key done: type RSA\ndebug1: private host key: #0 type 1 RSA\ndebug1: key_parse_private2: missing begin marker\ndebug1: read PEM private key done: type DSA\ndebug1: private host key: #1 type 2 DSA\ndebug1: key_parse_private2: missing begin marker\ndebug1: read PEM private key done: type ECDSA\ndebug1: private host key: #2 type 3 ECDSA\ndebug1: private host key: #3 type 4 ED25519\ndebug1: rexec_argv[0]='/usr/sbin/sshd'\ndebug1: rexec_argv[1]='-d'\nSet /proc/self/oom_adj from 0 to -17\ndebug1: Bind to port 2222 on 0.0.0.0.\nServer listening on 0.0.0.0 port 2222.\ndebug1: Bind to port 2222 on ::.\nBind to port 2222 on :: failed: Address already in use.\n</code></pre> <p> Itu bertahan di sana dan tidak berubah jika saya mencoba ssh dari host lain menggunakan alamat IP Ethernet (yang dapat di-ping). Jika saya mencoba ssh dari localhost, itu berlanjut: </p> <pre><code>debug1: Server will not fork when running in debugging mode.\ndebug1: rexec start in 4 out 4 newsock 4 pipe -1 sock 7\ndebug1: inetd sockets after dupping: 3, 3\nConnection from 127.0.0.1 port 60453 on 127.0.0.1 port 2222\ndebug1: Client protocol version 2.0; client software version OpenSSH_6.6.1p1 Ubuntu-2ubuntu2.8\ndebug1: match: OpenSSH_6.6.1p1 Ubuntu-2ubuntu2.8 pat OpenSSH_6.6.1* compat 0x04000000\ndebug1: Enabling compatibility mode for protocol 2.0\ndebug1: Local version string SSH-2.0-OpenSSH_6.6.1p1 Ubuntu-2ubuntu2.8\ndebug1: list_hostkey_types: ssh-rsa,ssh-dss,ecdsa-sha2-nistp256,ssh-ed25519\ndebug1: SSH2_MSG_KEXINIT sent\ndebug1: SSH2_MSG_KEXINIT received\ndebug1: kex: client-&gt;server aes128-ctr hmac-md5-etm@openssh.com none\ndebug1: kex: server-&gt;client aes128-ctr hmac-md5-etm@openssh.com none\ndebug1: expecting SSH2_MSG_KEX_ECDH_INIT\ndebug1: SSH2_MSG_NEWKEYS sent\ndebug1: expecting SSH2_MSG_NEWKEYS\ndebug1: SSH2_MSG_NEWKEYS received\ndebug1: KEX done\ndebug1: userauth-request for user trey service ssh-connection method none\ndebug1: attempt 0 failures 0\ndebug1: PAM: initializing for \"trey\"\ndebug1: PAM: setting PAM_RHOST to \"localhost\"\ndebug1: PAM: setting PAM_TTY to \"ssh\"\nFailed none for trey from 127.0.0.1 port 60453 ssh2\ndebug1: userauth-request for user trey service ssh-connection method password\ndebug1: attempt 1 failures 0\ndebug1: PAM: password authentication accepted for trey\nAccepted password for trey from 127.0.0.1 port 60453 ssh2\ndebug1: do_pam_account: called\ndebug1: PAM: establishing credentials\ndebug1: Entering interactive session for SSH2.\ndebug1: server_init_dispatch_20\ndebug1: server_input_channel_open: ctype session rchan 0 win 1048576 max 16384\ndebug1: input_session_request\ndebug1: channel 0: new [server-session]\ndebug1: session_new: session 0\ndebug1: session_open: channel 0\ndebug1: session_open: session 0: link with channel 0\ndebug1: server_input_channel_open: confirm session\ndebug1: server_input_global_request: rtype no-more-sessions@openssh.com want_reply 0\ndebug1: server_input_channel_req: channel 0 request pty-req reply 1\ndebug1: session_by_channel: session 0 channel 0\ndebug1: session_input_channel_req: session 0 req pty-req\ndebug1: Allocating pty.\ndebug1: session_pty_req: session 0 alloc /dev/pts/0\ndebug1: SELinux support disabled\ndebug1: server_input_channel_req: channel 0 request env reply 0\ndebug1: session_by_channel: session 0 channel 0\ndebug1: session_input_channel_req: session 0 req env\ndebug1: server_input_channel_req: channel 0 request shell reply 1\ndebug1: session_by_channel: session 0 channel 0\ndebug1: session_input_channel_req: session 0 req shell\nStarting session: shell on pts/0 for trey from 127.0.0.1 port 60453\ndebug1: Setting controlling tty using TIOCSCTTY.\n</code></pre> <p> Dan saya berhasil masuk dari klien SSH lokal, yang mencetak pesan debug berikut: </p> <pre><code>trey@localhost's password:\nWelcome to Ubuntu 14.04.5 LTS (GNU/Linux 3.4.0+ x86_64)\n\n * Documentation:  https://help.ubuntu.com/\n\nLast login: Sat Aug 27 14:51:29 2016 from localhost\ndebug1: PAM: reinitializing credentials\ndebug1: permanently_set_uid: 1000/1000\ndebug1: Unable to open session: Failed to connect to socket /var/run/dbus/system_bus_socket: No such file or directory\nEnvironment:\n  LANG=en_US.UTF-8\n  USER=trey\n  LOGNAME=trey\n  HOME=/home/trey\n  PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games\n  MAIL=/var/mail/trey\n  SHELL=/bin/bash\n  SSH_CLIENT=127.0.0.1 60453 2222\n  SSH_CONNECTION=127.0.0.1 60453 127.0.0.1 2222\n  SSH_TTY=/dev/pts/0\n  TERM=xterm\ntrey@SYCORAX:~$\n</code></pre> <p> Setelah saya logout dari lokal itu <em> ssh </em> , Saya mendapatkan yang berikut dari <em> sshd </em> proses sebelum keluar: </p> <pre><code>debug1: Received SIGCHLD.\ndebug1: session_by_pid: pid 677\ndebug1: session_exit_message: session 0 channel 0 pid 677\ndebug1: session_exit_message: release channel 0\ndebug1: session_pty_cleanup: session 0 release /dev/pts/0\nsyslogin_perform_logout: logout() returned an error\ndebug1: session_by_channel: session 0 channel 0\ndebug1: session_close_by_channel: channel 0 child 0\ndebug1: session_close: session 0 pid 0\ndebug1: channel 0: free: server-session, nchannels 1\nReceived disconnect from 127.0.0.1: 11: disconnected by user\ndebug1: do_cleanup\ndebug1: PAM: cleanup\ndebug1: PAM: closing session\ndebug1: PAM: deleting credentials\ndebug1: audit_event: unhandled event 12\n</code></pre> <p> Menariknya, saya tidak mengalami masalah apa pun ssh&#39;ing (baik secara lokal atau jarak jauh) ke virtual Hyper-V yang menjalankan Ubuntu 16 pada host yang sama dengan <em> sshd </em> berjalan pada port 22. (Tentu saja, tamu VM Hyper-V berada di alamat IP yang berbeda dari host Windows.) </p>\n\n<p> Telnet ke port 2222 juga tidak berhasil. </p>\n\n<p> Saya menduga ketidakmampuan <em> sshd </em> mengikat ke port IPv6 adalah kunci untuk memahami apa yang terjadi, tetapi alat yang saya ketahui (baik dari sisi Windows dan Linux) tidak menunjukkan apa pun yang terikat ke port 2222 di TCP v4 atau v6. </p>","source":"https://superuser.com/questions/1118333/ssh-remotely-into-bash-on-ubuntu-on-windows","author":"<a href=\"https://superuser.com/users/634819/trey\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Trey</span></a>","replies":[],"answers":[{"answer":"<p> Anda mungkin harus membuat lubang di Windows Firewall Anda. Saya mengalami masalah ini dan memverifikasi dengan mematikan WF sebentar dan mengonfirmasi bahwa saya dapat mengakses dari mesin eksternal. </p>\n\n<p> Saya kemudian menambahkan aturan untuk mengizinkan port yang saya siapkan, untuk Anda itu adalah 2222. </p>\n\n<p> Saya mengaktifkan kembali WF dan semuanya baik-baik saja. </p>","votes":"6","source":"https://superuser.com/a/1132686","author":"<a href=\"https://superuser.com/users/649961/shadowzen\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">shadowzen</span></a>","replies":[{"reply":"Bisakah Anda lebih spesifik tentang pengaturan WF?","author":"<a href=\"https://superuser.com/users/362782/qinsi\" target=\"_blank\" rel=\"nofollow noopener\">Qinsi</a>"},{"reply":"Apakah Anda bertanya tentang secara khusus tentang cara menambahkan aturan ke Windows Firewall? Jika demikian, akses WF melalui panel kontrol, klik Pengaturan lanjutan, lalu pilih Aturan masuk atau Keluar. Biasanya, Anda ingin menambahkan aturan masuk dan, khusus untuk ssh, Anda ingin menambahkan aturan untuk membuka (mengizinkan) port untuk TCP, menambahkan satu untuk UDP tidak diperlukan. Dari sana, ada sejumlah variabel terserah Anda untuk menentukan apa yang harus dipilih untuk situasi Anda, wizard akan meminta Anda dengan opsi.","author":"<a href=\"https://superuser.com/users/649961/shadowzen\" target=\"_blank\" rel=\"nofollow noopener\">shadowzen</a>"}]},{"answer":"<pre><code>debug1: Bind to port 2222 on 0.0.0.0.\nServer listening on 0.0.0.0 port 2222.\ndebug1: Bind to port 2222 on ::.\nBind to port 2222 on :: failed: Address already in use.\n</code></pre> <p> Anda melakukan bind ke port <code>2222</code> dua kali di <code>sshd_config</code>. Bagaimana tampilan file tersebut? </p>\n\n<p> Tidak yakin apakah ada masalah lain yang tersembunyi di antara baris, jika demikian, harap jelaskan. </p>","votes":"0","source":"https://superuser.com/a/1118334","author":"<a href=\"https://superuser.com/users/466930/jakuje\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Jakuje</span></a>","replies":[{"reply":"Saya tidak mengikuti .... Saya tidak menjalankan <code>sshd -d</code> <i> server </i> dengan <code>-p 2222</code>, saya menjalankan <code>ssh</code> <i> klien </i> lewat sana. (Meskipun ssh lokal dapat membaca file <code>&#47;etc&#47;ssh&#47;sshd_config</code> mencari nomor port, ssh jarak jauh jelas tidak bisa.). Satu ikatan adalah ke port IPv4, yang lainnya ke port IPv6. Itu perilaku normal, meskipun ketidakmampuan untuk mengikat port IPv6 tidak.","author":"<a href=\"https://superuser.com/users/634819/trey\" target=\"_blank\" rel=\"nofollow noopener\">Trey</a>"},{"reply":"Dan untuk menjawab pertanyaan Anda secara langsung: $ grep -i port / etc / ssh / sshd_config &lt;NL&gt; # Port, IP dan protokol apa yang kami dengarkan &lt;NL&gt; Port 2222 &lt;NL&gt;","author":"<a href=\"https://superuser.com/users/634819/trey\" target=\"_blank\" rel=\"nofollow noopener\">Trey</a>"},{"reply":"maaf, itu bug di postingan, sudah diperbaiki. Mungkin ada <code>Port</code> dan <code>ListenAddress</code>. Tapi saya tidak yakin seberapa baik itu didukung oleh Windows sekarang. Apakah ini berfungsi untuk Anda jika Anda hanya mengatur IPv4 (<code>AddressFamily inet</code>)?","author":"<a href=\"https://superuser.com/users/466930/jakuje\" target=\"_blank\" rel=\"nofollow noopener\">Jakuje</a>"}]},{"answer":"<p> Dari Konsol PowerShell Anda yang ditinggikan di Win 10, keluarkan perintah berikut: </p> <pre><code>New-NetFirewallRule -DisplayName \"Allow Inbound Port 2222\" -Direction Inbound -LocalPort 2222 -Protocol TCP -Action Allow\n</code></pre> <p> Dengan perintah PS di atas, Anda akan membuka porta masuk 2222 di Windows Firewall. Itu akan memungkinkan host LAN Anda yang lain untuk masuk ke Instans WSL Anda pada host Win 10 Anda saat ini. </p>\n\n<p> HTH </p>","votes":"0","source":"https://superuser.com/a/1419560","author":"<a href=\"https://superuser.com/users/871318/the-bahree\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">The Bahree</span></a>","replies":[]}]}
