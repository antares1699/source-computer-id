{"title":"Ubah RAID 1 ke RAID 10 di mdadm","draft":false,"url":"/ubah-raid-1-ke-raid-10-di-mdadm-nzfkywll","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["software-raid","mdadm"],"snippet":"Di server Ubuntu saya saat ini, saya memiliki hard drive Western Digital RED 2x 2TB dalam RAID 1, menggunakan mdadm. Saya ingin menambahkan 2 lagi drive 2TB RED, dan mengubahnya menjadi RAID...","body":"<p> Di server Ubuntu saya saat ini, saya memiliki hard drive Western Digital RED 2x 2TB dalam RAID 1, menggunakan mdadm. Saya ingin menambahkan 2 lagi drive 2TB RED, dan mengubahnya menjadi RAID 10. Saya menyadari bahwa saya harus menghapus data kemungkinan besar, tetapi adakah cara yang tidak saya perlukan? Saya memiliki volume 2TB yang hampir terisi penuh </p>","source":"https://superuser.com/questions/610538/convert-raid-1-to-raid-10-in-mdadm","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Canadian Luke</span></a>","replies":[{"reply":"Saya yakin opsi level mdadm --grow akan memungkinkan ini. Saya telah menggunakannya untuk beralih dari raid5 ke raid6 tetapi tidak dari raid1 ke raid10 jadi saya belum mengujinya.","author":"<a href=\"https://superuser.com/users/76204/drescherjm\" target=\"_blank\" rel=\"nofollow noopener\">drescherjm</a>"},{"reply":"BTW sebelum Anda tumbuh, Anda akan menambahkan 2 drive lainnya sebagai suku cadang.","author":"<a href=\"https://superuser.com/users/76204/drescherjm\" target=\"_blank\" rel=\"nofollow noopener\">drescherjm</a>"},{"reply":"Pertanyaan serupa: <a href=\"http://serverfault.com/questions/43677/best-way-to-grow-linux-software-raid-1-to-raid-10\" title=\"best way to grow linux software raid 1 to raid 10\" target=\"_blank\" rel=\"nofollow noopener\"> serverfault.com/questions/43677/â€¦ </a>","author":"<a href=\"https://superuser.com/users/3680/kevin-panko\" target=\"_blank\" rel=\"nofollow noopener\">Kevin Panko</a>"},{"reply":"@KevinPerlu duplikat! Oh baiklah, dia mendapat suara positif saya","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\">Canadian Luke</a>"}],"answers":[{"answer":"<p> Ini membutuhkan beberapa strategi, dan sayangnya, beberapa waktu yang lalu, jadi bersabarlah; Aku akan mengingatnya. </p>\n\n<p> Pada dasarnya, saya mematikan server, dan memasang dua drive baru. Saya melakukan backup sebelumnya ke HDD 4TB Eksternal (jauh lebih cepat karena memiliki USB3!), Untuk berjaga-jaga. Untungnya, saya tidak perlu menggunakannya, tetapi saya senang setidaknya sudah memilikinya. Saya mencatat apa ukuran partisi pada disk (berdasarkan ukuran blok), dan apa setiap disk itu. Pada saat itu, <code>sda</code> dan <code>sdb</code> adalah drive dengan array arus yang dimuat. <code>sdc</code> dan <code>sdd</code> adalah drive baru. Saya menyalin tata letak partisi ke dua disk baru, menggunakan <code>fdisk</code> sebagai root. Saya kemudian membuat array baru, dengan dua anggota yang hilang: </p> <pre><code>mdadm -v --create /dev/md1 --level=raid10 --raid-devices=4 /dev/sdc1 missing /dev/sdd2 missing\n</code></pre> <p> Perintah ini membuat larik, yang disebut <code>/dev/md1</code>, menyetel jenis RAID ke 10, dan mengatakan bahwa harus ada 4 perangkat, di dunia yang sempurna. Perangkat yang saya tambahkan adalah <code>/dev/sdc1</code> dan <code>/dev/sdd1</code> untuk partisi pertama. Setelah selesai, saya memasang array (seperti <code>/mnt/raid</code>), dan melakukan <code>rsync -avP /mnt/data/ /mnt/raid/</code>, dan menunggu satu hari untuk menyalin semuanya. </p>\n\n<p> Setelah disalin, Anda harus menggagalkan hard drive dalam larik, dan menghapusnya: <code>mdadm /dev/md0 --fail /dev/sda1 --remove /dev/sda1</code>. Anda kemudian dapat menambahkan hard drive tersebut ke larik baru, dan menunggu hingga selesai dibangun kembali. Kemudian, hapus drive terakhir dari array (sebagai gantinya gunakan <code>/deb/sdb</code>), dan tambahkan kembali (<code>mdadm /dev/md1 --add /dev/sda1</code>). </p>\n\n<p> Terakhir, untuk menghapus array lama agar tidak memulai atau memberi peringatan, jalankan <code>mdadm --stop /dev/md0</code>. Pada titik ini, array lama hilang! Saya menyarankan untuk memeriksa ulang apakah boot loader telah diinstal dengan benar pada array (atau, tergantung pada skema Anda, sektor boot dari hard drive). Coba reboot; jika semuanya muncul, bagus! Jika tidak, itulah mengapa kami memiliki cadangan! </p>\n\n<p> Sebagai bonus, saya mempelajari perintah baru yang berguna: <code>watch cat /proc/mdstat</code> untuk secara otomatis memperbarui layar setiap 2 detik dengan status pembangunan kembali drive Anda. saya juga <a href=\"https://www.talk-about-it.ca/growing-2-disk-raid1-array-to-4-disk-raid10-array/\" rel=\"nofollow noopener\" target=\"_blank\"> menulis entri blog </a> tentang pengalaman saya, termasuk gambar. </p>","votes":"8","source":"https://superuser.com/a/726063","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Canadian Luke</span></a>","replies":[{"reply":"<a href=\"http://serverfault.com/a/43712/257516\" target=\"_blank\" rel=\"nofollow noopener\"> ServerFault </a> memiliki prosedur yang sangat mirip, dengan satu saran penting: cobalah untuk mem-boot array baru Anda sebelum menghancurkan yang lama (tidak apa-apa jika gagal <i> satu </i> drive dalam larik lama sebelumnya, tetapi tidak keduanya).","author":"<a href=\"https://superuser.com/users/294963/jonathan-y\" target=\"_blank\" rel=\"nofollow noopener\">Jonathan Y.</a>"},{"reply":"@Jonathan telah memberikan komentar untuk pertanyaan tersebut","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\">Canadian Luke</a>"},{"reply":"Oh iya. Meskipun, saya yakin perlu menyebutkan perbedaan spesifik itu secara eksplisit.","author":"<a href=\"https://superuser.com/users/294963/jonathan-y\" target=\"_blank\" rel=\"nofollow noopener\">Jonathan Y.</a>"},{"reply":"Simulasikan ini dengan perangkat loopback yang menggunakan <code>&#47;dev&#47;loop0</code>, <code>&#47;dev&#47;loop1</code>, <code>&#47;dev&#47;loop2</code>, <code>&#47;dev&#47;loop3</code>, dengan masing-masing mengarah ke file <code>disk0.img</code>, <code>disk1.img</code>, <code>disk2.img</code>, <code>disk3.img</code>. Itu berhasil dan saya berhasil menulisnya sepenuhnya dengan file teks dan berhasil membacanya kembali tanpa korupsi. Satu hal yang tidak dapat saya pahami, dengan <code>mdadm --details &#47;dev&#47;mdX</code>, <code>Used Dev Size</code> adalah setengah dari <code>Array Size</code>, saya mengulanginya sambil mengubah urutan <code>missing</code>, tidak masalah. Saya memiliki 3 array RAID lainnya, 2 di antaranya RAID 1, salah satunya RAID10 dengan 2 disk menggunakan tata letak <code>f2</code>, untuk semua ukuran sama.","author":"User"},{"reply":"@CanadianLuke Ketika Anda <code>mdadm --detail &#47;dev&#47;mdX</code>, apa itu <code>Array Size</code> dan apa <code>Used Dev Size</code>?","author":"User"},{"reply":"@sdkks tidak yakin, itu beberapa tahun yang lalu","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\">Canadian Luke</a>"},{"reply":"@CanadianLuke Ups, saya berharap Anda masih memiliki array yang sama :) Terima kasih. Belum dapat menemukan apa pun tentang itu di Google","author":"User"},{"reply":"Biarkan saya muncul di komputer. Bergabunglah dengan ruang obrolan &quot;akses root&quot;","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\">Canadian Luke</a>"},{"reply":"@CanadianLukeREINSTATEMONICA situasi saya seperti yang dijelaskan dalam posting blog Anda. Posting blog yang luar biasa, terima kasih! Satu-satunya hal yang tidak jelas adalah apakah saya dapat melakukan ini di Debian 10 (/ pada ext4 RAID 1 di sda &amp; sdb) online, yaitu, tidak membuat server down dan boot dari live CD?","author":"<a href=\"https://superuser.com/users/68374/gaia\" target=\"_blank\" rel=\"nofollow noopener\">Gaia</a>"},{"reply":"@ Gaia Ya, selama setidaknya satu disk tetap online. Namun, jika sistemnya sangat sibuk, mungkin bermanfaat (dan, sebenarnya, disarankan) untuk melakukannya secara offline dengan LiveCD atau serupa. Anda tidak ingin membenturkan kedua salinan data Anda saat mencoba memulihkan","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\">Canadian Luke</a>"},{"reply":"hanya partisi root yang perlu dialihkan. sebagian besar aktivitas ada di SSD, dan hanya ada satu VM tamu yang menggunakan HD yang sama (tetapi di partisi berbeda) sebagai partisi root. Seharusnya bagus. Anda adalah penyelamat. Terima kasih - tidak mungkin saya dapat membuat sistem ini offline :) Instruksi yang sama masih berlaku untuk menjaga sistem tetap online?","author":"<a href=\"https://superuser.com/users/68374/gaia\" target=\"_blank\" rel=\"nofollow noopener\">Gaia</a>"},{"reply":"@ Gaia Pastikan Anda memiliki backup yang berfungsi dengan baik terlebih dahulu! Hal terakhir yang saya inginkan adalah seseorang menyalahkan saya jika mereka salah mengetik perintah dan melanggar sesuatu yang tidak mereka maksudkan","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\">Canadian Luke</a>"},{"reply":"Terima kasih, saya memiliki tiga cadangan harian (lokal, drive usb, cloud)","author":"<a href=\"https://superuser.com/users/68374/gaia\" target=\"_blank\" rel=\"nofollow noopener\">Gaia</a>"},{"reply":"@CanadianLukeREINSTATEMONICA mengirimi Anda pesan di Keybase.","author":"<a href=\"https://superuser.com/users/68374/gaia\" target=\"_blank\" rel=\"nofollow noopener\">Gaia</a>"}]},{"answer":"<p> Jika pengontrol RAID mendukung restrukturisasi RAID 1 -&gt; RAID 10, ya, kemungkinan data hilang. </p>\n\n<p> RAID perangkat lunak ... </p>\n\n<p> Tambahkan RAID 1 bersih kosong pada dua HDD baru. Akan Raid c keandalan serupa dan tanpa risiko kehilangan data. </p>","votes":"0","source":"https://superuser.com/a/610569","author":"<a href=\"https://superuser.com/users/183984/sttr\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">STTR</span></a>","replies":[{"reply":"Uhhh ... Apa? <i> Minimal 15 karakter </i>","author":"<a href=\"https://superuser.com/users/24010/canadian-luke\" target=\"_blank\" rel=\"nofollow noopener\">Canadian Luke</a>"},{"reply":"@Luke Software RAID kepada saya tentang itu ... <a href=\"http://www.youtube.com/watch?feature=player_embedded&v=THJDDF8XDKQ#t=285s\" rel=\"nofollow noopener\" target=\"_blank\"> youtube.com/â€¦ </a>","author":"<a href=\"https://superuser.com/users/183984/sttr\" target=\"_blank\" rel=\"nofollow noopener\">STTR</a>"}]}]}
