{"title":"Interop Excel - panggilan prosedur jarak jauh gagal atau RPC_E_SERVERFAULT","draft":false,"url":"/interop-excel-panggilan-prosedur-jarak-jauh-gagal-atau-rpc-e-serverfault-iwctd7mw","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["microsoft-excel","microsoft-office","automation","rpc"],"snippet":"Kami memiliki aplikasi C # yang secara internal memanggil excel. Ia melakukannya dengan menggunakan Microsoft.Office.Interop.Excel.dll. Aplikasi ini berfungsi di sebagian besar komputer dengan Excel, tetapi tidak di komputer saya.  Awalnya, aplikasi gagal...","body":"<p> Kami memiliki aplikasi C # yang secara internal memanggil excel. Ia melakukannya dengan menggunakan Microsoft.Office.Interop.Excel.dll. Aplikasi ini berfungsi di sebagian besar komputer dengan Excel, tetapi tidak di komputer saya. </p>\n\n<p> Awalnya, aplikasi gagal dengan HRESULT 0x800706BE (Panggilan prosedur jarak jauh gagal). Saya telah mencoba hampir semua saran yang ditemukan di web, tetapi tidak berhasil. Kemudian saya menghapus instalan MS Office 2013 Pro saya, dan menginstal Office 365 v2013. Aplikasi masih gagal pada baris kode yang sama, tetapi sekarang dengan HRESULT 0x80010105 (RPC_E_SERVERFAULT). </p>\n\n<p> Adakah saran yang dapat Anda berikan untuk membuat interop excel berfungsi?\nDugaan saya adalah bahwa beberapa layanan Windows tidak dimulai atau komponen DCOM tidak terdaftar. Tapi saya tidak tahu yang mana. </p>\n\n<p><strong> Detailnya: </strong></p>\n\n<ul>\n<li> Windows 7 x64, MS Office 2013 Pro / 365 ProPlus </li>\n<li> Ini adalah aplikasi C #. Ini dikompilasi dengan VS2010 untuk .NET 4.0, tetapi masalah tetap muncul bahkan ketika aplikasi dikompilasi dengan VS2012 untuk .NET 4.5. Dengan menggunakan versi yang berbeda dari Microsoft.Office.Interop.Excel.dll. </li>\n</ul>\n\n<p> Ada tiga fakta yang saya anggap penting: </p>\n\n<ul>\n<li> Aplikasi berfungsi di komputer lain, jadi bukan aplikasi yang menjadi penyebab masalah. </li>\n<li> Aplikasi tidak berfungsi bahkan setelah instalasi ulang (versi yang sedikit berbeda dari) excel (2013), jadi mungkin itu bukan masalah excel itu sendiri. </li>\n<li> Saya menggunakan ProcessMonitor SysInternals untuk mengetahui bahwa aplikasi tersebut benar-benar berhasil dalam membuat instance excel, dan excel berhasil (?) Membaca file .xlsx. Tapi kemudian excel gagal. </li>\n</ul>\n\n<p> Saya juga menggunakan debugger VS2010 untuk mencari tahu apa yang terjadi: </p>\n\n<ul>\n<li><p> Ini adalah inti dari kode. Gagal di baris terakhir di Buka: </p> <pre><code>using Excel = Microsoft.Office.Interop.Excel;\nobject misValue = System.Reflection.Missing.Value;\n\nExcel.Application myExcelApp = new Excel.Application();\nmyExcelApp.Visible = false;\nmyExcelWorkbooks = myExcelApp.Workbooks;\nmyExcelWorkbook = myExcelWorkbooks.Open(xlsxFileFullPath, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue);\n</code></pre> </li>\n<li><p> Tidak ada yang relevan di log peristiwa Windows (pada saat aplikasi gagal). </p></li>\n<li> Berikut adalah beberapa tautan yang saya temukan, tetapi tidak ada saran yang diberikan, atau tidak membantu: <a href=\"http://www.xtremevbtalk.com/-net-office-automation/309418-code-hangs-excel-file-excel-workbook-object.html\" rel=\"nofollow noopener\" target=\"_blank\"> link1 </a> , <a href=\"https://stackoverflow.com/questions/37017229/system-runtime-interopservices-comexception-0x800706be-the-remote-procedure-c\" target=\"_blank\" rel=\"nofollow noopener\"> link2 </a> , ... (tidak dapat memposting lebih dari 2 link) </li>\n</ul>","source":"https://superuser.com/questions/1124945/excel-interop-remote-procedure-call-failed-or-rpc-e-serverfault","author":"<a href=\"https://superuser.com/users/641676/xarx\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">xarx</span></a>","replies":[],"answers":[{"answer":"<p> Setelah penelitian yang lama saya berhasil memecahkan masalah ini karena ini <a href=\"https://www-01.ibm.com/support/docview.wss?uid=swg21981407\" rel=\"nofollow noopener\" target=\"_blank\"> tautan </a> . Pada dasarnya, masalah ini disebabkan oleh plugin COM Excel pihak ketiga, dalam kasus saya adalah &quot;FoxitReader PDF Creator COM Add-in&quot;. Setelah menonaktifkannya, masalahnya hilang! </p>\n\n<p> Cara menonaktifkan plugin: Excel&gt; File&gt; Opsi&gt; Add-in&gt; Kelola, lalu pilih &quot;COM add-in&quot;&gt; Buka. Dan kemudian hapus centang pada plugin yang bermasalah. </p>","votes":"11","source":"https://superuser.com/a/1127461","author":"<a href=\"https://superuser.com/users/641676/xarx\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">xarx</span></a>","replies":[{"reply":"Terima kasih banyak! itu dia! Untuk salah satu kolega Prancis saya yang menelusuri kesalahan Prancis: Échec de l’appel de procédure distante","author":"<a href=\"https://superuser.com/users/634543/simon\" target=\"_blank\" rel=\"nofollow noopener\">Simon</a>"},{"reply":"Bagaimana sih Anda mengetahui hal ini? Terima kasih!","author":"<a href=\"https://superuser.com/users/860491/jason-washo\" target=\"_blank\" rel=\"nofollow noopener\">Jason Washo</a>"}]},{"answer":"<p> Saya memiliki masalah yang sama persis dengan xarx. Tiba-tiba aplikasi yang saya buat berhenti berfungsi pada PC tertentu. Kode yang menyebabkan crash adalah: </p> <pre><code>Dim fname As String = \"B:\\Data Warehouse\\Lists\\WarehouseLists.xls\"\n    Try\n        xlWorkBookList = xlAppLists.Workbooks.Open(fname,, False) 'open the raw data sheet\n    Catch ex As Exception\n        MessageBox.Show(ex.Message)\n        Exit Sub\n    End Try\n</code></pre> <p> Menonaktifkan add-in Foxit Reader segera memperbaiki masalah tersebut. </p>","votes":"2","source":"https://superuser.com/a/1156194","author":"<a href=\"https://superuser.com/users/631579/thomas-bailey\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Thomas Bailey</span></a>","replies":[]}]}
