{"title":"Bagaimana cara menjalankan perintah pembersihan pada keluar dari server / sesi tmux?","draft":false,"url":"/bagaimana-cara-menjalankan-perintah-pembersihan-pada-keluar-dari-server-sesi-tmux-oqhsohdc","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["command-line","tmux","session-restore","session-manager"],"snippet":"Untuk sedikit meningkatkan alur kerja saya, saya telah menulis beberapa skrip pembungkus untuk secara otomatis memulai beberapa perintah ketika saya ingin mengerjakan sebuah proyek. Namun setelah saya selesai, dan bersihkan semua tab...","body":"<p> Untuk sedikit meningkatkan alur kerja saya, saya telah menulis beberapa skrip pembungkus untuk secara otomatis memulai beberapa perintah ketika saya ingin mengerjakan sebuah proyek. Namun setelah saya selesai, dan bersihkan semua tab tmux untuk sesi khusus ini, saya ingin menghentikan beberapa proses dan membersihkan beberapa file. </p>\n\n<p> Apakah ada cara untuk menjalankan perintah secara otomatis saat keluar dari server tmux? </p>\n\n<p> Alur kerja yang diinginkan: </p>\n\n<ul>\n<li> jalankan perintah untuk membuat server tmux baru, buka beberapa file, mulai beberapa aplikasi </li>\n<li> bekerja di sesi tersebut </li>\n<li> lepaskan untuk mengerjakannya nanti </li>\n<li> pasang kembali </li>\n<li> ketika semua tab di server tmux ditutup dan server dihancurkan, jalankan perintah pembersihan </li>\n</ul>\n\n<p> [edit] Skrip yang saat ini saya gunakan: <a href=\"https://github.com/WoLpH/dotfiles/blob/master/bin/tmx\" rel=\"nofollow noopener\" target=\"_blank\"> https://github.com/WoLpH/dotfiles/blob/master/bin/tmx </a></p>","source":"https://superuser.com/questions/592063/how-to-execute-a-cleanup-command-on-tmux-server-session-exit","author":"<a href=\"https://superuser.com/users/44671/wolph\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Wolph</span></a>","replies":[{"reply":"dengan &quot;perintah pembersihan&quot; yang Anda maksud adalah perintah khusus server? Misalnya, Anda memiliki sesi terbuka untuk proyek A dan sesi lain untuk proyek B. Jadi Anda ingin menjalankan pembersihan_A ketika session_A ditutup? Atau apakah maksud Anda sesuatu yang berbeda?","author":"<a href=\"https://superuser.com/users/93719/scicalculator\" target=\"_blank\" rel=\"nofollow noopener\">scicalculator</a>"},{"reply":"Ya, itulah yang saya maksud. Tetapi perintah pembersihan umum juga dapat berfungsi, saya dapat dengan mudah menyimpulkan proyek yang dibuka sebelumnya dari file yang tersisa. Saya hanya perlu pemicu keluar dari server apa pun sehingga saya dapat melepas beberapa hal.","author":"<a href=\"https://superuser.com/users/44671/wolph\" target=\"_blank\" rel=\"nofollow noopener\">Wolph</a>"},{"reply":"Saya telah menulis utilitas baris perintah untuk membuat skrip pengaturan / pembongkaran sesi tmux: <a href=\"https://github.com/tarruda/tmuxer\" rel=\"nofollow noopener\" target=\"_blank\"> github.com/tarruda/tmuxer </a> . Bahkan termasuk pengganti &#39;sesi pilih&#39; yang akan membiarkan Anda memilih sesi &#39;tertutup&#39;","author":"<a href=\"https://superuser.com/users/51771/thiago-de-arruda\" target=\"_blank\" rel=\"nofollow noopener\">Thiago de Arruda</a>"},{"reply":"@ThiadodeArruda: sepertinya keren, saya akan segera mengujinya. Saat ini saya menggunakan skrip ini: <a href=\"https://github.com/WoLpH/dotfiles/blob/master/bin/tmx\" rel=\"nofollow noopener\" target=\"_blank\"> github.com/WoLpH/dotfiles/blob/master/bin/tmx </a>","author":"<a href=\"https://superuser.com/users/44671/wolph\" target=\"_blank\" rel=\"nofollow noopener\">Wolph</a>"},{"reply":"@Wolph: Saya juga telah mengintegrasikan solusi saya ke dalam skrip dotfiles-zsh, baru-baru ini saya mengekstrak ke dalam satu set skrip shell yang kompatibel dengan posix yang dapat digunakan kembali untuk portabilitas yang lebih baik dan lebih mudah digunakan kembali oleh orang lain","author":"<a href=\"https://superuser.com/users/51771/thiago-de-arruda\" target=\"_blank\" rel=\"nofollow noopener\">Thiago de Arruda</a>"},{"reply":"btw, jika Anda menggunakan tmuxinator, Anda cukup menambahkan perintah <code>post</code> di file konfigurasi Anda.","author":"<a href=\"https://superuser.com/users/508119/valentin-waeselynck\" target=\"_blank\" rel=\"nofollow noopener\">Valentin Waeselynck</a>"},{"reply":"@ValentinWaeselynck: itu akan menjadi alternatif yang bagus. Bagi saya itu tidak terlalu cocok karena saya secara teratur bekerja di server (usang) di mana saya memiliki dukungan perangkat lunak yang sangat sedikit dan tmuxinator memiliki terlalu banyak deps untuk diinstal.","author":"<a href=\"https://superuser.com/users/44671/wolph\" target=\"_blank\" rel=\"nofollow noopener\">Wolph</a>"}],"answers":[{"answer":"<p> Untuk saat ini, tidak ada cara khusus agar tmux secara otomatis menjalankan perintah yang dipicu oleh <code>detach</code> atau menutup semua jendela dalam sesi tersebut. Namun, karena Anda sudah memiliki skrip pembungkus (saya akan menyebutnya <code>tmux_wrapper</code>) yang membuka sesi khusus yang Anda inginkan, Anda dapat dengan mudah mengonversi skrip ini untuk mengotomatiskan pembersihan. Saya melakukan sesuatu yang sangat mirip dengan ini sendiri <a href=\"https://github.com/scicalculator/tmux-tmx/blob/master/bin/tmx\" rel=\"nofollow noopener\" target=\"_blank\"> sini </a> , di mana saya ingin mengizinkan sesi tmux bersarang jika saya melampirkan melalui ssh. </p>\n\n<p> Karena Anda memiliki pengalaman khusus dalam pikiran, Anda tidak lagi memerlukan <code>tmux attach ....</code> atau perintah serupa, jadi saya akan menganggap Anda selalu memulai sesi untuk proyek A dengan sesuatu seperti <code>tmux_wrapper A</code>. Dalam pembungkus Anda, Anda mungkin memiliki baris yang mirip dengan <code>tmux new-session -s A</code>. Di sini kita bisa manfaatkan nama sesi <code>A</code>. Kemudian, di akhir pembungkus Anda, Anda dapat memiliki sakelar pembersihan yang hanya aktif jika sesi tidak lagi aktif (yaitu jendela / panel tidak lagi dapat dipasang). </p>\n\n<p> Contoh sederhana <code>tmux_wrapper</code> akan terlihat seperti ini: </p> <pre><code>#!/bin/sh\n\nsess=$1\n\n# test if the session has windows\nis_closed(){ \n    n=$(tmux ls 2&gt; /dev/null | grep \"^$sess\" | wc -l)\n    [[ $n -eq 0 ]]\n}\n\n# either create it or attach to it\nif is_closed ; then\n  tmux new -s $sess\nelse\n  tmux attach -t $sess\nfi\n\n# the session is now either closed or detatched\nif is_closed ; then\n    # perform cleanup here ...\nfi\n</code></pre> <p> Jalankan seperti <code>tmux_wrapper A</code>. Sekarang, pembersihan akan secara otomatis terjadi untuk sesi A jika dan hanya jika sesi telah ditutup sepenuhnya. </p>","votes":"6","source":"https://superuser.com/a/593370","author":"<a href=\"https://superuser.com/users/93719/scicalculator\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">scicalculator</span></a>","replies":[{"reply":"Bukan solusi tercantik tetapi harus berhasil :) Terima kasih! Saya memang punya skrip yang mirip, Anda bisa menemukannya di sini jika Anda tertarik: <a href=\"https://gist.github.com/WoLpH/3163775\" rel=\"nofollow noopener\" target=\"_blank\"> gist.github.com/WoLpH/3163775 </a>","author":"<a href=\"https://superuser.com/users/44671/wolph\" target=\"_blank\" rel=\"nofollow noopener\">Wolph</a>"}]}]}
