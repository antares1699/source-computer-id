{"title":"Ubah urutan pencarian DNS di Mac El Capitan","draft":false,"url":"/ubah-urutan-pencarian-dns-di-mac-el-capitan-nv2qg7jl","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["networking","macos","dns","osx-el-capitan","private-network"],"snippet":"Saya punya router yang juga menjalankan DNS yang berisi nama untuk mesin di jaringan lokal saya. Ini diatur untuk meneruskan permintaan, jadi untuk semua mesin publik itu akan menjangkau DNS yang disediakan...","body":"<p> Saya punya router yang juga menjalankan DNS yang berisi nama untuk mesin di jaringan lokal saya. Ini diatur untuk meneruskan permintaan, jadi untuk semua mesin publik itu akan menjangkau DNS yang disediakan oleh ISP saya. Router dikonfigurasi sedemikian rupa sehingga merupakan DNS primer, dan DNS ISP terdaftar sebagai DNS sekunder. Saya memiliki beberapa mesin (yang memiliki entri di DNS pribadi saya) yang memiliki IP statis. Mesin lain, termasuk Mac yang menjadi subjek pertanyaan ini, mendapatkan alamatnya melalui DHCP. </p>\n\n<p> Mesin Windows di jaringan ini bekerja dengan sempurna. Mereka menyelesaikan nama pribadi ke mesin di jaringan saya dan juga memiliki akses ke internet publik. </p>\n\n<p> Laptop Mac tunggal saya tidak berfungsi. Itu mengakses internet publik tanpa masalah, tetapi tidak mengenai DNS internal saya untuk mendapatkan nama internal. Misalnya, jika saya melakukan ping ke mesin internal sebagai </p> <pre><code>ping internal.example.com\n</code></pre> <p> Saya mendapatkan paket kembali, tetapi ini menunjukkan alamat IP yang sesuai dengan Hover. (Rupanya Hover memasang laman landas untuk sub-domain mana pun yang tidak ada rute publiknya.) Jika saya melakukannya </p> <pre><code>nslookup internal.example.com\n</code></pre> <p> namun, saya mendapatkan IP (internal) yang benar untuk mesin di jaringan lokal saya. </p>\n\n<p> Terakhir, jika saya melakukan ping lagi tetapi kali ini memaksanya menggunakan DNS internal saya (192.168.1.2), </p> <pre><code>ping internal.example.com 192.168.1.2\n</code></pre> <p> Saya mendapat tanggapan dari <em> mesin yang benar di jaringan lokal saya </em> . Hal ini tampaknya menunjukkan bahwa pendekatan &quot;asli&quot; pun dapat melakukan apa yang saya inginkan, jika itu hanya akan menggunakan DNS yang benar. </p>\n\n<p> Saya telah menemukan banyak artikel yang membahas tentang masalah ini, tetapi apa yang sebenarnya saya temukan sejauh ini sudah ketinggalan zaman atau bukan solusi lengkap untuk masalah saya. Apa yang telah saya buat sejauh ini: </p>\n\n<ul>\n<li> Apple telah mengubah metodologi untuk resolusi DNS selama beberapa peningkatan OS, jadi jawaban online dengan cepat menjadi usang. </li>\n<li> Mac memiliki (setidaknya) dua skema resolusi DNS yang berjalan secara bersamaan pada El Capitan. Ini terkait dengan mendapatkan hasil yang berbeda dari ping dan dari nslookup, seperti disebutkan di atas. Utilitas baris perintah yang bekerja pada sistem linux &quot;biasa&quot; tampaknya setidaknya mendokumentasikan ini di halaman manual mereka, biasanya di bawah bagian berjudul sesuatu seperti &quot;Pemberitahuan Mac OS X&quot;. Sayangnya, tidak jelas persis utilitas mana yang digunakan tanpa memeriksanya satu per satu. (Sejauh ini, nslookup dan dig menggunakan metodologi linux dan ping menggunakan apa pun yang &quot;asli&quot; untuk Mac OS.) </li>\n<li> Ini adalah (kurang lebih) fitur terdokumentasi dari metode DNS &quot;asli&quot; yang secara dinamis memilih DNS mana yang akan digunakan. Artinya, secara khusus, urutan yang muncul di jendela seperti panel kontrol Jaringan atau urutan yang ditentukan oleh router (dalam kasus saya), tidak dipatuhi. </li>\n<li> Saya mendapat beberapa informasi dari alat DNS &quot;asli&quot; dengan perintah <code>sudo killall -INFO mDNSResponder</code> pada baris perintah. Itu membuang pesan ke <code>/var/log/system.log</code>. Dari pesan log itu, tampak bahwa DNS ISP saya terdaftar pertama kali dalam sistem itu. (Sekali lagi, saya perhatikan, bahwa itu terdaftar <em> kedua </em> di konfigurasi router dan di panel kontrol Jaringan. Itu juga terdaftar kedua jika saya menjalankan <code>scutil</code>.) </li>\n<li> Saya mencoba membersihkan cache pada mDNSResponder menggunakan <code>sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder;</code> tetapi itu tidak membantu. </li>\n<li> Saya mencoba mengedit file <code>com.apple.mDNSResponder.plist</code> seperti dalam instruksi ini ( <a href=\"https://www.cnet.com/news/os-x-10-6-3-and-dns-server-priority-changes/\" rel=\"nofollow noopener\" target=\"_blank\"> https://www.cnet.com/news/os-x-10-6-3-and-dns-server-priority-changes/ </a> ), tetapi saya tidak dapat mengedit file tersebut. (Hanya baca, bahkan dengan <code>sudo vi</code>.) Selain itu, file di sistem saya memiliki konten yang berbeda dari yang secara eksplisit dirujuk dalam petunjuk tersebut. </li>\n</ul>\n\n<p> Terlepas dari semua ini, bagaimanapun, saya masih memiliki Mac yang tidak berfungsi di jaringan yang penuh dengan komputer lain yang berfungsi dengan baik. Saya mungkin bisa mengambil DNS ISP di router sehingga itu bahkan tidak ditawarkan, tapi itu terasa seperti retasan. Apakah ada perbaikan yang bagus untuk ini di El Capitan? </p>\n\n<p> Maaf jika ini sudah dijawab. (Saya merasa itu pasti ada di suatu tempat!) Saya sering menggali dan mematikan hampir sepanjang hari dan sejauh ini belum menemukan solusi untuk El Capitan. </p>","source":"https://superuser.com/questions/1177175/change-dns-search-order-on-mac-el-capitan","author":"<a href=\"https://superuser.com/users/595426/brick\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Brick</span></a>","replies":[],"answers":[{"answer":"<p> macOS memiliki sistem canggih untuk perutean permintaan DNS (&quot;kueri cakupan&quot;) untuk menangani kasus seperti VPN, di mana Anda mungkin ingin permintaan nama domain pekerjaan Anda menyusuri terowongan VPN Anda sehingga Anda mendapatkan jawaban dari server DNS internal pekerjaan Anda , yang mungkin memiliki lebih banyak / informasi berbeda dari server DNS eksternal pekerjaan Anda. </p>\n\n<p> Untuk melihat semua server DNS yang digunakan macOS, dan bagaimana cakupan kueri diatur, gunakan: </p> <pre><code>scutil --dns\n</code></pre> <p> Untuk menanyakan DNS seperti yang dilakukan macOS, gunakan: </p> <pre><code>dns-sd -G v4v6 example.com\n</code></pre> <p> …atau… </p> <pre><code>dns-sd -q example.com 255 255\n</code></pre> <p> Lihat halaman manual <code>scutil(8)</code> dan <code>dns-sd(1)</code> untuk informasi lebih lanjut. </p>\n\n<p> Alat pemecahan masalah DNS seperti <code>nslookup(1)</code>, <code>dig(1)</code>, dan <code>host(1)</code> berisi kode resolver DNS mereka sendiri dan tidak menggunakan API kueri DNS sistem, sehingga mereka tidak mendapatkan perilaku sistem. Jika Anda tidak menentukan server DNS mana yang akan mereka gunakan, mereka mungkin hanya akan menggunakan salah satu yang terdaftar di <code>/etc/resolv.conf</code>, yang dibuat secara otomatis dan hanya berisi server DNS default untuk kueri tanpa cakupan. </p>\n\n<p> Alat baris perintah Unix tradisional yang tidak khusus untuk DNS, seperti <code>ping(8)</code>, mungkin memanggil API <code>gethostbyname(3)</code> tradisional, yang, di macOS, menggunakan perilaku resolver DNS sistem. </p>\n\n<p> Untuk melihat apa yang server DHCP Anda katakan untuk digunakan Mac Anda, lihat baris <code>domain_name_server</code> di output dari: </p> <pre><code>ipconfig getpacket en0\n</code></pre> <p> (ganti en0 dengan nama antarmuka gaya BSD yang benar seperti yang Anda lihat di <code>ifconfig</code>) </p>\n\n<p> Harap diperhatikan, saya cukup yakin DNS RFC tidak memerlukan implementasi DNS untuk mempertimbangkan daftar server yang akan diberi peringkat berdasarkan preferensi. Meskipun penerapan DNS umum untuk memperlakukannya seperti itu, mungkin tidak bijaksana untuk mengandalkan semua penerapan untuk menerapkan hal-hal seperti itu jika tidak ditentukan dalam standar yang relevan. </p>\n\n<p> Oh, perhatikan juga bahwa Mac Anda mungkin juga mendapatkan daftar server DNS dari iklan router IPv6 atau DHCP6, jika itu aktif di jaringan Anda. Dan tentu saja pengaturan VPN, profil konfigurasi yang diinstal, Open Directory, Active Directory, dll., Jika salah satu dari hal-hal itu digunakan di lingkungan Anda. </p>","votes":"11","source":"https://superuser.com/a/1177211","author":"<a href=\"https://superuser.com/users/30792/spiff\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Spiff</span></a>","replies":[{"reply":"Ketika saya melakukan <code>ifconfig getpacket en0</code>, saya diberitahu <code>ifconfig: interface getpacket does not exist</code>. (Saya telah memeriksa dan <code>en0</code> adalah nama antarmuka yang benar.) Halaman manual untuk <code>ifconfig</code> juga tidak mencantumkan ini sebagai opsi. (Saya menggenggamnya, dan sepertinya tidak ada dalam dokumen sama sekali.)","author":"<a href=\"https://superuser.com/users/595426/brick\" target=\"_blank\" rel=\"nofollow noopener\">Brick</a>"},{"reply":"@Brick 16705, bukan 167725 (16553 bukan 161612).","author":"<a href=\"https://superuser.com/users/30792/spiff\" target=\"_blank\" rel=\"nofollow noopener\">Spiff</a>"},{"reply":"Dengan ejaan yang benar (kesalahan saya!), Saya mendapatkan info dari perintah itu, tetapi ini memberi tahu saya apa yang saya dapatkan dari melihat panel kontrol Jaringan. DNS lokal saya terdaftar pertama kali diikuti oleh ISP. Saya menghargai masukan Anda, tetapi sejauh ini saya masih di tempat saya memulai. Sedikit informasi baru dari jawaban Anda adalah bahwa standar mungkin tidak memerlukan ketertiban untuk dihormati, jadi saya akan memeriksanya. Itu bukanlah pemahaman saya, tetapi saya sama sekali tidak mengklaim sebagai seorang ahli. Saya sedang mencari cara untuk melewati metode &quot;canggih&quot;. Jika gagal, saya jelas harus mengulang DNS untuk semua orang.","author":"<a href=\"https://superuser.com/users/595426/brick\" target=\"_blank\" rel=\"nofollow noopener\">Brick</a>"},{"reply":"Tanpa alasan yang jelas, itu beralih ke DNS pilihan saya hanya untuk beberapa gerakan, lalu kembali. Sangat membuat frustasi ...","author":"<a href=\"https://superuser.com/users/595426/brick\" target=\"_blank\" rel=\"nofollow noopener\">Brick</a>"},{"reply":"Saya memberi jawaban ini +1, tetapi saya membiarkan pertanyaan itu terbuka untuk saat ini. Saya segera memecahkan masalah saya dengan menghapus DNS ISP sebagai opsi sekunder untuk klien DHCP. (Ini masih digunakan oleh router saya untuk permintaan yang diteruskan.) Selain itu, sebagai ukuran yang baik, saya mengubah pengaturan saya di Hover sehingga tidak menyediakan halaman arahan. Saya pikir itu mungkin telah memaksa penggunaan DNS internal saya karena Mac tidak akan mendapat balasan dari server publik seandainya saya melakukannya terlebih dahulu. Masih ingin tahu cara mengubah pengaturan ini di Mac - jika memungkinkan.","author":"<a href=\"https://superuser.com/users/595426/brick\" target=\"_blank\" rel=\"nofollow noopener\">Brick</a>"},{"reply":"Setelah beberapa penelitian tambahan, saya sampai pada kesimpulan bahwa bahkan sistem Windows yang saya miliki tidak berfungsi karena alasan yang saya pikirkan. Bagian penting dari jawaban ini bagi saya adalah bagian yang menunjukkan bahwa standar tidak memerlukan urutan pencarian tertentu. Terima kasih!","author":"<a href=\"https://superuser.com/users/595426/brick\" target=\"_blank\" rel=\"nofollow noopener\">Brick</a>"},{"reply":"@Brick Ngomong-ngomong, dari membaca open source Apple hingga mDNSResponder dari El Capitan, jika saya memahaminya dengan benar, sepertinya macOS <i> tidak </i> mencoba untuk menghormati pesanan yang terdaftar, tetapi jika tidak mendapatkan jawaban tepat waktu dari server pertama dalam daftar, itu mungkin menempatkan server itu di kotak penalti dan pindah ke server berikutnya untuk sementara waktu.","author":"<a href=\"https://superuser.com/users/30792/spiff\" target=\"_blank\" rel=\"nofollow noopener\">Spiff</a>"}]}]}
