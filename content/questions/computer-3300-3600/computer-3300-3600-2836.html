{"title":"cp ke dalam hierarki tujuan dengan tautan simbolis?","draft":false,"url":"/cp-ke-dalam-hierarki-tujuan-dengan-tautan-simbolis-yhmsz1hj","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["shell-script","symbolic-link","cp"],"snippet":"Saya mencoba menulis skrip penerapan situs yang akan menyalin file seperti ini:  SUMBER  ...src/html/  DEST  ...src/html/ -&gt; /var/www/ftproot/mysite  Saya ingin file di SOURCE html masuk ke...","body":"<p> Saya mencoba menulis skrip penerapan situs yang akan menyalin file seperti ini: </p>\n\n<p><strong> SUMBER </strong></p> <pre><code>.\n..\nsrc/\nhtml/\n</code></pre> <p><strong> DEST </strong></p> <pre><code>.\n..\nsrc/\nhtml/ -&gt; /var/www/ftproot/mysite\n</code></pre> <p> Saya ingin file di SOURCE <code>html</code> masuk ke DEST <code>/var/www/ftproot/mysite</code>. </p>\n\n<p> Naskahnya adalah: </p> <pre><code>cd SOURCE\ncp -Rf * DEST\n</code></pre> <p> Setiap kali saya menjalankan skrip, saya mendapatkan kesalahan ini: </p> <pre><code>cp: cannot overwrite non-directory 'html' with directory `html'\n</code></pre> <p> Dari sini, saya menyimpulkan bahwa <code>cp</code> tidak dapat secara otomatis menyalin file ke DEST ketika DEST memiliki tautan simbolis. </p>\n\n<p> Catatan: </p>\n\n<ol>\n<li><p> Berikut <a href=\"http://www.gnu.org/software/coreutils/manual/html_node/cp-invocation.html\" rel=\"nofollow noopener\" target=\"_blank\"> manual cp </a> , Saya menyetel <code>POSIXLY_CORRECT</code> ke 1. Ini tidak berhasil. </p></li>\n<li><p> Saya harus menautkan situs <code>html</code> ke <code>ftproot/mysite</code> dan bukan sebaliknya karena pengguna ftp memiliki mode akses yang aneh. </p></li>\n<li><p> Orang ini <a href=\"http://verylongnamehere.blogspot.com/2011/10/just-do-it.html\" rel=\"nofollow noopener\" target=\"_blank\"> diubah </a> <code>cp</code> kode sumber dan dikompilasi ulang. Saya tidak ingin melakukan itu ke server produksi. </p></li>\n</ol>\n\n<p> Ada ide tentang cara mengatasi ini? </p>","source":"https://superuser.com/questions/534790/cp-into-destination-hierarchy-with-symbolic-link","author":"<a href=\"https://superuser.com/users/15252/est\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">est</span></a>","replies":[{"reply":"@Dennis Terima kasih, jawabannya adalah: 1. ya (mulai dengan <code>l</code> ketika <code>ls -l</code>) 2. Server Ubuntu 10.04 3. Tidak aman untuk berasumsi bahwa","author":"<a href=\"https://superuser.com/users/15252/est\" target=\"_blank\" rel=\"nofollow noopener\">est</a>"},{"reply":"@Dennis ya kamu benar. Saya mengedit posting saya.","author":"<a href=\"https://superuser.com/users/15252/est\" target=\"_blank\" rel=\"nofollow noopener\">est</a>"}],"answers":[{"answer":"<p> untuk penyalinan file apa pun, saya sarankan <code>rsync</code> lebih dari <code>cp</code> karena memiliki kontrol yang lebih baik apa yang harus disalin dan bagaimana. Dalam kasus Anda, berikan saja perintah: </p> <pre><code>cd SOURCE\nrsync -K -a . DEST\n</code></pre> <p> Opsi -K melakukan apa yang Anda inginkan:\n-K, --keep-dirlinks memperlakukan dir yang terhubung ke symlink pada receiver sebagai dir </p>","votes":"5","source":"https://superuser.com/a/534818","author":"<a href=\"https://superuser.com/users/184669/sparkie\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">sparkie</span></a>","replies":[{"reply":"Terima kasih untuk ini. Persis yang saya cari setelah <code>cp -aPv --remove-destination</code> mulai gagal ketika kami mengubah direktori menjadi symlink di tujuan.","author":"<a href=\"https://superuser.com/users/2173/artem-russakovskii\" target=\"_blank\" rel=\"nofollow noopener\">Artem Russakovskii</a>"}]},{"answer":"<p> Karena cp tidak akan menyalin direktori apa pun di SOURCE melalui symlink apa pun di DEST, salah satu opsinya adalah menyalin direktori tersebut secara terpisah untuk setiap symlink. </p>\n\n<h3 class=\"h5\"> Pendekatan menggunakan <a href=\"http://unixhelp.ed.ac.uk/CGI/man-cgi?find\" rel=\"nofollow noopener\" target=\"_blank\"> Temukan </a></h3> <pre><code>cd DEST\ncp -Rf SOURCE/* .\nfind -type l -exec bash -c 'cp -Rf \"SOURCE/$0\"/* \"$0\"' {} \\;\n</code></pre> <h3 class=\"h5\"> Detail </h3>\n\n<ul>\n<li> <code>-type l</code> membatasi pencarian ke symlink. </li>\n<li> <code>-exec bash -c '...' {} \\;</code> mengeksekusi <code>...</code> dalam subkulit bash untuk setiap symlink yang ditemukan, meneruskan <code>{}</code> (jalur relatif ke symlink) sebagai argumen fitst (<code>$0</code>). </li>\n<li> <code>cp -Rf \"SOURCE/$0\"/* \"$0\"</code> menyalin isi dari direktori sumber yang sesuai ke direktori yang ditunjuk oleh symlink. </li>\n<li> Perintah cp harus dipanggil menggunakan bash, sehingga glob (asterisk) akan diperluas. </li>\n</ul>\n\n<h3 class=\"h5\"> Perhatian </h3>\n\n<ul>\n<li> Saya sarankan mengganti <code>cp</code> dengan <code>echo</code> (atau <code>-Rf</code> dengan <code>-Ri</code>) untuk memastikan find melakukan apa yang Anda harapkan. </li>\n<li> Tanpa mengetahui struktur direktori yang tepat dan symlink yang ada di DEST, saya tidak dapat menjamin bahwa saya mengantisipasi semua kemungkinan keanehan. </li>\n</ul>","votes":"2","source":"https://superuser.com/a/534804","author":"<a href=\"https://superuser.com/users/101836/dennis\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Dennis</span></a>","replies":[]}]}
