{"title":"Respon HTTP menggulung dan mendapatkan hasil yang berbeda","draft":false,"url":"/respon-http-menggulung-dan-mendapatkan-hasil-yang-berbeda-2kgre2dv","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["php","http","wget","curl"],"snippet":"Untuk memeriksa header respons HTTP untuk satu set url yang saya kirim dengan curl header permintaan berikut  foreach ( $urls as $url ){    // Setup headers - I used the same...","body":"<p> Untuk memeriksa header respons HTTP untuk satu set url yang saya kirim dengan curl header permintaan berikut </p> <pre><code>foreach ( $urls as $url )\n{\n    // Setup headers - I used the same headers from Firefox version 2.0.0.6\n    $header[ ] = \"Accept: text/xml,application/xml,application/xhtml+xml,\";\n    $header[ ] = \"text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\";\n    $header[ ] = \"Cache-Control: max-age=0\";\n    $header[ ] = \"Connection: keep-alive\";\n    $header[ ] = \"Keep-Alive: 300\";\n    $header[ ] = \"Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\";\n    $header[ ] = \"Accept-Language: en-us,en;q=0.5\";\n    $header[ ] = \"Pragma: \"; // browsers keep this blank.\n\n    curl_setopt( $ch, CURLOPT_URL, $url );\n    curl_setopt( $ch, CURLOPT_USERAGENT, 'Googlebot/2.1 (+http://www.google.com/bot.html)');\n    curl_setopt( $ch, CURLOPT_HTTPHEADER, $header);\n    curl_setopt( $ch, CURLOPT_REFERER, 'http://www.google.com');\n    curl_setopt( $ch, CURLOPT_HEADER, true );\n    curl_setopt( $ch, CURLOPT_NOBODY, true );\n    curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );\n    curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, true );\n    curl_setopt( $ch, CURLOPT_HTTPAUTH, CURLAUTH_ANY );\n    curl_setopt( $ch, CURLOPT_TIMEOUT, 10 ); //timeout 10 seconds\n}\n</code></pre> <p> Kadang-kadang saya menerima 200 OK yang bagus di waktu lain 301, 302, 307 yang saya anggap bagus juga, tetapi di lain waktu saya menerima status aneh sebagai 406, 500, 504 yang seharusnya mengidentifikasi url yang tidak valid tetapi ketika saya membukanya di browser mereka baik-baik saja </p>\n\n<p> misalnya skrip kembali </p> <pre><code>http://www.awe.co.uk/ =&gt; HTTP/1.1 406 Not Acceptable\n</code></pre> <p> dan wget kembali </p> <pre><code>wget http://www.awe.co.uk/\n--2011-06-23 15:26:26--  http://www.awe.co.uk/\nResolving www.awe.co.uk... 77.73.123.140\nConnecting to www.awe.co.uk|77.73.123.140|:80... connected.\nHTTP request sent, awaiting response... 200 OK\n</code></pre> <p> Apakah ada yang tahu header permintaan mana yang saya lewatkan atau tambahkan secara berlebihan? </p>","source":"https://superuser.com/questions/301126/http-responses-curl-and-wget-different-results","author":"<a href=\"https://superuser.com/users/87209/fab\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Fab</span></a>","replies":[],"answers":[{"answer":"<p> Anda menyertakan header HTTP yang tidak valid dalam permintaan Anda: </p> <pre><code>$header[ ] = \"Accept: text/xml,application/xml,application/xhtml+xml,\";\n$header[ ] = \"text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\";\n</code></pre> <p> Pada baris pertama, daftar diakhiri dengan <code>,</code> - yaitu, tipe konten kosong - yang merupakan penyebab 406 <em> Tidak dapat diterima </em> kesalahan. Baris kedua bahkan bukan header HTTP. </p>\n\n<p> Jika Anda melihat percakapan HTTP Firefox dengan packet sniffer, Anda mungkin melihat sesuatu seperti ini: </p> <pre><code>Accept: text/xml,application/xml,application/xhtml+xml,\n    text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\n</code></pre> <p> Karena baris kedua dimulai dengan spasi, baris kedua diperlakukan sebagai header tunggal oleh server. Mereka juga harus diteruskan sebagai satu tajuk ke curl: </p> <pre><code>$header[] = \"Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\";\n</code></pre> <hr>\n\n<p> Kamu bisa gunakan <a href=\"http://echo.opera.com\" rel=\"nofollow noopener\" target=\"_blank\"> http://echo.opera.com </a> untuk membandingkan permintaan yang dikirim. </p>","votes":"6","source":"https://superuser.com/a/301231","author":"<a href=\"https://superuser.com/users/1686/user1686\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">user1686</span></a>","replies":[]},{"answer":"<p> Anda tidak memberikan tajuk <code>Host:</code> dalam larik <code>header[]</code> Anda. Dalam permintaan HTTP 1.1 ke server konten, header <code>Host:</code> bersifat wajib. Respons non-4xx adalah saat Anda kebetulan mengenai server HTTP konten seseorang yang memaafkan ketika datang ke kesalahan protokol ini. </p>","votes":"1","source":"https://superuser.com/a/301196","author":"<a href=\"https://superuser.com/users/38062/jdebp\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">JdeBP</span></a>","replies":[{"reply":"Karena tajuk itu wajib, <i> keriting </i> menyertakannya secara otomatis (dan jika tidak, responsnya akan 400 <i> Permintaan yang buruk </i> ).","author":"<a href=\"https://superuser.com/users/1686/user1686\" target=\"_blank\" rel=\"nofollow noopener\">user1686</a>"},{"reply":"Tidak benar dalam prakteknya. Itu saja <i> terkadang </i> menciptakan satu jika seseorang belum menyediakannya, tergantung dari apa yang diteruskan ke opsi lain dan ke <code>curl_init()</code>, yang belum diberitahukan kepada kami. Dan, seperti seharusnya jelas dari data dalam pertanyaan bahkan jika seseorang tidak pernah menemukannya dalam praktiknya, tidak semua orang mendapatkan respons kesalahan untuk protokol yang salah.","author":"<a href=\"https://superuser.com/users/38062/jdebp\" target=\"_blank\" rel=\"nofollow noopener\">JdeBP</a>"}]},{"answer":"<p> Menurut pendapat saya, skrip Anda terlihat baik-baik saja, dan karena terkadang Anda mendapatkan hasil yang benar, seharusnya itu berfungsi. </p>\n\n<p> Apakah Anda pemilik <code>http://www.awe.co.uk/</code>? <br> Mungkin ada skrip yang berjalan yang memutuskan apa yang harus dilakukan tergantung pada beberapa env. Misalnya dalam skrip Anda mengakses situs ini sebagai agen-pengguna &quot;googlebot&quot; sedangkan agen-pengguna wget Anda akan menjadi &quot;wget&quot;. Skrip di server web mungkin memeriksa apakah itu Google dan memberikan beberapa konten yang sama sekali berbeda dari yang mungkin dilihat browser Anda. Dengan cara yang sama server web dapat mengirimkan kode pengembalian yang berbeda. <br> Untuk menguji masalah ini, Anda mungkin ingin mengurangi skrip Anda, atau memperluas perintah <code>wget</code> untuk mengirim permintaan yang sama dan membandingkan hasilnya. </p>\n\n<p> Hal lain yang dapat saya bayangkan: Seberapa sering Anda menjalankan skrip Anda? Mungkin server web memperhatikan lalu lintas besar dari skrip Anda dan mengirim 406 (atau beberapa hal lainnya) jika Anda melebih-lebihkan ;-) </p>","votes":"0","source":"https://superuser.com/a/301160","author":"<a href=\"https://superuser.com/users/78107/binfalse\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">binfalse</span></a>","replies":[]}]}
