{"title":"Bagaimana Anda menentukan perangkat root jika / dev / root hilang?","draft":false,"url":"/bagaimana-anda-menentukan-perangkat-root-jika-dev-root-hilang-ddleeakq","votes":"4","answers_count":"6","categories":["Komputer"],"tags":["filesystems","mount"],"snippet":"Pada distribusi yang saya gunakan sekarang, Arch Linux ARM, Linux diluncurkan tanpa disk RAM awal, artinya kernel melakukan semua pekerjaan dalam memasang sistem file root. Sistem ini diinstal pada kartu SD dan...","body":"<p> Pada distribusi yang saya gunakan sekarang, Arch Linux ARM, Linux diluncurkan tanpa disk RAM awal, artinya kernel melakukan semua pekerjaan dalam memasang sistem file root. Sistem ini diinstal pada kartu SD dan memiliki skrip di atasnya yang perlu menentukan node perangkat dari sistem file tempat ia berada. Node perangkat ini dapat berubah tergantung pada cara saya mem-boot perangkat (mis., Saya memasangnya ke perangkat lain yang sudah berjalan). </p>\n\n<p> Saya dapat menentukan titik pemasangan menggunakan <code>df -k --output=target ${0} | sed \"1d\"</code>. Untuk menentukan perangkat sumber, saya menjalankan <code>df -k --output=source ${0} | sed \"1d\"</code>. Jika saya telah boot ke Arch Linux, hasil dari perintah terakhir itu mengeluarkan <code>/dev/root</code>, <strong> yang tidak ada </strong> . Tentu, pada beberapa sistem, udev akan membuat tautan simbolis dari <code>/dev/root</code> ke perangkat root asli, tetapi milik saya tidak melakukan itu. saya <em> bisa </em> lihatlah isi <code>/proc/cmdline</code> tetapi itu tetap sama sepanjang waktu operasi kernel, jadi itu berarti itu tidak dapat diandalkan. </p>\n\n<p> Ketika saya mendapatkan <code>/dev/root</code>, bagaimana saya bisa menentukan perangkat blok dasar yang sebenarnya? </p>","source":"https://superuser.com/questions/1213770/how-do-you-determine-the-root-device-if-dev-root-is-missing","author":"<a href=\"https://superuser.com/users/136966/melab\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Melab</span></a>","replies":[{"reply":"(1) Jelas saya tidak mengerti banyak tentang ini. AFAIK, titik mount untuk sistem berkas root adalah selalu<code>&#47;</code> - mengapa Anda perlu memiliki perintah untuk &quot;menentukan titik pemasangan&quot; untuk sistem berkas root? (2) Apakah <code>${0}</code> di sini? Mengapa Anda mengatakan <code>${0}</code> bukannya <code>$0</code>, atau, lebih baik lagi, <code>&quot;$0&quot;</code>? (3) Pertanyaan Anda adalah tentang nama file / nama jalur. Apakah itu berubah jika Anda menjalankan <code>df</code> tanpa <code>-k</code>? Jika ya, jelaskan caranya. Jika tidak, pertimbangkan untuk tidak menggunakan <code>-k</code>, karena akan berantakan. (4) Jika Anda mengatakan <code>df &#47;</code>, apa yang Anda dapatkan? Dalam hal apa hal itu tidak menjawab pertanyaan Anda? … (Lanjutan)","author":"<a href=\"https://superuser.com/users/150988/scott\" target=\"_blank\" rel=\"nofollow noopener\">Scott</a>"},{"reply":"(Lanjutan)… (5) Anda berkata, “konten <code>&#47;proc&#47;cmdline</code>… tetap sama selama waktu aktif kernel, jadi itu berarti tidak dapat diandalkan.” Hah? Bagaimana nilai yang stabil tidak dapat diandalkan? (6) Apakah keluaran <code>mount</code> (atau <code>cat &#47;proc&#47;mounts</code>) pernah menunjukkan informasi yang Anda inginkan? Jika tidak, perlambat, berhenti, kembali dan mulai lagi. Jika keluaran <code>mount</code> tidak pernah menampilkan informasi yang Anda inginkan, maka saya tidak tahu apa yang Anda inginkan, dan mungkin semua orang juga bingung,… (Lanjutan)","author":"<a href=\"https://superuser.com/users/150988/scott\" target=\"_blank\" rel=\"nofollow noopener\">Scott</a>"},{"reply":"(Lanjutan)… dan Anda sangat tidak mungkin mendapatkan jawaban yang memuaskan sampai Anda menjelaskan kebutuhan Anda dengan lebih jelas. OTOH, jika keluaran <code>mount</code> terkadang menunjukkan informasi yang Anda inginkan, beri kami contoh keluaran <code>mount</code> yang tidak menunjukkan informasi yang Anda inginkan, dan jelaskan ketika Anda mendapatkannya, bukan keluaran yang berguna. (7) Harap jangan menanggapi dalam komentar; <a href=\"https://superuser.com/posts/1213770/edit\" target=\"_blank\" rel=\"nofollow noopener\"> edit </a> pertanyaan Anda untuk membuatnya lebih jelas dan lebih lengkap.","author":"<a href=\"https://superuser.com/users/150988/scott\" target=\"_blank\" rel=\"nofollow noopener\">Scott</a>"}],"answers":[{"answer":"<p> Perintah <code>mount</code> akan menunjukkannya: </p> <pre><code>  mount | sed -n 's|^/dev/\\(.*\\) on / .*|\\1|p'\n</code></pre>","votes":"5","source":"https://superuser.com/a/1223950","author":"<a href=\"https://superuser.com/users/424063/mike-redrobe\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Mike Redrobe</span></a>","replies":[{"reply":"Nggak! Output <code>mount</code> tidak dapat diandalkan dan sulit untuk diproses dengan skrip.","author":"<a href=\"https://superuser.com/users/136966/melab\" target=\"_blank\" rel=\"nofollow noopener\">Melab</a>"},{"reply":"Di atas akan memberi Anda perangkat blok tempat sistem file root berada ...","author":"<a href=\"https://superuser.com/users/424063/mike-redrobe\" target=\"_blank\" rel=\"nofollow noopener\">Mike Redrobe</a>"}]},{"answer":"<p> Jawaban dari <a href=\"https://bootlin.com/blog/find-root-device/\" rel=\"nofollow noopener\" target=\"_blank\"> komentar di sini </a> sangat sederhana. Panggil saja: </p> <pre><code>findmnt -n -o SOURCE /\n</code></pre> <p> Asalkan <code>findmnt</code> hadir ... </p>","votes":"2","source":"https://superuser.com/a/1357861","author":"<a href=\"https://superuser.com/users/943722/klaus\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Klaus</span></a>","replies":[]},{"answer":"<p> Anda dapat menggunakan <code>stat /</code> dan memeriksa nomor mayor / minor perangkat atau dengan bantuan perintah <code>rdev</code> menafsirkan ini secara otomatis. </p>","votes":"1","source":"https://superuser.com/a/1213783","author":"<a href=\"https://superuser.com/users/86524/eckes\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">eckes</span></a>","replies":[{"reply":"Lihat di sini untuk berbagai kemungkinan solusi dengan masalah metode tersebut: <a href=\"http://free-electrons.com/blog/find-root-device/\" rel=\"nofollow noopener\" target=\"_blank\"> free-electrons.com/blog/find-root-device </a>","author":"<a href=\"https://superuser.com/users/86524/eckes\" target=\"_blank\" rel=\"nofollow noopener\">eckes</a>"},{"reply":"Terkait: <a href=\"https://unix.stackexchange.com/q/61086/23408\" target=\"_blank\" rel=\"nofollow noopener\"> Bagaimana menentukan apakah sistem file Linux milik sistem yang sedang berjalan atau tidak </a> .","author":"<a href=\"https://superuser.com/users/150988/scott\" target=\"_blank\" rel=\"nofollow noopener\">Scott</a>"}]},{"answer":"<p><em> Dengan asumsi ada file di <code>/etc/fstab</code> </em></p> <pre><code>sudo cat /etc/fstab | grep '\\s\\/\\s'\n</code></pre> <p> akan memberi Anda entri <code>fstab</code> ke perangkat blok yang dipasang pada <code>/</code>. </p>","votes":"1","source":"https://superuser.com/a/1213786","author":"<a href=\"https://superuser.com/users/537961/kris-molinari\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Kris Molinari</span></a>","replies":[{"reply":"Itu sama sekali tidak bisa diandalkan. Jika saya bertanya tentang <code>fstab</code>, maka ini mungkin jawaban yang bagus.","author":"<a href=\"https://superuser.com/users/136966/melab\" target=\"_blank\" rel=\"nofollow noopener\">Melab</a>"},{"reply":"Setuju, tidak ada sumber yang kurang dapat diandalkan untuk informasi yang dipasang dari / etc / fstab, saya tidak pernah menggunakannya di program saya karena tidak ada hubungannya dengan apa yang sebenarnya dipasang pada saat ini di sistem yang sedang berjalan.","author":"<a href=\"https://superuser.com/users/564808/lizardx\" target=\"_blank\" rel=\"nofollow noopener\">Lizardx</a>"}]},{"answer":"<p> saya menemukan <a href=\"https://www.systutorials.com/how-to-find-the-disk-where-root-is-on-in-bash-on-linux/\" rel=\"nofollow noopener\" target=\"_blank\"> posting blog ini </a> sangat membantu dalam menemukan perangkat root dan disk primer di Linux. </p>\n<p> Anda perlu menginstal utilitas <code>lsblk</code>, yang disediakan oleh <code>util-linux</code> di CentOS / RHEL. Misalnya, varian seperti itu akan memberi Anda nama disk dari perangkat root: </p> <pre><code># lsblk -oMOUNTPOINT,PKNAME -rn | awk '$1 ~ /^\\/$/ { print $2 }'\nsda3\n</code></pre> <p> <code>findmnt</code> dari paket yang sama akan memberi Anda nama perangkat root yang sebenarnya: </p> <pre><code># findmnt -oTARGET,SOURCE -rn /\n/ /dev/mapper/vg01-lv_root\n</code></pre> <p> Bendera <code>-P</code> untuk kedua utilitas akan memberi Anda informasi yang sama dalam format, cocok untuk <code>eval</code> di shell: </p> <pre><code>$ findmnt -oTARGET,SOURCE -Pn /\nTARGET=&quot;/&quot; SOURCE=&quot;/dev/mapper/vg01-lv_root&quot;\n\n$ lsblk -oMOUNTPOINT,PKNAME -Pn | grep 'MOUNTPOINT=&quot;/&quot;'\nMOUNTPOINT=&quot;/&quot; PKNAME=&quot;sda3&quot;\n</code></pre>","votes":"1","source":"https://superuser.com/a/1598620","author":"<a href=\"https://superuser.com/users/86399/timur-bakeyev\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Timur Bakeyev</span></a>","replies":[]},{"answer":"<p><strong> Log kernel </strong></p>\n\n<p> Lakukan: </p> <pre><code>dmesg\n</code></pre> <p> Pertama, ini mungkin secara eksplisit diberikan pada CLI kernel di awal boot: </p> <pre><code>Command line: root=/dev/vda ...\n</code></pre> <p> Jika tidak, di akhir boot, jika rootfs adalah disk dan bukan initrd / initramfs, kernel akan mengatakan: </p> <pre><code>VFS: Mounted root (ext2 filesystem) on device 254:0.\n</code></pre> <p> jadi kami kemudian menemukan bahwa: </p> <pre><code>find /proc /sys -iname '*254:0*'\n</code></pre> <p> dan kemudian tentukan apa yang sebenarnya dipetakan dengan: </p> <pre><code>ls -l /sys/dev/block/254:0\n</code></pre> <p> keluaran: </p> <pre><code>lrwxrwxrwx    1 root     root             0 Jan 30 15:59 /sys/dev/block/254:0 -&gt; ../../devices/pci0000:00/0000:00:09.0/virtio4/block/vda\n</code></pre> <p> Diuji dengan ini <a href=\"https://github.com/cirosantilli/linux-kernel-module-cheat/tree/8217e5508782827320209644dcbaf9a6b3141724#qemu-buildroot-setup-getting-started\" rel=\"nofollow noopener\" target=\"_blank\"> Pengaturan QEMU + Buildroot </a> . </p>","votes":"0","source":"https://superuser.com/a/1400144","author":"<a href=\"https://superuser.com/users/128124/ciro-santilli-trump-ban-is-bad\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Ciro Santilli TRUMP BAN IS BAD</span></a>","replies":[]}]}
