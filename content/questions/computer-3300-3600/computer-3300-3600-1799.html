{"title":"Akankah Microsoft Windows 10 melakukan overcommit memory?","draft":false,"url":"/akankah-microsoft-windows-10-melakukan-overcommit-memory-w0thj800","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["windows","virtual-memory"],"snippet":"OS Linux: es biasanya akan memungkinkan overcommit memori. Misalnya suatu proses dapat mengalokasikan memori 100GB, meskipun mesin hanya memiliki memori fisik 8GB dan tidak ada swap.  Selama semua memori yang dialokasikan tidak...","body":"<p> OS Linux: es biasanya akan memungkinkan overcommit memori. Misalnya suatu proses dapat mengalokasikan memori 100GB, meskipun mesin hanya memiliki memori fisik 8GB dan tidak ada swap. </p>\n\n<p> Selama semua memori yang dialokasikan tidak benar-benar digunakan, prosesnya akan berfungsi. Jika program mencoba untuk menggunakan semuanya, OOM-killer akan menghentikan proses untuk membebaskan memori. </p>\n\n<p> Bagaimana cara kerjanya di Windows? Akankah Windows menolak untuk memberikan memori virtual proses kecuali dapat menjamin bahwa memori ini dapat didukung oleh memori aktual (RAM fisik atau swap)? </p>","source":"https://superuser.com/questions/1194263/will-microsoft-windows-10-overcommit-memory","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">avl_sweden</span></a>","replies":[{"reply":"Secara historis Windows tidak pernah mengizinkan overcommit dan sejauh yang saya tahu ini tidak berubah di Windows 10. Overcommit memiliki kelebihan tetapi juga beberapa masalah yang berpotensi serius. Ini dapat menyebabkan proses yang tidak melakukan kesalahan apa pun dan hanya membuat alokasi memori yang sederhana menjadi macet tanpa kemungkinan pemulihan. Desainer Windows mengambil keputusan yang lebih hati-hati untuk tidak pernah mengizinkan komitmen berlebihan.","author":"<a href=\"https://superuser.com/users/662153/lmiller7\" target=\"_blank\" rel=\"nofollow noopener\">LMiller7</a>"},{"reply":"Terima kasih! Tahukah Anda jika ini didokumentasikan di suatu tempat?","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\">avl_sweden</a>"},{"reply":"Publikasi Microsoft &quot;Windows Internals&quot; edisi ke-6, mencakup hingga Windows 7, menjelaskan tentang manajemen memori. Overcommit tidak didukung. Edisi ke-7, mencakup Windows 10, saya yakin belum dirilis. Tapi saya yakin perubahan sebesar komitmen berlebihan akan disebutkan di suatu tempat. Buku-buku ini bisa jadi sulit dibaca jika Anda tidak memiliki latar belakang.","author":"<a href=\"https://superuser.com/users/662153/lmiller7\" target=\"_blank\" rel=\"nofollow noopener\">LMiller7</a>"},{"reply":"Terima kasih lagi! Mungkin Anda bisa meletakkan ini sebagai jawaban sehingga saya bisa menerimanya?","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\">avl_sweden</a>"},{"reply":"@avl_sweden Anda dapat menulis jawabannya sendiri. Ini setidaknya akan memungkinkan penutupan pertanyaan duplikat.","author":"<a href=\"https://superuser.com/users/427799/dmitry-grigoryev\" target=\"_blank\" rel=\"nofollow noopener\">Dmitry Grigoryev</a>"}],"answers":[{"answer":"<p> Menjawab pertanyaan saya sendiri, yang tidak dimiliki orang lain. </p>\n\n<p> Tampaknya Windows TIDAK akan melakukan overcommit memori. Ini sebenarnya perbedaan besar dibandingkan dengan Linux. </p>\n\n<p> Windows akan mengizinkan program mengalokasikan lebih banyak memori (virtual) daripada RAM pada mesin, tetapi HANYA jika ada cukup ruang disk kosong untuk dapat mengembalikan memori virtual yang diminta oleh program oleh disk jika perlu. </p>","votes":"6","source":"https://superuser.com/a/1228040","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">avl_sweden</span></a>","replies":[{"reply":"Iya benar sekali. &quot;Batas komit&quot; Windows hanyalah ukuran RAM + ukuran file halaman saat ini. Windows tidak akan membiarkan aplikasi + OS melakukan lebih dari itu. Jika perluasan file halaman diaktifkan dan upaya komit akan membawa Anda di atas batas saat ini (tetapi kurang dari yang diizinkan oleh batas perluasan file halaman), file halaman secara otomatis diperluas untuk mengizinkan permintaan.","author":"<a href=\"https://superuser.com/users/348119/jamie-hanrahan\" target=\"_blank\" rel=\"nofollow noopener\">Jamie Hanrahan</a>"},{"reply":"Ini masih membutuhkan pembunuh OOM, karena milik saya macet beberapa kali beberapa minggu terakhir karena mungkin secara dinamis menetapkan semua ruang HDD gratis 10 GB saya ke Chrome.","author":"<a href=\"https://superuser.com/users/103551/cees-timmerman\" target=\"_blank\" rel=\"nofollow noopener\">Cees Timmerman</a>"},{"reply":"Windows terlalu memaksakan memori untuk tumpukan!","author":"<a href=\"https://superuser.com/users/629332/bonita-montero\" target=\"_blank\" rel=\"nofollow noopener\">Bonita Montero</a>"},{"reply":"Oh, itu menarik! Apakah Anda memiliki tautan atau referensi lain untuk informasi ini?","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\">avl_sweden</a>"}]},{"answer":"<p> Di sini, bukti bahwa Windows terlalu banyak melakukan tumpukan. </p>\n\n<p> Selesaikan ini dengan MSVC / 64 bit: </p> <pre><code>#include &lt;Windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;cstdint&gt;\n\nusing namespace std;\n\nDWORD WINAPI stackThread( LPVOID lpvThreadParam );\n\n#pragma warning(disable: 6387) // parameter ... could ne null\n\nint main()\n{\n    HANDLE hThread = CreateThread( nullptr, 0, stackThread, nullptr, 0, nullptr );\n    WaitForSingleObject( hThread, INFINITE );\n    CloseHandle( hThread );\n    return 0;\n}\n\nchar *__fastcall getSp();\nchar *__fastcall getTlsStackLimit();\n\nDWORD WINAPI stackThread( LPVOID lpvThreadParam )\n{\n    char          *stackTop,\n                  *stackBottom;\n    char          *curStack   = getSp();\n    char          *tlsSp      = getTlsStackLimit(),\n                  *efSp       = nullptr,\n                  *ehSp       = nullptr,\n                  *tlsSpAfter;\n    SYSTEM_INFO    si;\n    char volatile *p;\n    GetCurrentThreadStackLimits( &amp;(ULONG_PTR &amp;)stackBottom, &amp;(ULONG_PTR &amp;)stackTop );\n    GetSystemInfo( &amp;si );\n    for( p = stackBottom; ; )\n        __try\n        {\n            *p;\n            break;\n        }\n        __except( efSp = getSp(), EXCEPTION_EXECUTE_HANDLER )\n        {\n            p    += si.dwPageSize;\n            ehSp  = getSp();\n        }\n    tlsSpAfter = getTlsStackLimit();\n    (intptr_t &amp;)p     &amp;= -(intptr_t)si.dwPageSize;\n    (intptr_t &amp;)tlsSp &amp;= -(intptr_t)si.dwPageSize;\n    (intptr_t &amp;)efSp  &amp;= -(intptr_t)si.dwPageSize;\n    (intptr_t &amp;)ehSp  &amp;= -(intptr_t)si.dwPageSize;\n    cout &lt;&lt; \"(base for pages is one)\" &lt;&lt; endl;\n    cout &lt;&lt; \"guard page hit page:    \" &lt;&lt; (stackTop - p)          / si.dwPageSize &lt;&lt; endl;\n    cout &lt;&lt; \"start of tls page:      \" &lt;&lt; (stackTop - tlsSp)      / si.dwPageSize &lt;&lt; endl;\n    cout &lt;&lt; \"exception-filter page:  \" &lt;&lt; (stackTop - efSp)       / si.dwPageSize &lt;&lt; endl;\n    cout &lt;&lt; \"exception-handler page: \" &lt;&lt; (stackTop - ehSp)       / si.dwPageSize &lt;&lt; endl;\n    cout &lt;&lt; \"tls page after gp hit:  \" &lt;&lt; (stackTop - tlsSpAfter) / si.dwPageSize &lt;&lt; endl;\n    return 123;\n}\n</code></pre> <p> dan ini dengan MASM </p> <pre><code>PUBLIC ?getSp@@YAPEADXZ\nPUBLIC ?getTlsStackLimit@@YAPEADXZ\n\n_TEXT SEGMENT\n?getSp@@YAPEADXZ PROC\n    lea     rax, [rsp + 8]\n    ret\n?getSp@@YAPEADXZ ENDP\n_TEXT ENDS\n\n_TEXT   SEGMENT\n?getTlsStackLimit@@YAPEADXZ PROC\n    mov     rax, gs:[010h]\n    ret 0\n?getTlsStackLimit@@YAPEADXZ ENDP\n_TEXT   ENDS\n\nEND\n</code></pre> <p> Dan hubungkan bersama sebagai aplikasi 64 bit. Pertama, penunjuk tumpukan saat ini diambil. Kemudian, tumpukan bawah saat ini diambil dari thread-environment-block (GS: [010h]). Kemudian alamat tumpukan terendah dan alamat byte pertama setelah tumpukan diambil dan ukuran halaman ditentukan. Kemudian tumpukan disentuh dari bawah ke atas ke halaman pelindung. Halaman penjaga akan dipukul hampir ke stack-pointer dan stack-bottom yang ditentukan dari thread-envinronment-block. Setelah itu pointer ditentukan lagi untuk menguji apakah itu telah diperbarui oleh kernel ketika halaman pelindung telah dipukul. Kemudian indeks-halaman (berbasis-1) dari halaman-penjaga, dari tumpukan-bawah yang diberi tahu oleh thread-environment-block, dari fungsi filter SEH, penangan SEH dan alas tumpukan yang diceritakan oleh utas -environment-block setelah halaman pelindung telah mencapai ditampilkan. </p>","votes":"2","source":"https://superuser.com/a/1546584","author":"<a href=\"https://superuser.com/users/629332/bonita-montero\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Bonita Montero</span></a>","replies":[{"reply":"Untuk pembaca yang tidak ingin benar-benar mengompilasi dan menjalankan program, dapatkah Anda menjelaskan apa yang terjadi saat dijalankan, dan mengapa ini berarti windows terlalu banyak menggunakan memori untuk tumpukan? (Suara negatif bukan dari saya)","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\">avl_sweden</a>"},{"reply":"@avlhhh ??? Saya menggambarkannya di bawah kode sumber.","author":"<a href=\"https://superuser.com/users/629332/bonita-montero\" target=\"_blank\" rel=\"nofollow noopener\">Bonita Montero</a>"},{"reply":"Ah, saya membacanya sebagai deskripsi tentang apa yang dilakukan program tersebut, bukan apa yang terjadi. Apa yang terjadi jika windows tidak dapat memberikan lebih banyak memori ke program, setelah dugaan overcommit? Apakah program tersebut dihentikan? Yang ingin saya ketahui adalah keluaran dari program Anda.","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\">avl_sweden</a>"},{"reply":"@avl_sweden: Anda akan mendapatkan pengecualian halaman penjaga di utas yang tidak lagi dapat mengalokasikan ruang-tumpukan.","author":"<a href=\"https://superuser.com/users/629332/bonita-montero\" target=\"_blank\" rel=\"nofollow noopener\">Bonita Montero</a>"},{"reply":"Terima kasih, itulah informasi yang saya lewatkan. Jadi windows memungkinkan program untuk menetapkan batas tumpukan yang lebih besar dari jumlah memori virtual yang sebenarnya tersedia? Menarik!","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\">avl_sweden</a>"},{"reply":"@avl_sweden: Itu teori murni. Biasanya tidak ada yang akan menggunakan tumpukan sebesar itu.","author":"<a href=\"https://superuser.com/users/629332/bonita-montero\" target=\"_blank\" rel=\"nofollow noopener\">Bonita Montero</a>"}]},{"answer":"<p> Tidak yakin apakah ini relevan, tetapi aplikasi tertentu akan membatasi penggunaan memorinya, seperti Powershell, dan menampilkan kesalahan ini kecuali jika pengaturan alokasi memori diubah. Atau Anda menjalankan perintah melalui aplikasi terpisah, seperti Spyder. </p>","votes":"0","source":"https://superuser.com/a/1491142","author":"<a href=\"https://superuser.com/users/1085747/llewellyn-hinkes-jones\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Llewellyn Hinkes Jones</span></a>","replies":[{"reply":"Saya menulis program uji coba yang melakukan banyak alokasi VirtualAlloc di satu sisi - dengan ini penggunaan memori bertambah -, dan membuat banyak utas dengan reservasi default 1mb - dan System-commit tumbuh hanya sebesar tumpukan halaman awal utas.","author":"<a href=\"https://superuser.com/users/629332/bonita-montero\" target=\"_blank\" rel=\"nofollow noopener\">Bonita Montero</a>"},{"reply":"@BonitaMontero Ya, tetapi apakah Anda memperhatikan ukuran jendela &quot;file swap&quot; pada disk? Windows benar-benar menyimpan semua memori itu, bahkan jika itu tidak muncul sebagai berkomitmen, jika saya ingat dengan benar.","author":"<a href=\"https://superuser.com/users/201601/avl-sweden\" target=\"_blank\" rel=\"nofollow noopener\">avl_sweden</a>"},{"reply":"System-commit tidak tumbuh, dan dengan demikian swapfile tidak berkembang.","author":"<a href=\"https://superuser.com/users/629332/bonita-montero\" target=\"_blank\" rel=\"nofollow noopener\">Bonita Montero</a>"}]}]}
