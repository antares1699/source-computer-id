{"title":"Skrip Bash mengarahkan semua output ke file","draft":false,"url":"/skrip-bash-mengarahkan-semua-output-ke-file-s8lol8e2","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["linux","bash"],"snippet":"Saya memiliki skrip berikut yang berfungsi dengan baik di desktop CentOS 7, tetapi tidak berfungsi dengan benar di server CentOS 7 di digitalocean droplet.  Masalahnya adalah itu tidak keluar otomatis saat selesai,...","body":"<p> Saya memiliki skrip berikut yang berfungsi dengan baik di desktop CentOS 7, tetapi tidak berfungsi dengan benar di server CentOS 7 di digitalocean droplet. </p>\n\n<p> Masalahnya adalah itu tidak keluar otomatis saat selesai, saya harus menekan enter untuk keluar </p> <pre><code>#!/bin/bash\n\nLOG_FILE=/var/log/mylog.log\n\nif [ -f $LOG_FILE ]; then\n  mv $LOG_FILE $LOG_FILE.$(date +%s)\nfi\n\nexec &gt; &gt;(tee -a -i $LOG_FILE)\nexec 2&gt;&amp;1\n\necho \"track 1x\"\necho \"track 2x\"\n</code></pre>","source":"https://superuser.com/questions/1466840/bash-script-redirect-all-output-to-file","author":"<a href=\"https://superuser.com/users/1070680/bsidhu009\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">bsidhu009</span></a>","replies":[],"answers":[{"answer":"<p> Cara lain yang mungkin untuk menyusun kode ini dengan cara yang tidak akan memicu kondisi balapan adalah dengan mengelompokkan kode lainnya di dalam blok <code>{ ... }</code> dan menyalurkannya ke <code>tee</code>. </p>\n\n<p> Dengan begitu, bash dijamin ke <code>wait()</code> selama <code>tee</code> selesai sebelum mengakhiri skrip. </p> <pre><code>#!/bin/bash\n\nLOG_FILE=/var/log/mylog.log\n\nif [[ -f \"$LOG_FILE\" ]]; then\n  mv \"$LOG_FILE\" \"$LOG_FILE.$(date +%s)\"\nfi\n\n{\n  echo \"track 1x\"\n  echo \"track 2x\"\n} 2&gt;&amp;1 | tee -a -i \"$LOG_FILE\"\n</code></pre>","votes":"4","source":"https://superuser.com/a/1466971","author":"<a href=\"https://superuser.com/users/879179/filbranden\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">filbranden</span></a>","replies":[]},{"answer":"<p> Ini mungkin terlihat seperti Anda perlu menekan enter tetapi Anda tidak perlu. </p>\n\n<p> Masalahnya adalah prompt berikutnya terkadang muncul <strong> sebelum </strong> output dari substitusi proses dengan <code>tee</code> selesai. Apakah prompt baru muncul sebelum atau sesudah keluaran <code>tee</code> tergantung pada kesulitan multitasking. Ini mungkin muncul secara acak dengan satu atau lain cara. </p>\n\n<p> Misalnya, saya menjalankan skrip Anda dan hasilnya tampak seperti: </p> <pre><code>$ bash script\n$ track 1x\ntrack 2x\n</code></pre> <p> <code>$</code> kedua adalah prompt baru. Garis <code>track 1x</code> dan <code>track 2x</code> adalah keluaran dari <code>tee</code> yang muncul <strong> setelah </strong> promptnya tertulis. Anda dapat memasukkan perintah baru tanpa memasukkan enter terlebih dahulu. Saya melakukannya di sini misalnya: </p> <pre><code>$ bash script\n$ track 1x\ntrack 2x\ndate\nThu Aug  1 22:52:45 PDT 2019\n</code></pre> <p> Saya memasukkan perintah baru, <code>date</code>, dan perintah diproses menghasilkan keluaran <code>Thu Aug  1 22:52:45 PDT 2019</code>. Tidak perlu menekan enter sebelum mengetik perintah baru. </p>","votes":"3","source":"https://superuser.com/a/1466846","author":"<a href=\"https://superuser.com/users/277295/john1024\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">John1024</span></a>","replies":[{"reply":"Bagaimana saya bisa menghindari ini Saya memiliki file skrip yang panjang","author":"<a href=\"https://superuser.com/users/1070680/bsidhu009\" target=\"_blank\" rel=\"nofollow noopener\">bsidhu009</a>"},{"reply":"Jadi, terkadang keluarannya terlambat. Apakah itu terlihat jelek? Atau, adakah alasan mengapa hal ini penting untuk dihindari?","author":"<a href=\"https://superuser.com/users/277295/john1024\" target=\"_blank\" rel=\"nofollow noopener\">John1024</a>"},{"reply":"Ya saya hanya ingin menghindari ini","author":"<a href=\"https://superuser.com/users/1070680/bsidhu009\" target=\"_blank\" rel=\"nofollow noopener\">bsidhu009</a>"}]},{"answer":"<p> Saya menambahkan tidur baris baru .1 dan berhasil\n@sumber <a href=\"https://stackoverflow.com/questions/30687504/redirected-output-hangs-when-using-tee\" target=\"_blank\" rel=\"nofollow noopener\"> https://stackoverflow.com/questions/30687504/redirected-output-hangs-when-using-tee </a></p> <pre><code>#!/bin/bash\n\nLOG_FILE=/var/log/mylog.log\n\nif [ -f $LOG_FILE ]; then\n  mv $LOG_FILE $LOG_FILE.$(date +%s)\nfi\n\nexec &gt; &gt;(tee -a -i $LOG_FILE)\nexec 2&gt;&amp;1\nsleep .1\n\necho \"track 1x\"\necho \"track 2x\"\n</code></pre>","votes":"1","source":"https://superuser.com/a/1466850","author":"<a href=\"https://superuser.com/users/1070680/bsidhu009\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">bsidhu009</span></a>","replies":[]}]}
