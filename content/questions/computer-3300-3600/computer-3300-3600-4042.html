{"title":"Mengonfigurasi port SSH yang berbeda untuk setiap remote host yang dipantau oleh Nagios","draft":false,"url":"/mengonfigurasi-port-ssh-yang-berbeda-untuk-setiap-remote-host-yang-dipantau-oleh-nagios-hgmuhgmd","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["linux","monitoring","remote-connection","nagios"],"snippet":"Saya sudah menyelesaikan install Nagios dan setup di tiga server sehingga instance di server  SEBUAH  juga menyediakan laporan untuk server  B  &amp;  C  (melalui NRPE).  SSHD sengaja mendengarkan port yang berbeda di...","body":"<p> Saya sudah menyelesaikan install Nagios dan setup di tiga server sehingga instance di server <strong> SEBUAH </strong> juga menyediakan laporan untuk server <strong> B </strong> &amp; <strong> C </strong> (melalui NRPE). </p>\n\n<p> SSHD sengaja mendengarkan port yang berbeda di setiap host, jadi saya mengedit file /etc/nagios3/conf.d/services_nagios2.cfg di setiap host untuk menguji port yang sesuai. Instance HTTP asli Nagios di server <strong> B </strong> &amp; <strong> C </strong> konfirmasikan bahwa SSH berjalan tetapi laporkan di server <strong> SEBUAH </strong> menunjukkan kegagalan kritis untuk SSH di keduanya <strong> B </strong> &amp; <strong> C </strong> . </p>\n\n<p> Saya mendapat kesan bahwa layanan NRPE dirancang untuk menjalankan pemeriksaan lokal pada host jarak jauh, meneruskan sisanya ke host pemantauan yang kemudian akan menyusun data menjadi satu laporan untuk semua mesin. </p>\n\n<p> Melihat bagian Layanan di halaman web Konfigurasi (di server <strong> SEBUAH </strong> ), Nagios sedang menguji port SSH yang sama di ketiga server, bukan di port yang berbeda <strong> B </strong> &amp; <strong> C </strong> . Adakah yang bisa menjelaskan mengapa? </p>\n\n<p> Satu-satunya cara saya dapat memperbaikinya (hingga saat ini) adalah dengan membuat host group_name yang berbeda dan check_command untuk setiap host jarak jauh di file conf.d / services_nagios2.cfg di server <strong> SEBUAH </strong> . </p>\n\n<p><strong> Ini tidak mungkin satu-satunya cara? </strong></p>\n\n<p> Tentunya panjang file akan berlipat ganda setiap kali konfigurasi layanan yang berbeda diperlukan untuk server yang dipantau dari jarak jauh! </p>","source":"https://superuser.com/questions/451875/configuring-different-ssh-ports-for-each-host-remotley-monitored-by-nagios","author":"<a href=\"https://superuser.com/users/110085/danielcraigie\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">danielcraigie</span></a>","replies":[],"answers":[{"answer":"<p> Oke, saya telah menelusuri dokumentasi Nagios3 dan telah menjawab bagian konfigurasi port dari pertanyaan saya ... </p>\n\n<p> Jawabannya terletak pada model Warisan Objek yang ada di dalam file konfigurasi Nagios. Pada dasarnya saya membuat variabel khusus di setiap definisi host yang menentukan port ssh unik di mesin itu: </p> <pre><code>define host {\n    use              generic-host\n    host_name        serverB\n    address          10.0.1.3\n    _sshport         67382\n}\n</code></pre> <p> Host dikelompokkan bersama di dalam file hostgroups_nagios2.cfg: </p> <pre><code># A list of your ssh-accessible servers\ndefine hostgroup {\n    hostgroup_name  ssh-servers\n    alias           SSH servers\n    members         localhost,serverB,serverC\n}\n</code></pre> <p> Grup ini direferensikan di dalam services_nagios2.cfg oleh blok yang memeriksa SSH: </p> <pre><code># check that ssh services are running\ndefine service {\n    hostgroup_name                  ssh-servers\n    service_description             SSH\n    check_command                   check_ssh_port!$_HOSTSSHPORT\n    use                             generic-service\n    notification_interval           0 ; set &gt; 0 if you want to be renotified\n}\n</code></pre> <p> Pada akhir perintah check_ssh_port Anda dapat melihat bahwa saya menambahkan variabel sshport <code>$_HOSTSSHPORT</code> yang diwarisi dari setiap host di dalam ssh-server hostgroup saat pemeriksaan dijalankan. </p>\n\n<p> Sekarang, saat menambahkan server baru, saya hanya perlu memodifikasi file hosts_nagios2.cfg saya dengan detail host baru. </p>\n\n<p> Untuk mengaktifkan kompatibilitas mundur, saya juga memodifikasi file generik-host_nagios2.cfg saya menambahkan baris <code>_sshport 22</code> sehingga jika karena alasan tertentu saya perlu memantau beberapa sistem yang menjalankan SSH pada port default, konfigurasi port sudah akan diwarisi dari template host generik . </p>\n\n<p> Saya harap ini membantu orang lain yang mengalami kesulitan yang sama. Saya masih mencoba memahami mengapa pemeriksaan jarak jauh tidak menggunakan file konfigurasi khusus di server jarak jauh. </p>","votes":"6","source":"https://superuser.com/a/452065","author":"<a href=\"https://superuser.com/users/110085/danielcraigie\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">danielcraigie</span></a>","replies":[{"reply":"Ini bekerja dengan sempurna untuk saya. Terima kasih Pak!","author":"<a href=\"https://superuser.com/users/79608/bryan-agee\" target=\"_blank\" rel=\"nofollow noopener\">Bryan Agee</a>"}]}]}
