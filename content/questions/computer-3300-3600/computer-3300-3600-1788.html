{"title":"Menulis keluaran ECHO ke File VBS tidak berfungsi","draft":false,"url":"/menulis-keluaran-echo-ke-file-vbs-tidak-berfungsi-su9obwkg","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["command-line","batch","vbscript","echo","writing"],"snippet":"Saya menulis Batch Script yang membuat VB Script dengan menggemakan setiap baris dan mengarahkan output ke file yang dibuat. Ini berfungsi untuk sebagian besar, kecuali untuk dua baris yang mendapatkan variabel Baris...","body":"<p> Saya menulis Batch Script yang membuat VB Script dengan menggemakan setiap baris dan mengarahkan output ke file yang dibuat. Ini berfungsi untuk sebagian besar, kecuali untuk dua baris yang mendapatkan variabel Baris Perintah dan menggunakannya sebagai variabel VBS. Ini kodenya: </p> <pre><code>ECHO:strHomeFolder = oShell.ExpandEnvironmentStrings^(^\"^%USERPROFILE^%^\"^) &gt;&gt; uninstallBeta.vbs\nECHO:strProgramData = oShell.ExpandEnvironmentStrings^(^\"^%ProgramData^%^\"^) &gt;&gt; uninstallBeta.vbs\n</code></pre> <p> Ini akan terlihat seperti ini di VB Script: </p> <pre><code>strHomeFolder = oShell.ExpandEnvironmentStrings(\"%USERPROFILE%\")\nstrProgramData = oShell.ExpandEnvironmentStrings(\"%ProgramData%\")\n</code></pre> <p> Tapi yang terjadi adalah Batch Script itu hanya menggemakan seluruh baris, termasuk <code>&gt;&gt; uninstallBeta.vbs</code>. Adakah yang tahu mengapa ini terjadi? Saya memiliki baris serupa untuk membuat skrip VBS dan Batch lain yang menurut saya berfungsi dengan baik melakukannya dengan cara ini. Saya telah memeriksa kesalahan ketik dan tidak menemukannya. Ini berfungsi dengan baik di Command Prompt, tetapi tidak di Batch Script. </p>","source":"https://superuser.com/questions/1261162/writing-echo-output-to-vbs-file-not-working","author":"<a href=\"https://superuser.com/users/519818/a-child-of-god\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">A Child of God</span></a>","replies":[{"reply":"saya menemukan <a href=\"https://ss64.com/nt/syntax-redirection.html\" rel=\"nofollow noopener\" target=\"_blank\"> sebuah solusi </a> yang memperbaikinya, tetapi saya masih ingin tahu mengapa ini terjadi.","author":"<a href=\"https://superuser.com/users/519818/a-child-of-god\" target=\"_blank\" rel=\"nofollow noopener\">A Child of God</a>"},{"reply":"Anda mungkin ingin melihat <a href=\"https://stackoverflow.com/a/9074483/1012053\" target=\"_blank\" rel=\"nofollow noopener\"> stackoverflow.com/a/9074483/1012053 </a> , terutama <b><i> UPDATE 2014-04-27 </i></b> di bagian bawah, untuk metode yang sepenuhnya menghindari pembuatan file VBS terpisah. Anda benar-benar dapat menjalankan VBS langsung di dalam skrip batch!","author":"<a href=\"https://superuser.com/users/109090/dbenham\" target=\"_blank\" rel=\"nofollow noopener\">dbenham</a>"},{"reply":"@dbenham Saya melihat itu kemarin sebelum ada yang menjawab. Dalam akan mempertimbangkan untuk mencobanya.","author":"<a href=\"https://superuser.com/users/519818/a-child-of-god\" target=\"_blank\" rel=\"nofollow noopener\">A Child of God</a>"}],"answers":[{"answer":"<p> Ini membantu untuk memahami bagaimana cmd.exe mem-parsing skrip batch: <br>\n<a href=\"https://stackoverflow.com/a/4095133/1012053\" target=\"_blank\" rel=\"nofollow noopener\"> Bagian 1 - Gambaran Umum </a><br>\n<a href=\"https://stackoverflow.com/a/7970912/1012053\" target=\"_blank\" rel=\"nofollow noopener\"> Bagian 2 - Detail persen perluasan </a></p>\n\n<p> Saya akan mengerjakan pemrosesan baris pertama yang salah: </p> <pre class=\"lang-none prettyprint-override\"><code>echo strHomeFolder = oShell.ExpandEnvironmentStrings^(^\"^%USERPROFILE^%^\"^) &gt;&gt; uninstallBeta.vbs\n</code></pre> <p> Pemrosesan persen dalam fase 1 terjadi sebelum <code>^</code> lolos pemrosesan dalam fase 2. Jadi parser mencari variabel lingkungan bernama <code>USERPROFILE^</code>, dan gagal menemukannya. Sehingga mengembang menjadi string kosong, meninggalkan: </p> <pre class=\"lang-none prettyprint-override\"><code>echo strHomeFolder = oShell.ExpandEnvironmentStrings^(^\"^^\"^) &gt;&gt; uninstallBeta.vbs\n</code></pre> <p> Selanjutnya, tanda sisipan diproses untuk melepaskan karakter dalam fase dua. Yang penting <code>^\"</code> pertama adalah kutipan yang lolos, jadi karakter setelahnya <strong><em> tidak </em></strong> dikutip. <code>^^</code> berikutnya adalah tanda sisipan yang lolos. Than mengikuti kutipan pertama yang tidak di-escape, jadi semua karakter setelahnya akan dikutip. Saya menandakan bahwa dengan Q di atas setiap karakter yang dikutip: </p> <pre class=\"lang-none prettyprint-override\"><code>                                                        QQQQQQQQQQQQQQQQQQQQQQQ\necho strHomeFolder = oShell.ExpandEnvironmentStrings(\"^\"^) &gt;&gt; uninstallBeta.vbs\n</code></pre> <p> Harus jelas mengapa pengalihan <code>&gt;&gt;</code> tidak berfungsi - ini dikutip sehingga berfungsi sebagai string literal sebagai gantinya. </p>\n\n<p> Anda mencoba untuk keluar dari <code>%</code> sebagai <code>^%</code> untuk mencegah ekspansi variabel dalam kelompok. Itu tidak berhasil. Hal yang benar adalah menggandakan persen: </p> <pre class=\"lang-none prettyprint-override\"><code>echo strHomeFolder = oShell.ExpandEnvironmentStrings(\"%%USERPROFILE%%\") &gt;&gt; uninstallBeta.vbs\n</code></pre> <p> Jika garis berada dalam blok tanda kurung, maka Anda harus keluar dari <code>)</code>, tetapi <code>(</code> tidak perlu lolos </p> <pre class=\"lang-none prettyprint-override\"><code>for .... do (\n    ...\n    echo strHomeFolder = oShell.ExpandEnvironmentStrings(\"%%USERPROFILE%%\"^) &gt;&gt; uninstallBeta.vbs\n    ...\n)\n</code></pre> <p> Perhatikan bahwa aturan berbeda dari baris perintah. Tidak ada mekanisme untuk benar-benar melepaskan <code>%</code> dalam baris perintah, dan baris perintah mempertahankan teks <code>%undefinedVar%</code> jika variabel tidak ditentukan. Namun, Anda dapat secara efektif mencegah perluasan variabel dengan memasukkan satu atau lebih <code>^</code> di antara persen sehingga variabel tersebut tidak ditemukan. Tanda sisipan kemudian menghilang di fase 2. Tapi kutipan pertama harus dihilangkan sehingga <code>^</code> internal menghilang. Dan kutipan terakhir harus di-escape agar pengalihan aktif. </p>\n\n<p> Ini berfungsi dari baris perintah (tetapi tidak dalam skrip batch): </p> <pre class=\"lang-none prettyprint-override\"><code>echo strHomeFolder = oShell.ExpandEnvironmentStrings(^\"%USERPROFILE^%^\") &gt;&gt; uninstallBeta.vbs\n</code></pre> <p> Tanda sisipan dapat muncul di mana saja di antara persen. Semua hal berikut akan bekerja dengan baik: </p> <pre class=\"lang-none prettyprint-override\"><code>%USER^PROFILE%\n%^USERPROFILE%\netc.\n</code></pre>","votes":"6","source":"https://superuser.com/a/1261181","author":"<a href=\"https://superuser.com/users/109090/dbenham\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">dbenham</span></a>","replies":[{"reply":"@Facebook - Saya tidak tahu situasi apa yang Anda maksud. Saya harus melihat contoh konkret. Jika Anda mengetahui skenario yang benar-benar merepotkan, kirimkan pertanyaan baru, baik di sini atau di StackOverflow.","author":"<a href=\"https://superuser.com/users/109090/dbenham\" target=\"_blank\" rel=\"nofollow noopener\">dbenham</a>"},{"reply":"Ini dia pria .... <a href=\"https://superuser.com/questions/1261588/batch-script-parenthesized-echo-of-the-word-where-issue\" title=\"batch script parenthesized echo of the word where issue\" target=\"_blank\" rel=\"nofollow noopener\"> superuser.com/questions/1261588/â€¦ </a>","author":"<a href=\"https://superuser.com/users/510662/drink-more-pimp-juice-it\" target=\"_blank\" rel=\"nofollow noopener\">Drink More Pimp Juice IT</a>"}]},{"answer":"<p> Saya mencoba ini dan berfungsi seperti yang diharapkan juga ..... </p> <pre><code>set a=userprofile\nset b=ProgramData\n&gt; uninstallBeta.vbs ECHO strHomeFolder = oShell.ExpandEnvironmentStrings^(\"%%%a%%%%\"^)\n&gt;&gt; %DESKTOP%\\uninstallBeta.vbs ECHO strProgramData = oShell.ExpandEnvironmentStrings^(\"%%%b%%%%\"^)\n</code></pre> <p> Saya juga seorang pemula dalam batch-scripting. Saya menemukan ini bekerja dengan mencoba.\nberharap seseorang menjelaskan cara kerjanya. </p>","votes":"2","source":"https://superuser.com/a/1261186","author":"<a href=\"https://superuser.com/users/741364/tahaeltahawy\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">TahaEltahawy</span></a>","replies":[{"reply":"Lihat jawaban dbenham mengapa itu berhasil.","author":"<a href=\"https://superuser.com/users/519818/a-child-of-god\" target=\"_blank\" rel=\"nofollow noopener\">A Child of God</a>"}]}]}
