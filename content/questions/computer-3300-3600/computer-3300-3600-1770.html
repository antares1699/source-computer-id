{"title":"Powershell dan regex: Daftar file “backup on save” Notepad ++. Edit nama, urutkan menurut waktu terakhir","draft":false,"url":"/powershell-dan-regex-daftar-file-backup-on-save-notepad-edit-nama-urutkan-menurut-waktu-terakhir-rxmueib4","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["windows-10","powershell","text-editing"],"snippet":"# Microsoft Windows [Version 10.0.17134.648] # powershell 5.1.17134.48# Calculate time to complete task using Notepad++ \"backup on save\" feature.  Create a copy and paste table of files sorted by LastWriteTime.    #...","body":"<pre><code># Microsoft Windows [Version 10.0.17134.648] \n# powershell 5.1.17134.48\n# Calculate time to complete task using Notepad++ \"backup on save\" feature.  Create a copy and paste table of files sorted by LastWriteTime.    \n# Can be used as a shortcut: powershell -noexit $time = (Get-Date).AddDays(-1); gci * -exclude _*, 1* | where {$_.LastWriteTime -gt $time}| sort -property LastWriteTime -descending | Format-Table LastWriteTime, length, @{n='foo';e={$_.Name -replace '(?&lt;=^.*\\.html).*$' -replace '(?&lt;=^.*\\.jpg).*$'}} -HideTableHeaders\n# start it in %userprofile%\\Documents\\NOTEPAD++ AUTOBACKUP\nSet-Location -Path \"$env:userprofile\\Documents\\NOTEPAD++ AUTOBACKUP\"\n# how old a file? Today? 4 days old?\n$time = (Get-Date).AddDays(-1)\n# $time = (Get-Date).AddDays(-4)\n# do you want to exclude files with -exclude? Do you want to include with -include?\ngci * -exclude _*, 1* | where {$_.LastWriteTime -gt $time}| sort -property LastWriteTime -descending | Format-Table LastWriteTime, length, @{n='foo';e={$_.Name -replace '(?&lt;=^.*\\.html).*$' -replace '(?&lt;=^.*\\.jpg).*$'}} -HideTableHeaders\ngci * -exclude _*, 1* | where {$_.LastWriteTime -gt $time} | sort -property LastWriteTime -descending | Format-Table LastWriteTime, length, Name -HideTableHeaders\n# gci * | where {$_.LastWriteTime -gt $time} | sort -property LastWriteTime -descending | Format-Table LastWriteTime, length, @{n='foo';e={$_.Name -replace '(?&lt;=^.*\\.html).*$' -replace '(?&lt;=^.*\\.jpg).*$'}} -HideTableHeaders\n# gci * -include [0-9][0-9][0-9]*, avail* | where {$_.LastWriteTime -gt $time} | sort -property LastWriteTime -descending | Format-Table LastWriteTime, length, @{n='foo';e={$_.Name -replace '(?&lt;=^.*\\.html).*$' -replace '(?&lt;=^.*\\.jpg).*$'}} -HideTableHeaders\n</code></pre> <p> keluaran: </p> <pre><code>5/4/2019 10  :  47  :  27 AM  114036 springhill_falls2bd750_885.jpg\n5/4/2019 10  :  45  :  25 AM 1301974 springhill_falls2bd750_885.psp\n5/4/2019 10  :  37  :  08 AM   19268 springhill_falls2bd13.html\n5/4/2019 10  :  37  :  08 AM   94007 available13.html\n5/4/2019 10  :  37  :  08 AM   36729 index.html\n5/4/2019 10  :  32  :  16 AM   62801 aj.php\n</code></pre> <p> dan: </p> <pre><code>5/4/2019 10  :  47  :  27 AM  114036 springhill_falls2bd750_885.jpg.2019-05-04_104748.bak\n5/4/2019 10  :  45  :  25 AM 1301974 springhill_falls2bd750_885.psp.2019-05-04_105221.bak\n5/4/2019 10  :  37  :  08 AM   19268 springhill_falls2bd13.html.2019-05-04_105856.bak\n5/4/2019 10  :  37  :  08 AM   94007 available13.html.2019-05-04_105657.bak\n5/4/2019 10  :  37  :  08 AM   36729 index.html.2019-05-04_105657.bak\n5/4/2019 10  :  32  :  16 AM   62801 aj.php.2019-05-04_103229.bak\n</code></pre> <p> Microsoft Windows [Versi 10.0.17134.648] <br> PowerShell 5.1.17134.48 <br></p>\n\n<p> Hitung waktu untuk menyelesaikan tugas menggunakan fitur Notepad ++ / NPP / Notepad Plus &quot;backup on save&quot;. <br></p>\n\n<p> Buat tabel salin dan tempel file yang diurutkan berdasarkan LastWriteTime. <br></p>\n\n<p> Dapat digunakan sebagai jalan pintas: </p> <pre><code>powershell -noexit $time = (Get-Date).AddDays(-1); gci * -exclude _*, 1* |\n    where {$_.LastWriteTime -gt $time} | sort -property LastWriteTime -descending |\n    Format-Table LastWriteTime, length, @{n='foo';e={$_.Name\n    -replace '(?&lt;=^.*\\.html).*$' -replace '(?&lt;=^.*\\.jpg).*$'}} -HideTableHeaders\n</code></pre> <p> Mulailah di direktori tempat cadangan otomatis NPP Anda berjalan. File saya dicadangkan ke <code>%userprofile%\\Documents\\NOTEPAD++ AUTOBACKUP</code> </p>\n\n<p> Skrip ini membuat output tabel yang diformat dengan nama file, ukuran, tanggal, dan waktu yang diedit setiap kali file ditulis. Sangat mudah untuk mengubah file mana yang akan dicari, cara mengedit nama file dan berapa hari lamanya file yang ingin Anda cari. Ini adalah cara mudah untuk melacak berapa lama sebuah file dikerjakan, berapa lama sebuah tugas diselesaikan, berapa lama sebuah proyek berlangsung. </p>\n\n<p> Lihat jawaban LotPing di bawah ini untuk informasi tentang regex. </p>","source":"https://superuser.com/questions/1419414/powershell-and-regex-list-of-notepad-backup-on-save-files-edit-name-sort","author":"<a href=\"https://superuser.com/users/1003800/somebadhat\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">somebadhat</span></a>","replies":[],"answers":[{"answer":"<p> Saya akan menggunakan RegEx dengan <a href=\"https://www.regular-expressions.info/lookaround.html\" rel=\"nofollow noopener\" target=\"_blank\"> pernyataan lookbehind panjang nol </a> untuk menghapus semuanya setelah <code>html</code> dari <code>$_.Name</code> </p>\n\n<p> Ini dapat dilakukan dengan properti terhitung baik di <code>Select-Object</code> atau juga di <code>Format-*</code> </p> <pre><code>Get-ChildItem -File | \n  Format-Table @{n='foo';e={$_.Name -replace '(?&lt;=^.*\\.html).*$'}},Name -HideTableHeaders\n</code></pre> <p> Output sampel: </p> <pre><code>available13.html available13.html.2019-03-26_081523.bak\nindex.html       index.html.2019-03-26_081538.bak\n</code></pre>","votes":"4","source":"https://superuser.com/a/1419421","author":"<a href=\"https://superuser.com/users/639112/lotpings\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">LotPings</span></a>","replies":[]},{"answer":"<p> Anda dapat menambahkan properti baru dengan <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/add-member?view=powershell-6\" rel=\"nofollow noopener\" target=\"_blank\"> <code>Add-Member</code> </a> seperti ini </p> <pre><code>$time = (Get-Date).AddDays(-4)\n$files = gci * -include index*,avail* | where {$_.LastWriteTime -gt $time}\nforeach ($f in $files) {\n    $f | Add-Member noteproperty newName -Value `\n             $f.Name.Substring(0, $f.Name.Length - \".yyyy-mm-dd_iiiiii.bak\".Length)\n}\n$files | Format-Table -HideTableHeaders newName,Length,LastWriteTime\n</code></pre> <p> Perhatikan bahwa potongan di atas mengasumsikan bahwa nama Anda selalu diakhiri dengan <code>.yyyy-mm-dd_iiiiii.bak</code>. Jika mereka memiliki beberapa format lain maka Anda harus menyertakan informasi tersebut dalam pertanyaan, dan Anda mungkin perlu menggunakan metode string lain seperti mengganti, substring ... untuk menghapus yang tidak perlu bagian </p>","votes":"4","source":"https://superuser.com/a/1419422","author":"<a href=\"https://superuser.com/users/241386/phuclv\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">phuclv</span></a>","replies":[{"reply":"@LotPings Saya memilih jawaban LotPings karena itu akan menjadi jawaban jika saya mengajukan pertanyaan yang lebih baik. Terima kasih telah meluangkan waktu. Kode Anda berfungsi.","author":"<a href=\"https://superuser.com/users/1003800/somebadhat\" target=\"_blank\" rel=\"nofollow noopener\">somebadhat</a>"}]}]}
