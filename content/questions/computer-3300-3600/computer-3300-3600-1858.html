{"title":"Selesaikan contoh NAT masquerading menggunakan nftables di Linux?","draft":false,"url":"/selesaikan-contoh-nat-masquerading-menggunakan-nftables-di-linux-7vvpdqm7","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["networking","firewall","nat","gateway"],"snippet":"Saya mencari contoh lengkap bagaimana melakukan ini menggunakan nftables. Ini harus klien DHCP pada antarmuka upstream, memiliki LAN 192.168.0.0/24 pada antarmuka lain, dan juga bertindak sebagai firewall.  Kredit ekstra untuk membuka port...","body":"<p> Saya mencari contoh lengkap bagaimana melakukan ini menggunakan nftables. Ini harus klien DHCP pada antarmuka upstream, memiliki LAN 192.168.0.0/24 pada antarmuka lain, dan juga bertindak sebagai firewall. </p>\n\n<p> Kredit ekstra untuk membuka port ssh pada antarmuka upstream, dan meneruskan lalu lintas port 80 ke beberapa server lain di LAN. </p>\n\n<p> Wiki nftables meninggalkan beberapa pertanyaan yang belum terjawab. Misalnya, file <a href=\"http://wiki.nftables.org/wiki-nftables/index.php/Performing_Network_Address_Translation_%28NAT%29\" rel=\"nofollow noopener\" target=\"_blank\"> bagian tentang penyamaran </a> tidak menjelaskan cara memasang aturan masquerading ke satu antarmuka vs yang lain. </p>","source":"https://superuser.com/questions/985800/complete-masquerading-nat-example-using-nftables-on-linux","author":"<a href=\"https://superuser.com/users/98013/johannes-ernst\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Johannes Ernst</span></a>","replies":[],"answers":[{"answer":"<p> Inilah yang saya gunakan, dengan asumsi <code>lan0</code> terhubung ke jaringan internal Anda, dan <code>wan0</code> ke ISP Anda. </p>\n\n<p> Saya tidak yakin apa yang Anda maksud dengan &quot;klien DHCP di antarmuka upstream&quot;, karena ini dilakukan dengan klien DHCP, bukan nftables. Pengaturan di bawah ini tidak membatasi lalu lintas keluar sehingga permintaan DHCP akan diproses. </p> <pre><code>#!/usr/bin/nft -f\n\nflush ruleset\n\ntable inet filter {\n  chain input {\n    type filter hook input priority 0; policy drop;\n\n    # allow established/related connections\n    ct state {established, related} accept\n\n    # early drop of invalid connections\n    ct state invalid drop\n\n    # allow from loopback\n    iifname lo accept\n\n    # Allow from internal network\n    iifname lan0 accept\n\n    # allow icmp\n    ip protocol icmp accept\n\n    # allow ssh\n    tcp dport 22 accept comment \"SSH in\"\n\n    reject\n  }\n\n  chain forward {\n    type filter hook forward priority 0;\n\n    # Allow outgoing via wan0\n    oifname wan0 accept\n\n    # Allow incoming on wan0 for related &amp; established connections\n    iifname wan0 ct state related, established accept\n\n    # Drop any other incoming traffic on wan0\n    iifname wan0 drop\n  }\n\n  chain output {\n    type filter hook output priority 0;\n  }\n\n}\n\ntable ip nat {\n  chain prerouting {\n    type nat hook prerouting priority 0;\n\n    # Forward traffic from wan0 to a LAN server\n    iifname wan0 tcp dport 80 dnat 192.168.0.8 comment \"Port forwarding to web server\"\n  }\n\n  chain postrouting {\n    type nat hook postrouting priority 0;\n\n    # Masquerade outgoing traffic\n    oifname wan0 masquerade\n  }\n}\n</code></pre>","votes":"6","source":"https://superuser.com/a/1225109","author":"<a href=\"https://superuser.com/users/744726/nico\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Nico</span></a>","replies":[]},{"answer":"<p> Penyamaran adalah kasus khusus SNAT. Jika Anda ingin memasang lalu lintas ke antarmuka keluaran atau alamat keluaran (Alamat sumber untuk IP internal Anda) gunakan SNAT </p>","votes":"2","source":"https://superuser.com/a/1480121","author":"<a href=\"https://superuser.com/users/1056733/taybinakh\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">taybinakh</span></a>","replies":[]}]}
