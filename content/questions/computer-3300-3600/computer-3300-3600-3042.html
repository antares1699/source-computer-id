{"title":"Bagaimana cara menjalankan prosedur SQL yang tersimpan di Microsoft Excel?","draft":false,"url":"/bagaimana-cara-menjalankan-prosedur-sql-yang-tersimpan-di-microsoft-excel-l5xrhwan","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["microsoft-excel","vba","sql-server-2008","data-transfer"],"snippet":"Bagaimana saya bisa menjalankan prosedur tersimpan di Microsoft Excel dan mendapatkan semua data yang dikembalikannya?","body":"<p> Bagaimana saya bisa menjalankan prosedur tersimpan di Microsoft Excel dan mendapatkan semua data yang dikembalikannya? </p>","source":"https://superuser.com/questions/325163/how-to-execute-a-stored-sql-procedure-in-microsoft-excel","author":"<a href=\"https://superuser.com/users/81809/safran-ali\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Safran Ali</span></a>","replies":[{"reply":"Saya rasa ini menunjukkan betapa pentingnya pemberian tag yang benar. <a href=\"http://superuser.com/questions/325163/how-to-execute-a-stored-sql-procedure-in-microsoft-excel/325172#325172\" target=\"_blank\" rel=\"nofollow noopener\"> Saat saya menjawab </a> , itu <i> vba </i> tag tidak ada di sana, dan saya pikir itu bukan pertanyaan vba ...","author":"<a href=\"https://superuser.com/users/82952/takrl\" target=\"_blank\" rel=\"nofollow noopener\">takrl</a>"}],"answers":[{"answer":"<p> Ini adalah pekerjaan untuk koneksi ADODB di VBA. Berikut link dengan kode sampel untuk kueri SELECT sederhana, tetapi ini juga akan menangani prosedur yang tersimpan. </p>\n\n<p><a href=\"http://www.ozgrid.com/forum/showthread.php?t=83016&page=1\" rel=\"nofollow noopener\" target=\"_blank\"> http://www.ozgrid.com/forum/showthread.php?t=83016&amp;page=1 </a></p>\n\n<p> Item utamanya adalah kebutuhan untuk mendeklarasikan <code>ADODB.Connection</code>, <code>ADODB.Recordset</code>, dan string koneksi yang cocok dengan database Anda. Setelah membuka koneksi, Anda menjalankan pernyataan SQL Anda menggunakan sintaks seperti berikut (diambil dari tautan): </p> <pre><code>With cnt \n    .CursorLocation = adUseClient \n    .Open stADO    // stADO is the connection string.\n    .CommandTimeout = 0 \n    Set rst = .Execute(stSQL) \nEnd With\n</code></pre> <p> Kemudian pindahkan data dari kumpulan data Anda (<code>rst</code>, di atas) ke dalam rentang menggunakan <code>Range.CopyFromRecordSet</code>. </p>","votes":"5","source":"https://superuser.com/a/325214","author":"<a href=\"https://superuser.com/users/76571/excellll\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Excellll</span></a>","replies":[]},{"answer":"<p> Saya tidak yakin tentang inkarnasi Excel terbaru, tetapi pada tahun 2000 dan 2003 yang dapat Anda lakukan hanyalah mengakses tampilan dan menampilkan datanya di lembar excel. </p>\n\n<p> Keuntungan utama dari prosedur tersimpan adalah kemampuan untuk membuat parameter hasil, tetapi untuk itu Anda memerlukan semacam UI, dan Anda memerlukan cara untuk mengubah definisi kueri secara terprogram setelah didefinisikan pertama kali dalam excel. Kami tidak menemukan cara untuk melakukan ini, tetapi menggunakan tampilan menyediakan fungsionalitas yang cukup untuk apa yang perlu kami lakukan. </p>","votes":"1","source":"https://superuser.com/a/325172","author":"<a href=\"https://superuser.com/users/82952/takrl\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">takrl</span></a>","replies":[]},{"answer":"<p> VBA ini sangat mirip dengan jawaban @ Excellll, dan saya telah menggunakannya untuk memberikan pengaruh yang baik dalam pekerjaan saya. </p>\n\n<p> Gunakan fungsi utilitas kecil ini: </p> <pre><code>Public Function IsEmptyRecordset(rs As Recordset) As Boolean\n     IsEmptyRecordset = ((rs.BOF = True) And (rs.EOF = True))\nEnd Function\n</code></pre> <p> Dan kemudian inilah fungsi besarnya (saya minta maaf atas penyelarasan paragraf yang tampak jelek): </p> <pre><code>Option Explicit\n\nPublic Sub OpenConnection()\nDim conn As ADODB.Connection\nDim str As String\nDim cmd As ADODB.Command\nDim rs As ADODB.Recordset\nDim myPath\nDim fld\nDim i As Integer\n\nOn Error GoTo errlbl\n\n\n'Open database connection\nSet conn = New ADODB.Connection\n\n'First, construct the connection string.\n\n'NOTE:  YOU CAN DO THIS WITH A STRING SPELLING OUT THE ENTIRE CONNECTION...\n'conn.ConnectionString = _\n'    \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n'    \"Data Source=\" &amp; _\n'    myPath &amp; \"\\ConnectionTest.mdb\"\n\n'...OR WITH AN ODBC CONNECTION YOU'VE ALREADY SET UP:\nconn.ConnectionString = \"DSN=myDSN\"\n\nconn.Open       'Here's where the connection is opened.\n\nDebug.Print conn.ConnectionString  'This can be very handy to help debug!\n\nSet rs = New ADODB.Recordset\n'Construct string.  This can \"Select\" statement constructed on-the-fly,\n'str = \"Select * from vwMyView order by Col1, Col2, Col3\"  \n'or an \"Execute\" statement:\nstr = \"exec uspMyStoredProc\"\n\nrs.Open str, conn, adOpenStatic, adLockReadOnly  ‘recordset is opened here\n\nIf Not IsEmptyRecordset(rs) Then     \n    rs.MoveFirst\n\n    'Populate the first row of the sheet with recordset’s field names\n    i = 0\n    For Each fld In rs.Fields\n        Sheet1.Cells(1, i + 1).Value = rs.Fields.Item(i).Name\n        i = i + 1\n    Next fld\n    'Populate the sheet with the data from the recordset\n    Sheet1.Range(\"A2\").CopyFromRecordset rs     \n\n\nElse\n    MsgBox \"Unable to open recordset, or unable to connect to database.\", _\n       vbCritical, \"Can't get requested records\"\n\nEnd If\n\n'Cleanup\nrs.Close\nSet rs = Nothing\nconn.Close\nSet conn = Nothing\n\nexitlbl:\n  Debug.Print \"Error: \" &amp; Err.Number\n  If Err.Number = 0 Then\n    MsgBox \"All data has been pulled and placed on Sheet1\", vbOKOnly, \"All Done.\"\n  End If\n  Exit Sub\nerrlbl:\n   MsgBox \"Error #: \" &amp; Err.Number &amp; \", Description:  \" &amp; Err.Description, _     vbCritical, \"Error in OpenConnection()\"\nExit Sub\n'Resume exitlbl\nEnd Sub\n</code></pre> <p> Semoga ini membantu. </p>","votes":"1","source":"https://superuser.com/a/325234","author":"<a href=\"https://superuser.com/users/55392/f106dart\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">F106dart</span></a>","replies":[]}]}
