{"title":"mengapa% CD% tidak berfungsi setelah menggunakan pushd ke jalur UNC?","draft":false,"url":"/mengapa-cd-tidak-berfungsi-setelah-menggunakan-pushd-ke-jalur-unc-7os2wavj","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["windows","batch"],"snippet":"dalam file batch, saya mengulangi daftar jalur unc dalam file, menggunakan pushd untuk mengubah konteks ke lokasi itu, lalu menjalankan perintah.% CD% memberikan lokasi direktori sebelumnya, bukan direktori yang saat ini...","body":"<p> dalam file batch, saya mengulangi daftar jalur unc dalam file, menggunakan pushd untuk mengubah konteks ke lokasi itu, lalu menjalankan perintah.\n% CD% memberikan lokasi direktori sebelumnya, bukan direktori yang saat ini didorong. </p> <pre><code>for /f \"tokens=*\" %%A in (filesharelist.txt) do (\n pushd %%A\n echo CD=%CD% - expecting x:\\ or x:\\subpath here, but get previous directory\n REM xcopy *.xml %DestinationDirectory% /V /C /Y /Z\n popd\n)\n</code></pre> <p> Bagaimana cara mendapatkan direktori saat ini? </p>","source":"https://superuser.com/questions/503488/why-doesnt-cd-work-after-using-pushd-to-a-unc-path","author":"<a href=\"https://superuser.com/users/140457/jjs\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">JJS</span></a>","replies":[{"reply":"Apakah konteks pengguna yang dijalankan skrip memiliki akses (izin berbagi dan file) ke sumber daya UNC? Jika Anda mengganti baris% CD% dengan sesuatu seperti <code>echo test &gt;&gt; test.txt</code> setelah pushd, apakah test.txt dibuat sesuai dengan yang Anda harapkan? Apa yang saya maksud adalah bahwa% CD% mungkin berfungsi dengan baik, tetapi PushD gagal karena beberapa alasan.","author":"<a href=\"https://superuser.com/users/23133/%c6%ac%e1%b4%87c%ca%9c%ce%b9%e1%b4%87007\" target=\"_blank\" rel=\"nofollow noopener\">&#x1AC;&#x1D07;c&#x29C;&#x3B9;&#x1D07;007</a>"},{"reply":"techie007: sangat salah.","author":"<a href=\"https://superuser.com/users/2054/joey\" target=\"_blank\" rel=\"nofollow noopener\">Joey</a>"},{"reply":"@ techie007 - ya, pushd berfungsi seperti yang diharapkan. Saya menguji dengan DIR &gt;&gt; log.txt serta CD &gt;&gt; log.txt.","author":"<a href=\"https://superuser.com/users/140457/jjs\" target=\"_blank\" rel=\"nofollow noopener\">JJS</a>"}],"answers":[{"answer":"<p> <code>%CD%</code> bekerja sebagaimana mestinya. Masalah Anda adalah bahwa itu diperluas <em> sebelum </em> loop <code>for</code> Anda bahkan berjalan. Gunakan ekspansi tertunda sebagai gantinya: </p> <pre><code>setlocal enabledelayedexpansion\nfor /f \"tokens=*\" %%A in (filesharelist.txt) do (\n pushd %%A\n echo CD=!CD!\n REM xcopy *.xml %DestinationDirectory% /V /C /Y /Z\n popd\n)\n</code></pre> <p> Ekspansi variabel pada <code>cmd</code> sedikit berlawanan dengan intuisi. Variabel lingkungan normal (dari bentuk <code>%foo%</code>, termasuk variabel semu seperti <code>%date%</code>, <code>%cd%</code>, ...) diperluas ketika pernyataan <em> diurai </em> , bukan saat dijalankan. Blok seperti yang mengikuti <code>do</code> dihitung sebagai pernyataan tunggal sehingga setiap variabel di blok diganti dengan nilainya <em> sebelum </em> loop <code>for</code> bahkan berjalan. Yang berarti <code>%CD%</code> diganti dengan nilai yang dimilikinya <em> sebelum </em> putaran. Tidak mengherankan, inilah nilainya <em> sebelum </em> yang <code>pushd</code>. </p>\n\n<p> Ekspansi yang tertunda mengatasi masalah dengan memperluas variabel tepat sebelum pernyataan <em> dieksekusi </em> . Mereka perlu menggunakan formulir <code>!foo!</code> untuk itu <em> dan </em> itu harus diaktifkan secara eksplisit dengan <code>setlocal enabledelayedexpansion</code> atau <code>cmd</code> harus dimulai dengan <code>cmd /v:on</code> atau harus diaktifkan di registri. Cara teraman adalah yang pertama karena tidak bergantung pada konfigurasi atau lingkungan luar apa pun. </p>\n\n<p><strong> Kuis bonus: </strong> <em> Kenapa </em> <code>%DestinationDirectory%</code> <em> masih berfungsi sebagaimana mestinya? </em></p>","votes":"7","source":"https://superuser.com/a/503525","author":"<a href=\"https://superuser.com/users/2054/joey\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Joey</span></a>","replies":[{"reply":"doh. bahkan tidak berpikir untuk mencoba ekspansi yang tertunda. Terima kasih atas pengingatnya yang lembut. % DestinationDirectory% berfungsi karena tidak didasarkan pada %% A atau apa pun di dalam blok FOR. Ini ditentukan di bagian atas file batch :)","author":"<a href=\"https://superuser.com/users/140457/jjs\" target=\"_blank\" rel=\"nofollow noopener\">JJS</a>"},{"reply":"+1, ini menyelamatkan saya dari mencabut semua rambut saya hari ini. DOS = :(","author":"<a href=\"https://superuser.com/users/123180/dominic-p\" target=\"_blank\" rel=\"nofollow noopener\">Dominic P</a>"},{"reply":"@DominicP: Ini sama sekali tidak ada hubungannya dengan DOS ...","author":"<a href=\"https://superuser.com/users/2054/joey\" target=\"_blank\" rel=\"nofollow noopener\">Joey</a>"},{"reply":"Ha ha, ya, begitu saya menulis bahwa saya pikir seseorang akan menelepon saya di sana. Bagaimana dengan: skrip shell di Windows membuat saya sedih?","author":"<a href=\"https://superuser.com/users/123180/dominic-p\" target=\"_blank\" rel=\"nofollow noopener\">Dominic P</a>"},{"reply":"@DominicP: Lalu gunakan PowerShell; setelah itu skrip shell di Unix membuat Anda sedih;)","author":"<a href=\"https://superuser.com/users/2054/joey\" target=\"_blank\" rel=\"nofollow noopener\">Joey</a>"}]}]}
