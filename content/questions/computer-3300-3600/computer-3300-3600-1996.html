{"title":"Daftar semua pengguna yang masuk menggunakan GUI atau Command Line","draft":false,"url":"/daftar-semua-pengguna-yang-masuk-menggunakan-gui-atau-command-line-ozbhogjg","votes":"4","answers_count":"4","categories":["Komputer"],"tags":["linux","ubuntu","bash","ubuntu-12.04"],"snippet":"Saya perlu menghitung total waktu pengguna tertentu tetap masuk per hari. Dan hentikan pengguna menggunakan komputer lebih dari waktu yang diizinkan dengan mematikan sistem.  uptime tidak dapat digunakan karena ini adalah komputer...","body":"<p> Saya perlu menghitung total waktu pengguna tertentu tetap masuk per hari. Dan hentikan pengguna menggunakan komputer lebih dari waktu yang diizinkan dengan mematikan sistem. </p>\n\n<p> <code>uptime</code> tidak dapat digunakan karena ini adalah komputer multipengguna </p>\n\n<p> Perintah <code>last</code> tidak berfungsi, karena, seperti yang saya amati, perintah ini hanya menyimpan data pengguna yang menjalankan terminal. Jika seorang pengguna login menggunakan GUI dan terus menggunakan komputer tanpa menjalankan terminal, sebuah entri adalah <strong> tidak </strong> ditulis ke / var / log / wtmp. </p>\n\n<p> Adakah cara untuk menemukan informasi yang saya butuhkan?\nSaya menggunakan Ubuntu 12.04 LTS </p>","source":"https://superuser.com/questions/601718/list-of-all-the-users-that-logged-in-using-gui-or-command-line","author":"<a href=\"https://superuser.com/users/61886/niroshan\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Niroshan</span></a>","replies":[{"reply":"Berapa lama Anda ingin mengizinkan? Menit? Jam?","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\">terdon</a>"},{"reply":"Anda mengatakan ini adalah komputer multiuser, bukankah itu buruk bagi pengguna lain ketika komputer dimatikan jika <i> apa saja </i> pengguna lain melebihi batas hariannya?","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"@ mpy- OK &#39;multiuser&#39; tidak boleh diartikan secara teknis murni terkait dengan mainframe, dll. Ini lebih untuk hal-hal seperti kontrol orang tua. Rencananya adalah memeriksa nama pengguna dan mematikan jika seseorang menghabiskan terlalu banyak waktu di komputer :)","author":"<a href=\"https://superuser.com/users/61886/niroshan\" target=\"_blank\" rel=\"nofollow noopener\">Niroshan</a>"},{"reply":"@terdon Katakanlah 1 jam untuk saat ini","author":"<a href=\"https://superuser.com/users/61886/niroshan\" target=\"_blank\" rel=\"nofollow noopener\">Niroshan</a>"},{"reply":"Lihat penghitungan proses Unix: Perintah <code>ac</code> dapat menunjukkan kepada Anda durasi login per pengguna dan hari. Pada OS X, keluaran hari ini untuk saya terlihat seperti ini: <code>May 30  total       21.56</code>","author":"<a href=\"https://superuser.com/users/22317/daniel-beck\" target=\"_blank\" rel=\"nofollow noopener\">Daniel Beck&#9830;</a>"}],"answers":[{"answer":"<p> <code>who</code> (menggunakan <code>/var/run/utmp</code>) akan berfungsi jika pengguna juga masuk melalui X. </p>\n\n<p> Kemudian Anda dapat menjalankan skrip ini melalui <code>/etc/crontab</code> <em> setiap menit </em> . Apa fungsinya: </p>\n\n<ul>\n<li> loop atas semua pengguna (<code>$u</code>) yang saat ini masuk </li>\n<li> menambah angka menjadi <code>/var/log/accounting-$u</code> - karena ini dilakukan setiap menit, file tersebut menyimpan total waktu pengguna <code>$u</code> masuk sejauh ini. </li>\n<li> periksa apakah <code>$u</code> telah mencapai batas (<code>$allowedtime</code>), di sini 60 menit. Jika demikian, matikan sistem atau apa pun. 5 menit sebelumnya hanya mengirim peringatan (atas kebaikan @terdon). </li>\n<li> akhirnya jika pengguna <code>$u</code> tidak terlihat selama 24 jam terakhir, hapus <code>/var/log/accounting-$u</code> dan permainan dapat dimulai dari awal. </li>\n</ul>\n\n<p> Seperti yang saya sebutkan dalam komentar, menurut saya mematikan sistem bukanlah ide yang bagus. Terutama dengan skrip ini, karena jika pengguna masuk lagi saat 24 jam belum berakhir, tindakan penonaktifan akan dipicu setelah kurang dari satu menit (saat cron mulai <code>accounting.sh</code> di lain waktu). </p>\n\n<hr>\n\n<p><strong> akuntansi.sh </strong></p> <pre><code>#!/bin/bash\n\naccountinglogprefix=/var/log/accounting-\nallowedtime=60\n\nfor u in $(who | cut -d \" \" -f 1 | sort | uniq); do\n\n  if [[ -e ${accountinglogprefix}${u} ]]; then\n    consumed=$(cat ${accountinglogprefix}${u})\n  else\n    consumed=0\n  fi\n  echo -n $(( consumed + 1 )) &gt; ${accountinglogprefix}${u}\n\n  if [[ $consumed -gt $allowedtime ]]; then \n    # time is over, do whatever you want\n    echo \"Shutting down...\"\n  elif [[ $consumed -gt $(( allowedtime - 5 )) ]]; then\n    # notify the user $u that his time is over in 5 minutes with a suitable command\n    echo \"Time's up! Shutting down in 5 minutes...\"\n  fi\n\n  # check if e.g. 24h have passed since the user was last seen\n  if [[ $(( $(date +%s ) - $(stat -c %Y ${accountinglogprefix}${u}) )) -gt $(( 24 * 3600 )) ]]; then\n    rm ${accountinglogprefix}${u}\n  fi\n\ndone\n</code></pre> <p><strong> catatan: </strong> Ini bukan skrip yang sepenuhnya matang (yaitu siap untuk disalin &amp; ditempel) - ini hanya harus menunjukkan pendekatan yang berbeda. </p>","votes":"4","source":"https://superuser.com/a/601767","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">mpy</span></a>","replies":[]},{"answer":"<p> Daripada menulis skrip khusus, seseorang dapat menggunakan perangkat lunak yang tersedia dan dirancang untuk melakukan hal itu dan banyak lagi. </p>\n\n<p> harap periksa apakah <code>psacct</code> tersedia untuk Anda instal. </p>\n\n<p> Dari: <a href=\"http://www.cyberciti.biz/tips/howto-log-user-activity-using-process-accounting.html\" rel=\"nofollow noopener\" target=\"_blank\"> http://www.cyberciti.biz/tips/howto-log-user-activity-using-process-accounting.html </a></p>\n\n<blockquote>\n  <p> Paket psacct berisi beberapa utilitas untuk proses pemantauan\n  aktivitas, termasuk ac, lastcomm, accton dan sa. </p> <pre><code>The ac command displays statistics about how long users have been logged on.\nThe lastcomm command displays information about previous executed commands.\nThe accton command turns process accounting on or off.\nThe sa command summarizes information about previously executed commmands.\n</code></pre> </blockquote>","votes":"3","source":"https://superuser.com/a/601851","author":"<a href=\"https://superuser.com/users/224976/chris\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Chris</span></a>","replies":[{"reply":"1 untuk roda yang tidak ditemukan lagi. Instalasi Ubuntu adalah <code>sudo apt-get install acct</code> (dan <code>sudo service acct start</code>).","author":"<a href=\"https://superuser.com/users/166800/lserni\" target=\"_blank\" rel=\"nofollow noopener\">LSerni</a>"}]},{"answer":"<p> Anda juga dapat mencoba mengurai keluaran <code>ps</code>: </p> <pre><code>$ ps -U terdon -u terdon -o %t \n  ELAPSED\n  00:39\n  00:06\n</code></pre> <p> Dalam contoh ini, pengguna <code>terdon</code> menjalankan dua proses, yang tertua telah berjalan selama 39 detik. Jadi, jika Anda mengurai ini untuk mendapatkan proses yang berjalan paling lama (mungkin shell login pengguna), Anda dapat mengetahui berapa lama pengguna telah login. Dalam contoh ini, saya akan berasumsi bahwa Anda ingin mengizinkan setidaknya satu jam penuh (itu mengapa saya menggunakan <code>NF&gt;=3</code> dalam perintah <code>gawk</code>) tetapi tidak lebih dari 4: </p> <pre><code>ps -U terdon -u terdon -o %t | grep : | sed 's/ *//g' | \n   gawk -F\"[ +:]\" 'NF&gt;=3{print $1}' | sort -g | tail -n 1\n</code></pre> <p> Perintah ini akan mencetak yang telah berlalu <strong> jam </strong> dari perintah berjalan terpanjang pengguna terdon. Sekarang Anda dapat memeriksa apakah itu lebih atau kurang dari 4: </p> <pre><code>limit=4;\ntime=$(ps -U terdon -u terdon -o %t |  grep : | sed 's/ *//g' | \n        gawk -F\"[ +:]\" 'NF&gt;=3{print $1}' | sort -g | tail -n 1);\n if [[ $time -gt 3 ]]; \n then echo \"Time's up! Shutting down in 5 minutes...\";\n      shutdown -h +5\nfi\n</code></pre>","votes":"1","source":"https://superuser.com/a/601737","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">terdon</span></a>","replies":[{"reply":"Tetapi Anda dapat dengan mudah &quot;meretas&quot; ini dengan keluar dan segera masuk lagi saat Anda mendapatkan pesan &quot;Waktu habis&quot; ?!","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"Ya, tapi itu tidak jujur!","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\">terdon</a>"},{"reply":"bagaimana dengan menulis waktu yang telah dihabiskan ke file secara berkala atau saat pengguna keluar dan membaca file itu saat masuk di lain waktu","author":"<a href=\"https://superuser.com/users/61886/niroshan\" target=\"_blank\" rel=\"nofollow noopener\">Niroshan</a>"},{"reply":"Ya, lihat jawaban @ mpy di bawah ini.","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\">terdon</a>"}]},{"answer":"<p> Anda dapat mengaudit log aman Anda. Itu terletak di: </p>\n\n<blockquote>\n  <p> / var / log / secure </p>\n</blockquote>\n\n<p> Ini memberi Anda login dan logout. Anda juga dapat menjalankan logwatch dan itu akan memberi Anda siapa yang masuk untuk periode Anda menjalankannya. </p>\n\n<p> Berikut beberapa informasi lainnya juga: </p>\n\n<p><strong> 1. Ambil semua proses masuk yang berhasil di sistem </strong></p>\n\n<blockquote>\n  <p> cat / var / log / secure * | grep Diterima&gt; logins.txt </p>\n</blockquote>\n\n<p> Sekarang logins.txt akan berisi semua login yang berhasil ke sistem linux Redhat Anda.\nAnda dapat melihat file tersebut dan melihat manualnya terlebih dahulu. </p>\n\n<p><strong> 2. Periksa pengguna pada waktu yang ditentukan </strong></p>\n\n<p> Perintah lain untuk mengetahui detail login terakhir dari pengguna tertentu yang kami miliki <em> terakhir, terakhirb </em> perintah yang menunjukkan daftar pengguna yang masuk terakhir. </p>\n\n<p> Program terakhir, yang mencetak laporan rinci tentang waktu login pengguna terbaru, melakukannya dengan memindai file / var / log / wtmp. </p>\n\n<p><em> Keluaran mencakup detail berikut: </em></p> <pre><code>Username\nTty device number\nLogin date and time\nLogout time\nTotal working time\n</code></pre> <p> Ini juga memiliki opsi untuk mencari login pada waktu tertentu sebagai berikut:\nlast -t YYYYMMDDHHMMSS - Menampilkan status login pada waktu yang ditentukan. </p>\n\n<p> File yang digunakan dalam hal ini adalah:\n/ etc / utmp - Ini adalah file biner yang berisi record untuk setiap baris tty yang aktif.\n/ var / adm / wtmp - Melacak proses masuk dan keluar. </p>","votes":"0","source":"https://superuser.com/a/601723","author":"<a href=\"https://superuser.com/users/108397/j-baron\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">J Baron</span></a>","replies":[{"reply":"Tidak ada file atau folder &#39;aman&#39; di / var / log /. Apakah ini bagian dari logwatch?","author":"<a href=\"https://superuser.com/users/61886/niroshan\" target=\"_blank\" rel=\"nofollow noopener\">Niroshan</a>"},{"reply":"perintah terakhir tidak berfungsi untuk saya - saya menjelaskan skenario saya dalam pertanyaan","author":"<a href=\"https://superuser.com/users/61886/niroshan\" target=\"_blank\" rel=\"nofollow noopener\">Niroshan</a>"},{"reply":"Anda mungkin perlu menginstalnya: sudo apt-get last * Berikut adalah halaman manual untuk itu di Ubuntu: <a href=\"http://manpages.ubuntu.com/manpages/hardy/man1/last.1.html\" rel=\"nofollow noopener\" target=\"_blank\"> manpages.ubuntu.com/manpages/hardy/man1/last.1.html </a>","author":"<a href=\"https://superuser.com/users/108397/j-baron\" target=\"_blank\" rel=\"nofollow noopener\">J Baron</a>"},{"reply":"Data aman mungkin ada di system.log, pesan atau mungkin auth.log. Maaf saya menjalankan Fedora dan ini sedikit berbeda.","author":"<a href=\"https://superuser.com/users/108397/j-baron\" target=\"_blank\" rel=\"nofollow noopener\">J Baron</a>"},{"reply":"Masalah file log Ubuntu: <a href=\"https://help.ubuntu.com/community/LinuxLogFiles\" rel=\"nofollow noopener\" target=\"_blank\"> help.ubuntu.com/community/LinuxLogFiles </a>","author":"<a href=\"https://superuser.com/users/108397/j-baron\" target=\"_blank\" rel=\"nofollow noopener\">J Baron</a>"},{"reply":"perintah terakhir sudah diinstal tetapi tidak menyimpan informasi yang saya butuhkan. Jika pengguna menjalankan terminal (command prompt) maka saya dapat melihat nama pengguna dalam daftar yang dihasilkan oleh perintah terakhir. Jika tidak, nama pengguna tidak ditampilkan dalam daftar. Saya akan mencoba pendekatan lainnya, terima kasih","author":"<a href=\"https://superuser.com/users/61886/niroshan\" target=\"_blank\" rel=\"nofollow noopener\">Niroshan</a>"}]}]}
