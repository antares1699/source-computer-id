{"title":"rsync: Izin ditolak (publickey) dengan SSH","draft":false,"url":"/rsync-izin-ditolak-publickey-dengan-ssh-bvo0oa6v","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["linux","ssh","permissions","rsync","cron"],"snippet":"Saya memiliki server tempat saya terhubung di SSH dengan file kunci saya seperti id_rsa.pub.Saya menggunakan Debian di sisi klien dan server.  Saya mengikuti tutorial untuk menonaktifkan otentikasi root dan penggunaan kata...","body":"<p> Saya memiliki server tempat saya terhubung di SSH dengan file kunci saya seperti <code>id_rsa.pub</code>.\nSaya menggunakan Debian di sisi klien dan server. </p>\n\n<p> Saya mengikuti tutorial untuk menonaktifkan otentikasi root dan penggunaan kata sandi untuk keamanan lebih (dengan mengkonfigurasi file <code>/etc/ssh/sshd/sshd_config</code> di server). </p>\n\n<p> Hingga saat ini, saya dapat dengan mudah menggunakan <code>rsync</code> untuk menyinkronkan file saya dari komputer ke server. </p>\n\n<p> Beberapa hari yang lalu, <a href=\"https://askubuntu.com/questions/1151393/youtube-dl-in-a-crontab-displays-errno-13-permission-denied\" target=\"_blank\" rel=\"nofollow noopener\"> Saya menggunakan pekerjaan cron </a> pekerjaan dan untuk itu saya harus mengatur ulang kata sandi root saya di sisi server. </p>\n\n<p> Sejak itu, tidak mungkin saya menggunakan <code>rsync</code> pada <code>SSH</code>;\nSaya mendapatkan pesan berikut: </p> <pre><code>nextcloud@192.168.0.20: Permission denied (publickey).\nrsync: connection unexpectedly closed (0 bytes received so far)[sender]\nrsync error: unexplained error (code 255) at io.c(235)[sender=3.1.3]\n</code></pre> <p> Ada beberapa topik serupa, tetapi saya pikir kasus saya sedikit berbeda karena menurut saya masalahnya adalah karena mengatur ulang kata sandi saya di server. Saya juga telah mengajukan pertanyaan di situs Ask Ubuntu,\ntapi menurut saya mungkin orang-orang di sini lebih ahli dalam masalah perizinan. </p>\n\n<p> Saya tidak tahu cara memperbaiki masalah (saya mengelola sedikit dalam perintah terminal, tetapi saya bukan ahli komputer). Bisakah kamu membantuku? </p>\n\n<p><em> Untuk Informasi Anda saja, silakan temukan tutorial mengubah <code>/etc/ssh/sshd_config</code> agar tidak menggunakan kata sandi: </em> </p> <pre><code>#Uncomment or add the following line. \n#This allows the server to give its DSA footprint in case of an ssh connection.\nHostKey /etc/ssh/ssh/ssh_host_dsa_key\n\n#Then set the next parameter to 20s (for example). \n#This is the time during which a connection without being logged in will be opened. \n#If we had kept the good old password technique, leave 2 or 3 minutes to type it, it's not too much. \n#But since we're using the key now, we'll be logged in immediately. #So we can really reduce the thing and put it down to 20 seconds for example.\nLoginGraceTime 20s\n\n#this is the maximum number of attempts before being thrown by the server.... \n#Since with the key, no possible error, you can put it to 1 possible test.\nMaxAuthTries 1\n\n#Then, we will tell the SSH server where the keys are and tell it that we will use them as an authentication method\nPubkeyAuthentication yes\nAuthorizedKeysFile.ssh/authorized_keys\n\n#And of course, we'll disable all other authentication methods\nRSAAuthentication no.\nUsePAM no\nKerberosAuthentication no\nGSSAPIA Authentication no.\nPasswordAuthentication no\n\n#Then, we will tell that we only allow users of the sshusers group (for more security)\nAllowGroups sshusers\n\n#The MaxStartups setting indicates the number of un-authenticated ssh connections you can launch at the same time. \n#2 is more than enough, knowing that with the keys, it's instantaneous.\nMaxStartups 2\n</code></pre>","source":"https://superuser.com/questions/1454387/rsync-permission-denied-publickey-with-ssh","author":"<a href=\"https://superuser.com/users/1056333/prog-amateur\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">prog-amateur</span></a>","replies":[{"reply":"Apakah Anda mengubah kata sandi unix atau kata sandi pada kunci Anda?","author":"<a href=\"https://superuser.com/users/137786/davidgo\" target=\"_blank\" rel=\"nofollow noopener\">davidgo</a>"},{"reply":"Ya, saya telah memperbarui kata sandi root server saya dengan <code>sudo passwd root</code>","author":"<a href=\"https://superuser.com/users/1056333/prog-amateur\" target=\"_blank\" rel=\"nofollow noopener\">prog-amateur</a>"},{"reply":"Saya pikir kata sandinya adalah red herring. Kemungkinan besar sesuatu yang telah Anda lakukan (mungkin terkait dengan tugas cron Anda) telah menyebabkan sshd berhenti, atau di-firewall sehingga tidak dapat dijangkau.","author":"<a href=\"https://superuser.com/users/137786/davidgo\" target=\"_blank\" rel=\"nofollow noopener\">davidgo</a>"},{"reply":"@davidgo: terima kasih, jadi menurut Anda ini tidak terkait dengan kata sandi melainkan dengan cronjob? Ini akan menjelaskan mengapa saya dapat terhubung di SSH tetapi tidak mungkin bagi saya untuk mentransfer file. Saya sedang memikirkan masalah izin (tipe chmod), bagaimana menurut Anda? Terima kasih. Terima kasih.","author":"<a href=\"https://superuser.com/users/1056333/prog-amateur\" target=\"_blank\" rel=\"nofollow noopener\">prog-amateur</a>"},{"reply":"bisakah kamu ssh sebagai nextcloud?","author":"<a href=\"https://superuser.com/users/137786/davidgo\" target=\"_blank\" rel=\"nofollow noopener\">davidgo</a>"},{"reply":"Ya, saya bisa ssh ke server saya sebagai nextcloud. Hanya rsync melalui ssh (dari komputer saya ke server saya) tidak berfungsi.","author":"<a href=\"https://superuser.com/users/1056333/prog-amateur\" target=\"_blank\" rel=\"nofollow noopener\">prog-amateur</a>"}],"answers":[{"answer":"<p><a href=\"https://i.stack.imgur.com/hsNG6.jpg\" rel=\"nofollow noopener\" target=\"_blank\"> Oh tidak! </a></p>\n\n<p> Saya baru saja menemukan solusinya ...\nPerintah saya adalah: </p> <pre><code>sudo rsync -avz -e \"ssh -p &lt;port&gt;\" &lt;source&gt; &lt;destination&gt;\n</code></pre> <p> Tetapi saya harus melakukannya dengan sederhana (tanpa <code>sudo</code>): </p> <pre><code>rsync -avz -e \"ssh -p &lt;port&gt;\" &lt;source&gt; &lt;destination&gt;\n</code></pre> <p> Saya tidak yakin tentang penyebabnya, tetapi saya pikir pengguna <code>root</code> komputer desktop saya tidak diizinkan untuk mengakses server saya di SSH karena kuncinya hanya untuk pengguna Desktop <code>classic</code> saya (jadi tanpa sudo). </p>\n\n<p> Adakah yang bisa mengonfirmasi? Terima kasih. </p>","votes":"6","source":"https://superuser.com/a/1454634","author":"<a href=\"https://superuser.com/users/1056333/prog-amateur\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">prog-amateur</span></a>","replies":[{"reply":"Kedengarannya benar. SSH akan, secara default melihat home / .ssh pengguna untuk kunci pribadi. Adakah alasan mengapa tjis perlu dijalankan sebagai root?","author":"<a href=\"https://superuser.com/users/137786/davidgo\" target=\"_blank\" rel=\"nofollow noopener\">davidgo</a>"},{"reply":"Apa yang Anda katakan sangat logis, saya seharusnya memikirkannya .. Saya tidak punya alasan khusus untuk menggunakan hak istimewa <code>sudo</code> untuk transfer file ssh ini. Ini refleks, namun saya biasanya tidak menyalahgunakan <code>sudo</code>. Saya sangat menghargai bantuan yang Anda berikan sampai akhir. Terima kasih banyak @davidgo!","author":"<a href=\"https://superuser.com/users/1056333/prog-amateur\" target=\"_blank\" rel=\"nofollow noopener\">prog-amateur</a>"},{"reply":"<code>Can anyone please confirm?</code> DIKONFIRMASI! Terima kasih, @ prog-amatir! Kamu berhasil! Itu juga saya <i> selama-lamanya </i> untuk mencari tahu apa yang terjadi di sini, karena kunci ssh saya dimuat di ssh-agent saya melalui <code>ssh-add &#47;path&#47;to&#47;priv&#47;key</code> dan saya tidak tahu mengapa itu tidak berfungsi.","author":"<a href=\"https://superuser.com/users/425838/gabriel-staples\" target=\"_blank\" rel=\"nofollow noopener\">Gabriel Staples</a>"},{"reply":"@davidgo, saya perlu menggunakan <code>sudo</code> karena saya juga menyinkronkan beberapa file root yang hanya dapat dibaca oleh root.","author":"<a href=\"https://superuser.com/users/425838/gabriel-staples\" target=\"_blank\" rel=\"nofollow noopener\">Gabriel Staples</a>"},{"reply":"Contoh: <code>&#47;root</code> tidak dapat dibaca oleh siapa pun kecuali root, namun saya ingin mencadangkannya ke drive eksternal yang terhubung ke server jarak jauh, menggunakan <code>rsync</code>. Ini membuat saya bingung: Saya perlu menggunakan <code>sudo</code> untuk mengakses direktori <code>&#47;root</code> , namun saya TIDAK perlu menggunakan <code>sudo</code> karena itu melanggar <code>ssh-agent</code>. Tidak yakin apa yang harus dilakukan untuk menyelesaikan ini ...","author":"<a href=\"https://superuser.com/users/425838/gabriel-staples\" target=\"_blank\" rel=\"nofollow noopener\">Gabriel Staples</a>"}]}]}
