{"title":"Periksa status koneksi OpenVPN secara terus menerus","draft":false,"url":"/periksa-status-koneksi-openvpn-secara-terus-menerus-ajmehw1i","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["linux","vpn","script","openvpn"],"snippet":"Saya mencoba untuk memeriksa dan menampilkan status (terhubung / tidak terhubung) dan nama host server / cn dari koneksi OpenVPN yang  Sebaiknya  terhubung di setiap boot.  Sekarang saya telah menemukan bahwa pada...","body":"<p> Saya mencoba untuk memeriksa dan menampilkan status (terhubung / tidak terhubung) dan nama host server / cn dari koneksi OpenVPN yang <em> Sebaiknya </em> terhubung di setiap boot. </p>\n\n<p> Sekarang saya telah menemukan bahwa pada <code>/var/log/syslog</code> koneksi dicatat, yang dapat saya gunakan untuk menentukan apakah <code>Initialization Sequence Completed</code> telah dicatat dan mendapatkan nama host / cn, 19 baris di atas dari <code>[brimstone] Peer Connection Initiated with [AF_INET]1.2.3.4:1234</code>. </p>\n\n<p> Diambil log ini, saya dapat memeriksa <code>Initialization Sequence Completed</code>, yang berarti saya terhubung dan nama host, yang saya hanya ingin untuk skrip yang berbeda. </p>\n\n<p> Sekarang masalah saya adalah saat ini saya tidak tahu apakah koneksi masih hidup dan / atau apakah saya terhubung ke server lain.\nSaya dapat memeriksa log secara berkala untuk perubahan tetapi tampaknya agak ekstrim untuk tugas yang agak mendasar. </p>\n\n<p> Bagaimana cara memeriksa status koneksi OpenVPN saya dan jika terhubung mendapatkan nama host / cn Server? </p>","source":"https://superuser.com/questions/945928/continuously-check-status-of-openvpn-connection","author":"<a href=\"https://superuser.com/users/438904/apoc\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">apoc</span></a>","replies":[],"answers":[{"answer":"<p> Anda tidak perlu melakukan itu, tetapi Anda masih dapat melakukannya dengan cara memeriksa alamat IP eksternal Anda yang terlihat: perintah berikut </p> <pre><code>   wget 216.146.38.70:80\n</code></pre> <p> queries checkip.dyndns.org untuk IP eksternal Anda. Anda harus dapat mengenali status koneksi Anda dengan cara itu. </p>\n\n<p> Atau, Anda dapat memeriksa tabel perutean Anda: </p> <pre><code>   $ ip route show\n   0.0.0.0/1 via 10.8.0.17 dev tun0 \n   default via 192.168.73.1 dev eth0  proto static \n   10.8.0.0/24 via 10.8.0.17 dev tun0 \n   10.8.0.17 dev tun0  proto kernel  scope link  src 10.8.0.18 \n   128.0.0.0/1 via 10.8.0.17 dev tun0 \n   192.168.73.0/24 dev eth0  proto kernel  scope link  src 192.168.73.74  metric 1 \n   IP.Address.Of.Your.OpenVPN.server via 192.168.73.1 dev eth0 \n</code></pre> <p> (ini untuk OpenVPN yang dirutekan, tetapi ini tidak masalah). Baris penting adalah yang terakhir: jika Anda memiliki yang seperti ini, paket Anda akan dialihkan melalui OpenVPN. </p>\n\n<p> Anda juga dapat menggunakan instrumen seperti <code>mtr</code> yang <code>pings</code> dan <code>traceroutes</code> secara bersamaan (dan terus menerus !!) dengan alamat ip tertentu, misalnya: </p> <pre><code>   mtr www.debian.org\n</code></pre> <p> Jika OpenVPN aktif, Anda akan melihat paket dirutekan melalui terowongan (<code>tun0</code> atau <code>tap0</code>), bukan melalui gateway biasa Anda. </p>\n\n<p> Seperti yang saya katakan di awal, Anda tidak perlu melakukan ini: OpenVPN memberi Anda mekanisme untuk terus memeriksa status koneksi, dan untuk memulai ulang jika perlu: </p>\n\n<blockquote>\n  <p> --keepalive n m </p>\n  \n  <p> Arahan helper yang dirancang untuk menyederhanakan ekspresi --ping dan --ping-restart dalam konfigurasi mode server.\n  Misalnya, --keepalive 10 60 diperluas sebagai berikut: </p>\n</blockquote> <pre><code> if mode server:\n   ping 10\n   ping-restart 120\n   push \"ping 10\"\n   push \"ping-restart 60\"\n else\n   ping 10\n   ping-restart 60\n</code></pre> <p> Anda dapat menggunakan <code>keepalive</code> atau kombinasi yang sesuai dari <code>ping</code>, <code>ping-restart</code>, <code>ping-exit</code>, untuk mengontrol status koneksi secara otomatis. </p>","votes":"5","source":"https://superuser.com/a/945971","author":"<a href=\"https://superuser.com/users/255732/mariusmatutiae\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">MariusMatutiae</span></a>","replies":[]},{"answer":"<p> Anda mungkin bisa menggunakan kombinasi openvpn: </p>\n\n<p> atas, bawah, uprestart dan ping-restart </p>\n\n<p> file config (atau baris perintah yang sesuai)? </p>","votes":"1","source":"https://superuser.com/a/945966","author":"<a href=\"https://superuser.com/users/569897/tim-small\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Tim Small</span></a>","replies":[]},{"answer":"<p> Seperti yang ditunjukkan pengguna lain,\nip rute acara\ncontoh keluaran dari vpn yang terhubung:\n0.0.0.0/1 melalui 192.121.241.129 dev tun0\ndefault melalui 192.168.0.1 dev eth0\n128.0.0.0/1 melalui 192.121.245.129 dev tun0\n192.121.241.5 melalui 192.168.0.1 dev eth0 </p>\n\n<p> Itu membaca NAT terowongan masuk (Network Address Translating) ke subnet lokal yaitu 192.168\nTerowongan keluar melalui NAT yang sama\nItu indikasi VPN yang cukup kuat selama 192.121.241 tidak dapat dilacak kembali ke ISP Anda. VPN saya ada di kota yang sama, tetapi ketika saya mencarinya, dikatakan bahwa itu adalah ISP lain; ISP di belakang VPN saya untuk server VPN itu. </p>\n\n<p> Cara lain, cari saja alamat IP Anda, dan lihat ISP mana yang terkait dengannya. Jika milik Anda, vpn Anda tidak terhubung. Jika ada hal lain yang kemungkinan besar VPN Anda terhubung. </p>","votes":"0","source":"https://superuser.com/a/1489805","author":"<a href=\"https://superuser.com/users/1098412/user1098412\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">user1098412</span></a>","replies":[]}]}
