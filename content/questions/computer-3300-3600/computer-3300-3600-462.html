{"title":"file terkunci pada partisi rumah HFS + yang dibagikan antara OSX / Linux","draft":false,"url":"/file-terkunci-pada-partisi-rumah-hfs-yang-dibagikan-antara-osx-linux-gtqwkfbn","votes":"4","answers_count":"4","categories":["Komputer"],"tags":["linux","macos","file-permissions","hfs"],"snippet":"Saya melakukan boot ganda ke Arch Linux dan OS X 10.6 di MacBook pro saya. Saya menyinkronkan UID saya antara kedua OS dan membuat partisi HFS (tanpa penjurnalan) untuk digunakan sebagai partisi...","body":"<p> Saya melakukan boot ganda ke Arch Linux dan OS X 10.6 di MacBook pro saya. Saya menyinkronkan UID saya antara kedua OS dan membuat partisi HFS (tanpa penjurnalan) untuk digunakan sebagai partisi rumah / Pengguna bersama. Sebagian besar berfungsi seperti yang saya harapkan, tetapi terkadang ketika saya boot ke OS X file tertentu &quot;terkunci&quot; (ketika saya mendapatkan info tentang file tertentu, kotak &quot;Terkunci&quot; dicentang di bawah &quot;Umum&quot; panel. Saya dapat menyelesaikan masalah dengan menghapus centang pada kotak secara manual) dan / atau saya mendapatkan &quot;Operasi tidak diizinkan&quot; saat mencoba menghapus atau mengubah file. Dalam kedua kasus saya tidak melihat sesuatu yang luar biasa pada bit izin yang ditampilkan dengan ls -l, kecuali untuk karakter &#39;@&#39; di posisi di mana bit lengket biasanya akan terjadi: </p> <pre><code>-rw-r--r--@  1 myuser  mygroup   296 Mar 29 11:44 myfile\n</code></pre> <p> Karakter &#39;@&#39; ini muncul di SEMUA file normal, jadi sepertinya tidak terkait dengan situasi terkunci / operasi bukan izin. </p>\n\n<p> Di sisi Linux, saya tidak pernah memiliki masalah izin. Sejauh pengetahuan dan pengalaman saya yang terbatas dengan ACL, saya belum menemukan ACL apa pun pada file yang dipermasalahkan. </p>\n\n<p> Untuk apa nilainya, saya melakukan sebagian besar pengeditan file saya menggunakan emacs (Aquamacs di OSX), apakah mungkin menyetel bit izin yang aneh? </p>\n\n<ol>\n<li> Apa itu pengaturan &quot;terkunci&quot; yang digunakan OS X dan apakah itu memiliki izin yang setara (jadi setidaknya saya dapat membuka kunci semua file secara rekursif di direktori home saya dari terminal) </li>\n<li> mengapa beberapa, tetapi tidak file lain menjadi &quot;terkunci&quot; saat boot ke OS X. </li>\n<li> apa arti karakter &#39;@&#39;? </li>\n</ol>","source":"https://superuser.com/questions/284782/locked-files-on-hfs-home-partition-shared-between-osx-linux","author":"<a href=\"https://superuser.com/users/41599/hazybluedot\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">HazyBlueDot</span></a>","replies":[{"reply":"pembaruan cepat, saya baru saja menemukan perintah &quot;chflags&quot; dan bahwa item &quot;terkunci&quot; sama dengan menyetel / menghapus tanda uchange, jadi saya dapat menggunakannya untuk membuka kunci file saya secara rekursif, tetapi saya masih penasaran bagaimana / mengapa mereka terkunci sejak awal.","author":"<a href=\"https://superuser.com/users/41599/hazybluedot\" target=\"_blank\" rel=\"nofollow noopener\">HazyBlueDot</a>"},{"reply":"Mempertimbangkan <a href=\"http://developer.apple.com/library/ios/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemDetails/FileSystemDetails.html\" rel=\"nofollow noopener\" target=\"_blank\"> menonaktifkan izin untuk volume </a> : &quot;Selain itu, OS X memungkinkan pengguna admin untuk menonaktifkan kepemilikan dan pemeriksaan izin untuk volume yang dapat dilepas per volume dengan memilih Dapatkan Info tentang volume di Finder, lalu centang kotak&quot; Abaikan kepemilikan pada volume ini &quot;.&quot; (dari dokumentasi Apple)","author":"<a href=\"https://superuser.com/users/145508/ignis\" target=\"_blank\" rel=\"nofollow noopener\">ignis</a>"}],"answers":[{"answer":"<p> Saya juga mengalami masalah yang sama. </p>\n\n<p> Pemahaman saya dari informasi yang saya baca di sini, dan di tempat lain, adalah bahwa itu adalah bug kernel linux di modul hfsplus. Itu menambahkan bendera pengguna acak ke file. Ada dua tanda yang mencegah pengeditan / penghapusan file: uchg dan uappnd. Ini adalah dua orang jahat. Mereka dapat diterapkan ke file atau bahkan ke direktori induk. </p>\n\n<p> Bendera ditampilkan dengan: </p>\n\n<blockquote>\n  <p> $ ls -laO / Volume / volume-saya </p>\n</blockquote>\n\n<p> Bendera dapat dihapus secara rekursif dengan: </p>\n\n<blockquote>\n  <p> $ man chflags </p>\n  \n  <p> $ chflags -R nouchg, nouappnd, noopaque, dump / Volumes / my-volume </p>\n</blockquote>\n\n<p> CATATAN: Saya juga menghapus bendera buram dan nodump. Saya tidak membutuhkan bendera. </p>","votes":"5","source":"https://superuser.com/a/477951","author":"<a href=\"https://superuser.com/users/160635/oluc\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">oluc</span></a>","replies":[{"reply":"Resep yang bagus - bantu saya!","author":"<a href=\"https://superuser.com/users/74984/akauppi\" target=\"_blank\" rel=\"nofollow noopener\">akauppi</a>"}]},{"answer":"<p> <code>@</code> berarti bahwa file tersebut memiliki &quot;atribut tambahan&quot; (metadata tambahan, disingkat &quot;xattrs&quot;) yang dilampirkan di sistem file. Untuk melihat daftar xattr yang dilampirkan ke file, lakukan <code>ls -l@</code> di Mac OS X. </p>\n\n<p> Classic Mac OS memiliki konsep &quot;Finder Info&quot; yang merupakan kumpulan metadata kecil yang tetap (tidak dapat diperluas) yang dimiliki semua file pada volume HFS. Ini termasuk &quot;kode tipe dan pembuat&quot;, dan &quot;tanda Finder&quot;, termasuk bit &quot;terkunci&quot;, bit &quot;terlihat&quot; (tersembunyi), dan beberapa lainnya. Mac OS X pada dasarnya telah menghentikan meta-data Finder yang lama, tetapi jika masih diperlukan, sekarang ia akan dilampirkan ke catatan file di sistem file sebagai xattr. File terkunci yang Anda lihat hampir pasti memiliki info xattr Finder yang dilampirkan, sehingga status bit &quot;terkunci&quot; Finder lama dapat direkam. </p>\n\n<p> Sistem Snow Leopard saya memiliki perintah <code>/usr/bin/xattr</code> yang tampaknya tidak memiliki halaman manual, tetapi memiliki pernyataan penggunaan jika Anda memanggilnya dengan <code>-h</code>. Perhatikan bahwa <code>xattr -l filename</code> dapat berguna untuk mendapatkan hex / ASCII dump dari nilai xattr yang terpasang ke file. </p>\n\n<p> Perintah bawaan Mac OS X untuk melihat dan memanipulasi info xattr Finder lama dari terminal termasuk <code>GetFileInfo(1)</code> dan <code>SetFile(1)</code>. </p>\n\n<p><strong> Memperbarui: </strong><br> Saya tidak memiliki penjelasan yang baik mengapa file-file itu dikunci, tetapi firasat saya adalah bahwa perangkat lunak pendukung HFS apa pun yang Anda jalankan di Linux salah memahami tujuannya, dan status yang tidak berlaku lagi, dari bit kunci Finder lama dan mengaturnya kapan seharusnya tidak, atau sengaja menggunakan bit kunci sebagai mekanisme untuk memetakan semacam konsep semantik sistem file Linux ke HFS. </p>\n\n<p> Bit kunci Finder dimaksudkan sebagai cara bagi pengguna untuk mengunci file mereka sendiri secara manual sehingga mereka tidak sengaja mengubah atau menghapusnya, dan <em> tidak </em> dimaksudkan sebagai mekanisme penguncian file tingkat proses untuk menghindari beberapa proses menulis ke file yang sama pada waktu yang sama. Artinya, ini tidak seharusnya menjadi pengganti untuk <code>fcntl(2)</code> atau <code>flock(2)</code>. Pada saat bit kunci Finder dirancang, Mac bukanlah sistem multiprosesing. </p>\n\n<p><strong> Perbarui 2: </strong> Bisa juga Aquamacs menyalahgunakan bit kunci Finder lama untuk melaksanakan keinginan penguncian file emacs. </p>","votes":"3","source":"https://superuser.com/a/284846","author":"<a href=\"https://superuser.com/users/30792/spiff\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Spiff</span></a>","replies":[]},{"answer":"<p> Saya telah menemukan solusi. Tampaknya ada kondisi balapan dalam modul kernel hfsplus, yang disebabkan oleh akses non atomic ke bendera pengguna. Saya telah menonaktifkannya dan bendera pengguna akan pernah nol, tidak terkunci, oke untuk saya. </p>\n\n<p> fs / hfsplus / inode.c dekat baris 248: </p> <pre><code>    inode-&gt;i_mode = mode;\n\n/* FIXME commented out because of unreliable results, needs mutex_lock (?) */\n//    HFSPLUS_I(inode)-&gt;userflags = perms-&gt;userflags;\n    if (perms-&gt;rootflags &amp; HFSPLUS_FLG_IMMUTABLE)\n</code></pre> <p> fs / hfsplus / catalog.c dekat baris 79: </p> <pre><code>            perms-&gt;rootflags &amp;= ~HFSPLUS_FLG_APPEND;\n\n/* FIXME commented out because of unreliable results, needs mutex_lock (?) */\n//    perms-&gt;userflags = HFSPLUS_I(inode)-&gt;userflags;\n    perms-&gt;mode = cpu_to_be16(inode-&gt;i_mode);\n</code></pre> <p> Anda dapat membuat kernel khusus, tetapi saya menggunakan dkms: </p> <pre><code>$ cd /usr/src\n$ tar xjpvf linux-source-*.tar.bz2 linux-source-*/fs/hfsplus\n$ cp -R linux-source-*/fs/hfsplus hfsplus-YOUR_VERSION\n$ vi hfsplus-YOUR_VERSION/inode.c\n$ vi hfsplus-YOUR_VERSION/catalog.c\n$ vi hfsplus-YOUR_VERSION/dkms.conf (see below for the content)\n$ su\n# dkms install hfsplus/YOUR_VERSION\n</code></pre> <p> /usr/src/hfsplus-YOUR_VERSION/dkms.conf: </p> <pre><code>NAME=hfsplus\nVERSION=YOUR_VERSION\nPACKAGE_NAME=\"$NAME\"\nPACKAGE_VERSION=\"$VERSION\"\nMAKE[0]=\"make -C ${kernel_source_dir}\n  SUBDIRS=${dkms_tree}/${NAME}/${VERSION}/build modules\"\nBUILT_MODULE_NAME[0]=\"hfsplus\"\nDEST_MODULE_LOCATION[0]=\"/kernel/fs/hfsplus\"\nREMAKE_INITRD=y\nAUTOINSTALL=\"yes\"\n</code></pre> <p><strong> Catatan: Instalasi gagal untuk saya, jika saya tidak melakukan cd ke / usr / src. </strong></p>\n\n<p> Untuk mencopot pemasangan: </p> <pre><code># dkms remove hfsplus/YOUR_VERSION --all\n</code></pre> <p> Lingkungan: MacBookPro7,1, Core 2 Duo, SATA NVidia MCP89 AHCI, Mac OS X 10.6, Debian GNU / Linux, Kernel 2.6.28, 2.6.29, 3.0, 3.1, 3.2. </p>","votes":"3","source":"https://superuser.com/a/457494","author":"<a href=\"https://superuser.com/users/150302/frank-ganske\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Frank Ganske</span></a>","replies":[{"reply":"Apakah Anda pernah melaporkan hal ini di bagian hulu? Saya pikir saya mengalami masalah yang sama.","author":"<a href=\"https://superuser.com/users/46794/blaisorblade\" target=\"_blank\" rel=\"nofollow noopener\">Blaisorblade</a>"},{"reply":"Pembaruan: bug diperbaiki di Linux 3.4. Perbaikan yang benar ada di sini: <a href=\"http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=f3922382ce930e76773fb06416a7a6081a8702ad\" rel=\"nofollow noopener\" target=\"_blank\"> git.kernel.org/?p=linux/kernel/git/torvalds/â€¦ </a>","author":"<a href=\"https://superuser.com/users/46794/blaisorblade\" target=\"_blank\" rel=\"nofollow noopener\">Blaisorblade</a>"},{"reply":"Wow, tambalan korektif pertama yang saya lihat sebagai jawaban SO / SU. Pujian.","author":"<a href=\"https://superuser.com/users/74984/akauppi\" target=\"_blank\" rel=\"nofollow noopener\">akauppi</a>"},{"reply":"@FrankGanske: Hanya untuk memperjelas: perbaikan &quot;berfungsi&quot;, tetapi berbeda dari yang resmi dan mungkin memiliki kelemahan (saya kira itu akan mencegah perubahan <code>userflags</code> dengan sengaja, seperti yang diakui jawabannya).","author":"<a href=\"https://superuser.com/users/46794/blaisorblade\" target=\"_blank\" rel=\"nofollow noopener\">Blaisorblade</a>"}]},{"answer":"<p> Ini adalah bug kernel Linux, diperbaiki di 3.4 ( <a href=\"http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commit;h=f3922382ce930e76773fb06416a7a6081a8702ad\" rel=\"nofollow noopener\" target=\"_blank\"> tambalan </a> ). </p>\n\n<p> Saya memiliki masalah yang sama menggunakan utilitas Unix murni. Yaitu, saya telah mencadangkan hard drive Mac OS X saya dari Xubuntu 12.04 langsung menggunakan rsync. Setelah pemulihan, banyak folder terkunci secara acak, termasuk direktori di repositori git (dan saya sangat ragu git akan melakukannya). Anda dapat melihat attrib tersebut dengan <code>ls -lO</code>. Melakukan itu di cadangan saya menunjukkan bahwa bit-bit ini pada dasarnya memiliki nilai acak: </p> <pre><code># ls -ldO /Volumes/HFS+Backup/Users/pgiarrusso/*\ndrwx------   31 pgiarrusso  staff  uchg,nodump,opaque         1054 Aug 13 02:00 /Volumes/HFS+Backup/Users/pgiarrusso/Desktop\ndrwx------   36 pgiarrusso  staff  nodump                     1224 Jul 22 16:04 /Volumes/HFS+Backup/Users/pgiarrusso/Documents\ndrwx------  108 pgiarrusso  staff  uappnd                     3672 Aug 13 11:43 /Volumes/HFS+Backup/Users/pgiarrusso/Downloads\ndrwx------   13 pgiarrusso  staff  uappnd,uchg,opaque          442 Jul 22 05:04 /Volumes/HFS+Backup/Users/pgiarrusso/Dropbox\ndrwx------   53 pgiarrusso  staff  -                          1802 Aug 12 00:58 /Volumes/HFS+Backup/Users/pgiarrusso/Library\ndrwx------   11 pgiarrusso  staff  uchg,nodump,opaque          374 Jul 22 17:25 /Volumes/HFS+Backup/Users/pgiarrusso/Movies\ndrwx------   13 pgiarrusso  staff  uappnd,uchg,nodump          442 Jun 10 12:05 /Volumes/HFS+Backup/Users/pgiarrusso/Music\ndrwx------   15 pgiarrusso  staff  uappnd,nodump,opaque        510 Jun 10 12:05 /Volumes/HFS+Backup/Users/pgiarrusso/Pictures\ndrwxr-x---   11 pgiarrusso  staff  opaque                      374 Jul  6 15:33 /Volumes/HFS+Backup/Users/pgiarrusso/Public\ndrwxr-xr-x   34 pgiarrusso  staff  uappnd,uchg,opaque         1156 May 27 12:39 /Volumes/HFS+Backup/Users/pgiarrusso/Sites\ndrwxr-xr-x    2 pgiarrusso  staff  uappnd,nodump,opaque         68 Jun 10 21:43 /Volumes/HFS+Backup/Users/pgiarrusso/VirtualBox VMs\n-rwxr-xr-x    1 pgiarrusso  staff  uappnd,nodump,opaque       1703 Feb 19  2012 /Volumes/HFS+Backup/Users/pgiarrusso/bash-prompt.sh\ndrwxr-xr-x   22 pgiarrusso  staff  -                           748 Aug 10 19:47 /Volumes/HFS+Backup/Users/pgiarrusso/bin\nlrwxrwxrwx    1 pgiarrusso  staff  nodump,opaque                37 Sep 27  2011 /Volumes/HFS+Backup/Users/pgiarrusso/default.sfx -&gt; /Users/pgiarrusso/opt/rar/default.sfx\n-rw-r--r--    1 pgiarrusso  staff  uappnd,uchg          1375563169 Aug  2 18:52 /Volumes/HFS+Backup/Users/pgiarrusso/heapdump-1343925310626.hprof\ndrwxr-xr-x   22 pgiarrusso  staff  uappnd,nodump               748 Aug  1 22:15 /Volumes/HFS+Backup/Users/pgiarrusso/opt\ndrwxr-xr-x    7 pgiarrusso  staff  uappnd                      238 Apr 19 20:00 /Volumes/HFS+Backup/Users/pgiarrusso/share\ndrwxr-xr-x   35 pgiarrusso  staff  nodump,opaque              1190 Aug 10 00:06 /Volumes/HFS+Backup/Users/pgiarrusso/tmp\n</code></pre> <p> Saya telah membandingkan ini dengan direktori yang sama pada sistem file yang berfungsi, dan bit-bit itu tidak disetel. </p>","votes":"1","source":"https://superuser.com/a/472002","author":"<a href=\"https://superuser.com/users/46794/blaisorblade\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Blaisorblade</span></a>","replies":[]}]}
