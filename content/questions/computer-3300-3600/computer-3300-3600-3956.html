{"title":"Bagaimana cara mengedit header file CSV yang besar di tempat?","draft":false,"url":"/bagaimana-cara-mengedit-header-file-csv-yang-besar-di-tempat-xmnntzl4","votes":"4","answers_count":"4","categories":["Komputer"],"tags":["unix","csv","perl"],"snippet":"Saya memiliki beberapa file CSV besar di mana saya ingin menukar dua nama kolom.  Saya lakukan  tidak  ingin  ubah / salin / tulis ulang  data.  Operasi ini sangat murah di file C:...","body":"<p> Saya memiliki beberapa file CSV besar di mana saya ingin menukar dua nama kolom. </p>\n\n<p> Saya lakukan <strong> tidak </strong> ingin <em> ubah / salin / tulis ulang </em> data. </p>\n\n<p> Operasi ini sangat murah di file <code>C</code>: <code>fopen</code>, header <code>fgets</code>, <code>fseek</code> atau <code>rewind</code>, memanipulasi header ( <em> mempertahankan panjangnya </em> ), <code>fputs</code> header baru, <code>fclose</code> file. </p>\n\n<p> Ini juga dapat dilakukan pada <code>ANSI Common Lisp</code> ( <a href=\"http://clisp.org\" rel=\"nofollow noopener\" target=\"_blank\"> CLISP </a> , <a href=\"http://sbcl.org\" rel=\"nofollow noopener\" target=\"_blank\"> SBCL </a> atau <a href=\"http://www.gnu.org/software/gcl/\" rel=\"nofollow noopener\" target=\"_blank\"> GCL </a> ): </p> <pre><code> (with-open-file (csv \"foo.csv\" :direction :io\n                      :if-exists :overwrite)\n   (let ((header (read-line csv)))\n     (print header)\n     (file-position csv 0)\n     (write-line (string-upcase header) csv)\n     (file-position csv 0)\n     (read-line csv)))\n</code></pre> <p> dan mengambil <em> sepersekian detik </em> (<code>sed</code> membutuhkan <em> beberapa menit </em> karena ia membaca dan menulis ulang seluruh file meskipun Anda menyuruhnya memodifikasi hanya baris pertama, mengabaikan informasi penting yang dilakukan oleh ukuran tajuk <em> tidak </em> perubahan). </p>\n\n<p> Bagaimana cara melakukannya dengan &quot;alat unix standar&quot; (mis., <code>perl</code>)? </p>","source":"https://superuser.com/questions/520663/how-to-edit-the-header-of-a-huge-csv-file-in-place","author":"<a href=\"https://superuser.com/users/98857/sds\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">sds</span></a>","replies":[],"answers":[{"answer":"<p> Jika Anda tidak mengetahui panjang header, <code>head -n1</code> sepertinya cara yang masuk akal untuk mendapatkan baris pertama. </p>\n\n<p> Untuk menuliskannya di tempat kembali ke kepala file, Anda dapat menggunakan dd: </p> <pre><code>head -n1 file.csv | ./do-some-processing | dd of=file.csv bs=1 conv=notrunc\n</code></pre> <p> <code>conv=notrunc</code> sangat penting untuk membiarkan sisa file tetap utuh, dan <code>bs=1</code> harus berhenti pada batas byte. </p>","votes":"5","source":"https://superuser.com/a/521074","author":"<a href=\"https://superuser.com/users/28621/b0fh\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">b0fh</span></a>","replies":[{"reply":"Bagus, saya tidak pernah tahu tentang notrunc. Tetapi perhatikan bahwa ./do-some-processing harus mempertahankan panjang header (seperti yang ditentukan oleh OP.) Hanya peringatan untuk tl; dr folks (seperti saya :)","author":"<a href=\"https://superuser.com/users/98689/owen\" target=\"_blank\" rel=\"nofollow noopener\">Owen</a>"}]},{"answer":"<p> Saya akan menyarankan <code>sed</code> untuk ini, Anda dapat menentukan untuk hanya melakukan substitusi pada baris pertama seperti <code>1s/foo/bar/</code>: </p> <pre><code>$ cat file\ncol1,col2,col3\n1,2,3\n3,2,1\n...\n\n$ sed -e '1s/col1/tmp/' -e '1s/col3/col1/'  -e '1s/tmp/col3/' file\ncol3,col2,col1\n1,2,3\n3,2,1\n...\n</code></pre> <p> Gunakan <code>-i</code> untuk menyimpan perubahan kembali ke file: </p> <pre><code>$ sed -i -e '1s/col1/tmp/' -e '1s/col3/col1/'  -e '1s/tmp/col3/' file\n</code></pre>","votes":"2","source":"https://superuser.com/a/520706","author":"<a href=\"https://superuser.com/users/106954/iiseymour\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">iiSeymour</span></a>","replies":[{"reply":"Ini memang mengubah file sesuai kebutuhan, tetapi ini menulis ulang data, yaitu <code>time</code> menunjukkan bahwa perintah <code>sed</code> membutuhkan waktu yang hampir sama (beberapa menit) dengan <code>cp</code>.","author":"<a href=\"https://superuser.com/users/98857/sds\" target=\"_blank\" rel=\"nofollow noopener\">sds</a>"}]},{"answer":"<p> Jika yang Anda inginkan hanyalah menukar dua kata, maka yang Anda butuhkan hanyalah menulis ulang beberapa byte di tempat. </p>\n\n<p> Ini adalah tugas yang mudah untuk editor heksadesimal baris perintah. </p>\n\n<p> Saya akan merekomendasikan <code>hexedit</code> yang baru saja saya gunakan untuk mengedit file 30 Gb <code>.csv</code>. Waktu yang dihabiskan untuk membuka / menyimpan file dapat diabaikan (kurang dari satu detik). Bahkan, sebagian besar waktu saya dihabiskan untuk mencari-cari <a href=\"http://rigaux.org/hexedit.html\" rel=\"nofollow noopener\" target=\"_blank\"> pintasan keyboard </a> ... (<code>TAB</code> untuk beralih ke tampilan ASCII, <code>Ctrl-X</code> untuk menyimpan dan keluar). </p>","votes":"0","source":"https://superuser.com/a/1221867","author":"<a href=\"https://superuser.com/users/415251/jealie\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Jealie</span></a>","replies":[{"reply":"Idenya adalah untuk menggunakan proses batch, bukan interaktif.","author":"<a href=\"https://superuser.com/users/98857/sds\" target=\"_blank\" rel=\"nofollow noopener\">sds</a>"}]},{"answer":"<p> Atau mungkin &quot;arahkan&quot; file untuk menghapus baris pertama ke file terpisah. </p>\n\n<p> Kemudian ubah file heading dan gabungkan keduanya kembali. </p>","votes":"-1","source":"https://superuser.com/a/520676","author":"<a href=\"https://superuser.com/users/134506/julian-knight\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Julian Knight</span></a>","replies":[{"reply":"ini menyalin data, yaitu waktu yang dihabiskan sebanding dengan ukuran data.","author":"<a href=\"https://superuser.com/users/98857/sds\" target=\"_blank\" rel=\"nofollow noopener\">sds</a>"},{"reply":"Jadi mengapa menandai ini dan menerima jawaban yang sama di atas?","author":"<a href=\"https://superuser.com/users/134506/julian-knight\" target=\"_blank\" rel=\"nofollow noopener\">Julian Knight</a>"},{"reply":"karena jawaban di atas konstan dalam waktu dan jawaban ini tidak","author":"<a href=\"https://superuser.com/users/98857/sds\" target=\"_blank\" rel=\"nofollow noopener\">sds</a>"},{"reply":"Sejujurnya, Anda tidak menjelaskan cara menggabungkan file. Menggunakan <code>dd</code> adalah wawasan non-sepele.","author":"<a href=\"https://superuser.com/users/28621/b0fh\" target=\"_blank\" rel=\"nofollow noopener\">b0fh</a>"}]}]}
