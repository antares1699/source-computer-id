{"title":"ZFS Tingkatkan 2 drive cermin menjadi 3 drive raidz?","draft":false,"url":"/zfs-tingkatkan-2-drive-cermin-menjadi-3-drive-raidz-pnrt7peu","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["debian","zfs"],"snippet":"Saya memiliki dua drive 1GB yang dikonfigurasi sebagai mirror ZFS dan sekarang memiliki kemungkinan untuk menambahkan drive ke-3 sebesar 1GB. Dapatkah saya mengkonfigurasi ulang mirror saya menjadi 3 drive raidz (N-1) =...","body":"<p> Saya memiliki dua drive 1GB yang dikonfigurasi sebagai mirror ZFS dan sekarang memiliki kemungkinan untuk menambahkan drive ke-3 sebesar 1GB. Dapatkah saya mengkonfigurasi ulang mirror saya menjadi 3 drive raidz (N-1) = kapasitas total 2GB? </p>\n\n<p> Saya menjalankan zfs-fuse pada Debian Jessie </p>","source":"https://superuser.com/questions/913551/zfs-upgrade-2-mirrored-drives-to-3-drive-raidz","author":"<a href=\"https://superuser.com/users/447141/arne\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Arne</span></a>","replies":[],"answers":[{"answer":"<p> Jawaban singkatnya adalah tidak, Anda tidak dapat mengubahnya. Anda harus mencadangkan, menghancurkan cermin, membuat raidz, dan memulihkan sistem file dari cadangan. </p>\n\n<p> ZFS mendukung penambahan drive ke pool tanpa mengganggu data asli tetapi Anda tidak dapat mengubah konfigurasi (mirror, raidz, dll.) Dari drive yang ada di pool. </p>\n\n<p> Dalam kasus Anda, Anda dapat (meskipun saya tidak merekomendasikannya) menambahkan drive ketiga ke kumpulan Anda yang ada dan ruang ekstra akan tersedia untuk semua sistem file ZFS di kumpulan <em> tetapi Anda tidak akan memiliki redundansi di seluruh pool. </em></p>\n\n<p> Anda bisa menambahkan <em> dua drive sebagai cermin lain </em> ke kolam yang sama dan kemudian Anda akan memiliki ruang tambahan dengan redundansi cermin di seluruh kolam. </p>\n\n<p> Saya telah menjalankan raidz (digunakan di rumah, bukan produksi) di masa lalu, tetapi sekarang saya lebih suka mirror karena kesederhanaan dan kinerjanya (terutama pada scrub), meskipun kapasitas yang dapat digunakan lebih rendah. </p>","votes":"2","source":"https://superuser.com/a/913620","author":"<a href=\"https://superuser.com/users/20444/mike-fitzpatrick\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Mike Fitzpatrick</span></a>","replies":[{"reply":"mengingat bahwa dua drive yang ada berada di ruang USB 3.0 eksternal dan potensi drive ketiga ada di port SATA internal, apakah mencerminkan kinerja bantuan ke-3?","author":"<a href=\"https://superuser.com/users/447141/arne\" target=\"_blank\" rel=\"nofollow noopener\">Arne</a>"},{"reply":"Anda mungkin melihat peningkatan hanya dengan menambahkan drive ketiga karena ZFS dapat memisahkan antara mirror dan drive tunggal tetapi pool Anda tidak lagi berlebihan. Jika Anda menambahkan drive ke-4, Anda kemudian dapat memiliki garis cermin yang memiliki kinerja garis tetapi dengan redundansi. Kinerja ZFS bergantung pada kombinasi dari banyak hal, termasuk pengaturan kumpulan Anda dan pola penggunaan disk Anda sendiri. Performa baca juga bisa berbeda dari performa tulis.","author":"<a href=\"https://superuser.com/users/20444/mike-fitzpatrick\" target=\"_blank\" rel=\"nofollow noopener\">Mike Fitzpatrick</a>"},{"reply":"Mungkin saya kurang memahami pencerminan ZFS dengan benar; ketika saya memiliki 3 drive dengan kapasitas 1TB (dua eksternal, satu internal) dan ketiganya adalah mirror di kolam - apakah saya kehilangan redundansi (!)? Saya berharap penyiapannya menjadi lebih aman ... bisakah Anda menjelaskannya?","author":"<a href=\"https://superuser.com/users/447141/arne\" target=\"_blank\" rel=\"nofollow noopener\">Arne</a>"},{"reply":"Nah, Anda secara teoritis dapat mencerminkan ketiga drive, memberi Anda kapasitas yang dapat digunakan 1TB dengan redundansi tiga kali lipat tetapi saya berasumsi Anda ingin meningkatkan kapasitas kumpulan Anda dengan menambahkan drive ketiga. Menambahkan drive ketiga sebagai cermin rangkap tiga akan meningkatkan redundansi Anda tetapi tidak kapasitas Anda. Jika Anda ingin meningkatkan kapasitas dan menggunakan raidz untuk redundansi, Anda hanya dapat mencapainya dengan menghancurkan kumpulan Anda saat ini dan membuat kumpulan baru dengan raidz vdev dan memulihkan data Anda dari cadangan.","author":"<a href=\"https://superuser.com/users/20444/mike-fitzpatrick\" target=\"_blank\" rel=\"nofollow noopener\">Mike Fitzpatrick</a>"},{"reply":"Baiklah, begitulah cara saya memahaminya. 3 drive @ 1TB dicerminkan = 1TB kapasitas total dengan kelebihan redundansi dan kemungkinan kinerja baca karena drive ke-3 berada pada pengontrol terpisah.","author":"<a href=\"https://superuser.com/users/447141/arne\" target=\"_blank\" rel=\"nofollow noopener\">Arne</a>"}]},{"answer":"<p> Saya akan melakukan ini dan menemukan blog lama yang menunjukkan bahwa hal itu dapat dilakukan. </p>\n\n<p><strong> Perhatian: proses ini membuat serangan dalam keadaan terdegradasi saat bermigrasi. Ini secara signifikan meningkatkan kemungkinan kehilangan data! </strong></p>\n\n<p> Idenya adalah untuk: </p>\n\n<ol>\n<li> Hancurkan cermin yang ada dengan menghapus salah satu disk yang ada </li>\n<li> Buat file renggang dan pasang sebagai perangkat loopback </li>\n<li> Buat Raid-Z1 baru menggunakan disk baru, yang baru saja dihapus dan file jarang </li>\n<li> Segera tingkatkan serangan dengan menghapus perangkat file jarang </li>\n<li> salin semua data dari mirror yang terdegradasi ke raid-z1 yang terdegradasi </li>\n<li> hancurkan cermin dan tambahkan disk ke dalam raid-z1 dan biarkan tangguh. </li>\n</ol>\n\n<p> Memang saya akan melakukan ini di SmartOS daripada Linux, tetapi saya berasumsi Linux ZFS cukup maju untuk melakukan ini. </p>\n\n<p> Info lebih lanjut tentang pendekatan ini dapat ditemukan di <a href=\"https://blogs.oracle.com/zhangfan/entry/how_to_turn_a_mirror\" rel=\"nofollow noopener\" target=\"_blank\"> https://blogs.oracle.com/zhangfan/entry/how_to_turn_a_mirror </a></p>","votes":"7","source":"https://superuser.com/a/970995","author":"<a href=\"https://superuser.com/users/495637/gareth\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Gareth</span></a>","replies":[]}]}
