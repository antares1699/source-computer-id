{"title":"Bagaimana Sebenarnya Windows Menangani Asosiasi File?","draft":false,"url":"/bagaimana-sebenarnya-windows-menangani-asosiasi-file-vi7bwvpe","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["windows","file-association"],"snippet":"Saya punya masalah dengan asosiasi file. Aplikasi C # saya dapat mengatur asosiasi file untuk ekstensinya sendiri sehingga pengguna mengklik dua kali file proyek yang digunakannya akan membuka aplikasi saya dan memuat...","body":"<p> Saya punya masalah dengan asosiasi file. Aplikasi C # saya dapat mengatur asosiasi file untuk ekstensinya sendiri sehingga pengguna mengklik dua kali file proyek yang digunakannya akan membuka aplikasi saya dan memuat file. </p>\n\n<p> Ini menyebabkan masalah dengan dua komponen pihak ketiga. Masing-masing menggunakan lisensi. </p>\n\n<p> Saat menggunakan klik dua kali, dialog lisensi untuk kedua komponen muncul. Saat menjalankan aplikasi dari executable, hal ini tidak terjadi. Jika saya menyeret file yang sesuai ke pintasan aplikasi saya, aplikasi dimulai dengan file tersebut dan tidak ada dialog lisensi yang muncul. </p>\n\n<p> Oleh karena itu saya harus menyimpulkan bahwa masalahnya ada pada cara Windows menjalankan tindakan asosiasi file. </p>\n\n<p> Orang-orang yang membuat kode lisensi telah memberi tahu saya bahwa masalahnya mungkin adalah nama yang dapat dieksekusi berubah dan kode lisensi menolaknya. Saya hanya dapat berasumsi bahwa ini berkaitan dengan argumen yang berisi nama file. </p>\n\n<p> Saya telah mencoba untuk menangkap eksekusi kode melalui breakpoints dalam kode saya tetapi saya tidak bisa mewujudkannya bahkan jika breakpoint tersebut berada di baris pertama yang dijalankan. Apa pun yang dilakukan Windows akan melewati titik itu. </p>","source":"https://superuser.com/questions/433511/how-does-windows-actually-handle-file-associations","author":"<a href=\"https://superuser.com/users/82299/scruffyduck\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">ScruffyDuck</span></a>","replies":[{"reply":"Apakah Anda ingin menyetel program default untuk ekstensi apa pun atau hanya ingin menggali di dalam cara menangani ekstensi?","author":"<a href=\"https://superuser.com/users/86550/avirk\" target=\"_blank\" rel=\"nofollow noopener\">avirk</a>"},{"reply":"Saya tahu cara menyetel program default untuk ekstensi apa pun. Aplikasi saya melakukan itu. Yang ingin saya pahami adalah apa yang terjadi ketika pengguna mengklik dua kali file tersebut. Bagaimana Windows menjalankan perintah untuk menjalankan aplikasi dan meneruskan argumen. Mungkin masalahnya ada pada cara kerja perangkat lunak lisensi, tetapi saat ini saya tidak dapat memberi tahu mereka","author":"<a href=\"https://superuser.com/users/82299/scruffyduck\" target=\"_blank\" rel=\"nofollow noopener\">ScruffyDuck</a>"}],"answers":[{"answer":"<h1 class=\"h3\"> Bagaimana asosiasi bekerja </h1>\n\n<p> Saat Anda mengklik dua kali pada file di Windows explorer, shell Windows mencari ekstensi file di registri untuk melihat apakah ekstensi terdaftar. Jika ekstensi tidak terdaftar, Windows akan menampilkan kotak dialog Buka Dengan, memungkinkan pengguna untuk memilih aplikasi untuk diasosiasikan dengan jenis file. Jika ekstensi terdaftar, Windows memanggil fungsi ShellExecute () dengan perintah &quot;buka&quot;. Itu juga melewati nama file yang diklik dua kali sebagai parameter baris perintah. </p>\n\n<p> Asosiasi melangkah lebih jauh dari sekedar membuka file. Jika Anda mengklik kanan pada file teks (.TXT) di Explorer, Anda akan melihat dua item di bagian atas menu konteks. Yang pertama bernama Open. Memilih item menu ini sama dengan mengklik dua kali file di Explorer. Ketika Anda memilih Buka, NOTEPAD.EXE akan dimulai dengan file yang dipilih dimuat (dengan asumsi instalasi Windows default). Item menu kedua disebut Cetak. Mengklik item menu ini akan menyebabkan file dicetak tanpa menampilkan Notepad sama sekali. </p>\n\n<p> Jenis file lain menampilkan lebih banyak item di menu konteks Explorer. Jika Anda mengklik kanan pada file Microsoft PowerPoint, misalnya, Anda akan melihat item menu konteks bernama Open, New, Print, dan Show. Item yang ditampilkan di menu konteks untuk jenis file tertentu diperoleh dari registri. </p>\n\n<p> Setidaknya ada dua cara untuk membuat asosiasi file di Windows. Salah satu caranya adalah dengan mengklik kanan file di Windows Explorer dan pilih Buka denganâ€¦ dari menu konteks. Saat Anda melakukannya, Windows akan menampilkan dialog Buka Dengan. Secara alami, metode ini membutuhkan campur tangan pengguna. Saat Anda menerapkan aplikasi, Anda mungkin tidak ingin memaksa pengguna untuk menyiapkan asosiasi file secara manual. </p>\n\n<p> Cara yang lebih baik untuk membuat asosiasi adalah dengan membuat berbagai entri registri dari aplikasi Anda. Program penginstalan yang baik akan membuat entri registri untuk Anda, tetapi ada kalanya Anda memerlukan kontrol lebih besar atas proses tersebut. </p>\n\n<p><strong> Mendaftarkan asosiasi </strong></p>\n\n<p> Mendaftarkan asosiasi file memerlukan pembuatan dua kunci registri terpisah. Kedua kunci dibuat di bagian <code>HKEY_CLASSES_ROOT</code> dari registri. </p>\n\n<p><strong> Kunci ekstensi file </strong></p>\n\n<p> Kunci pertama adalah nama ekstensi file, diawali dengan titik. </p>\n\n<p> <code>HKEY_CLASSES_ROOT\\.zzy</code> </p>\n\n<p> Dalam aplikasi produksi, Anda harus memeriksa registri untuk memastikan bahwa kunci tidak ada sebelum Anda mencoba membuat kunci baru. Jika kunci sudah ada, aplikasi Anda perlu meminta pengguna untuk mengganti asosiasi file, atau bersiap untuk menggunakan ekstensi file yang berbeda sama sekali. </p>\n\n<p> Nilai kunci ini ditautkan ke kunci kedua yang akan Anda buat. Faktanya, itu adalah nama kunci kedua. Untuk program contoh, saya memberi kunci ini nilai &quot;Test App File.&quot; Nilai ini dapat berupa apa saja yang Anda pilih, tetapi, seperti kunci pertama, Anda harus yakin bahwa kunci tersebut belum ada di registri. </p>\n\n<p><strong> Kunci asosiasi aplikasi </strong></p>\n\n<p> Kunci kedua memiliki nama yang sama dengan nilai default untuk kunci pertama. </p>\n\n<p> <code>HKEY_CLASSES_ROOT\\Test App File</code> </p>\n\n<p> Kunci ini harus memiliki setidaknya satu subkunci. Windows menggunakan subkunci ini saat menjalankan aplikasi. Seluruh kunci disusun sebagai berikut: </p> <pre><code>HKEY_CLASSES_ROOT\n  Test App File\n    shell\n      open\n        command\n</code></pre> <p> String yang diberikan ke kunci perintah adalah jalur lengkap dan nama file aplikasi yang diikuti oleh <strong> % 1 </strong> . Sebagai contoh: </p>\n\n<p> <code>C:\\MyApp\\MyApp.exe %1</code> </p>\n\n<p> Ketika Windows meluncurkan aplikasi, itu menggantikan <strong> % 1 </strong> simbol dengan jalur dan nama file dari file yang diklik dua kali di Windows explorer. Nilai ini diteruskan ke aplikasi Anda sebagai parameter baris perintah. </p>\n\n<p><strong> Kunci tambahan </strong></p>\n\n<p> Ada subkunci lain yang dapat Anda buat di bawah kunci asosiasi file. Salah satu kunci tersebut adalah kunci <code>DefaultIcon</code>. Kunci ini digunakan untuk menentukan ikon yang akan ditampilkan oleh shell Windows di sebelah file dari tipe yang terdaftar. Kunci ini tidak diperlukan jika Anda hanya memiliki satu jenis file yang terdaftar dan jika jenis file tersebut harus menggunakan ikon aplikasi. Berikut cara nilai kunci DefaultIcon mencari pengaitan yang menentukan ikon aplikasi default: </p>\n\n<p> <code>C:\\MyApp\\MyApp.exe,0</code> </p>\n\n<p> Ini menetapkan bahwa ikon pertama yang ditemukan dalam file EXE aplikasi harus digunakan sebagai ikon tampilan asosiasi file. Jika aplikasi Anda memiliki lebih dari satu jenis file, Anda dapat menentukan ikon lain dengan mengubah indeks ikon yang mengikuti koma. Misalnya, C ++ Builder memiliki ikon untuk file proyek, file formulir, file sumber, dan sebagainya. Jika Anda melihat di registri di bawah <code>HKEY_CLASSES_ROOT\\BCBProject\\DefaultIcon</code>, Anda akan melihat bahwa ikon untuk file proyek adalah indeks ikon 4 (setidaknya untuk C ++ Builder 4). </p>\n\n<p> Jika Anda ingin mengizinkan pengguna untuk mencetak dokumen, Anda dapat menambahkan subkunci cetak sebagai tambahan dari subkunci buka. Nilai subkunci cetak mirip dengan subkunci terbuka, dengan satu pengecualian: </p>\n\n<p> <code>C:\\MyApp\\MyApp.exe /p %1</code> </p>\n\n<p> Perhatikan bahwa nilai ini memiliki sakelar baris perintah <strong> / p </strong> disisipkan di antara nama aplikasi dan <strong> % 1 </strong> simbol. Aplikasi Anda dapat mengawasi <strong> / p </strong> beralih dan mengambil tindakan yang tepat saat sakelar terdeteksi. </p>\n\n<p> Anda dapat menambahkan subkunci sebanyak yang Anda inginkan untuk jenis file tertentu. Nama setiap subkunci akan muncul di menu konteks Explorer. Anda hanya perlu menambahkan sakelar baris perintah untuk setiap jenis perintah sehingga aplikasi Anda dapat mengidentifikasi item menu konteks yang dipilih. Jika Anda memberikan nilai default untuk subkunci, Windows akan menggunakan teks itu untuk teks item menu konteks. Jika Anda tidak memberikan nilai default, Windows akan menggunakan nama kunci itu sendiri untuk item menu. </p>\n\n<p> Semua informasi diambil dari ini <a href=\"http://bcbjournal.org/articles/vol3/9911/Using_file_associations.htm\" rel=\"nofollow noopener\" target=\"_blank\"> artikel </a> . </p>","votes":"8","source":"https://superuser.com/a/433525","author":"<a href=\"https://superuser.com/users/86550/avirk\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">avirk</span></a>","replies":[]}]}
