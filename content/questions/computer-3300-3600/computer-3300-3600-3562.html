{"title":"Bagaimana cara membuat file .bat hanya berjalan di baki sistem?","draft":false,"url":"/bagaimana-cara-membuat-file-bat-hanya-berjalan-di-baki-sistem-9qobqxeb","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["networking","wireless-networking","windows-10","batch-file","command-line-arguments"],"snippet":"TL; DR di bagian bawah!  Detailnya di sini:  Saya memiliki koneksi internet yang tidak dapat diandalkan karena 2 alasan pada laptop Win 10 saya, yang terhubung secara nirkabel ke router saya, yang...","body":"<h2 class=\"h4\"> TL; DR di bagian bawah! </h2>\n\n<p><strong> Detailnya di sini: </strong></p>\n\n<p> Saya memiliki koneksi internet yang tidak dapat diandalkan karena 2 alasan pada laptop Win 10 saya, yang terhubung secara nirkabel ke router saya, yang dihubungkan dengan kabel ke modem saya. </p>\n\n<ul>\n<li><p> Alasan 1, sesuatu yang bukan kesalahan Win 10:\nModem saya sering rusak (IDK jika itu modem itu sendiri, ISP, atau apa, tapi ya), di mana itu baru saja restart. Ketika ini terjadi, internet di laptop saya (jelas) juga mati, tetapi kemudian tidak terhubung kembali ketika modem kembali menyala. Satu-satunya cara melakukannya adalah jika saya menonaktifkan, kemudian mengaktifkan, adaptor nirkabel saya dari jendela Network Connections. </p></li>\n<li><p> Alasan 2, sesuatu itu <em> aku s </em> Menangkan kesalahan 10:\nLaptop saya terkadang keluar dari jaringan Wi-Fi. Ini sendiri mungkin disebabkan oleh sesuatu selain Win 10, seperti NIC saya, atau router saya. Yang mengganggu saya adalah ketika Win 10 tidak secara otomatis terhubung kembali ke jaringan meskipun seharusnya begitu. Saat saya mengklik sendiri tombol &quot;Hubungkan&quot; di menu Wi-Fi, ini berfungsi dengan baik. </p></li>\n</ul>\n\n<hr>\n\n<p> Saya memutuskan untuk membuat file * .bat yang akan mendeteksi setiap kali salah satu skenario terjadi, dan kemudian memperbaiki masalahnya. Dengan sedikit riset di internet, saya berhasil menyusun script berikut ini: </p> <pre><code>@echo off\n:LOOP\nping 8.8.8.8\nIF ERRORLEVEL 1 goto RESTART\nIF ERRORLEVEL 0 goto LOOP\n:RESTART\nnetsh interface set interface \"&lt;wireless adapter&gt;\" disabled\nnetsh interface set interface \"&lt;wireless adapter&gt;\" enabled\nnetsh wlan connect name=\"&lt;ssid&gt;\" interface=\"&lt;wireless adapter&gt;\"\ntimeout /t 15\ngoto LOOP\n</code></pre> <p> Ini berfungsi dengan baik (ketika itu Jalankan sebagai Administrator), tetapi sekarang masalahnya adalah saya ingin jendela cmd <em> tidak </em> tetap terbuka (di layar, dan di bilah tugas) selama proses berjalan; Saya ingin itu berjalan di baki sebagai gantinya, jadi saya masih dapat dengan mudah keluar jika perlu, tanpa harus pergi ke Task Manager. Saya tahu saya dapat menjadwalkan skrip di Penjadwal Tugas untuk mulai diminimalkan saat start-up, tetapi bukankah itu hanya menyembunyikan jendela dari bilah tugas? </p>\n\n<p><strong> TL; DR: </strong></p>\n\n<p> Bagaimana cara membuat file * .bat berjalan di tray / pada jam di mana saya dapat dengan mudah mengklik kanan dan menghentikan / keluar?\nApakah mengompilasi file yang dapat dieksekusi satu-satunya cara untuk mencapai ini? </p>","source":"https://superuser.com/questions/1106317/how-can-i-make-a-bat-file-run-only-in-system-tray","author":"<a href=\"https://superuser.com/users/285373/nicholas-richards\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Nicholas Richards</span></a>","replies":[{"reply":"di linux / mac saya akan menjalankan skrip melalui cronjob. ada aplikasi serupa di windows yang disebut penjadwal tugas <a href=\"https://technet.microsoft.com/en-us/library/cc721931(v=ws.11).aspx\" rel=\"nofollow noopener\" target=\"_blank\"> technet.microsoft.com/en-us/library/cc721931(v=ws.11).aspx </a> coba gunakan ini untuk file batch Anda","author":"<a href=\"https://superuser.com/users/274090/konqui\" target=\"_blank\" rel=\"nofollow noopener\">konqui</a>"}],"answers":[{"answer":"<p> Karena saya tidak percaya ini dapat dilakukan melalui file <code>.bat</code> sederhana, ini sepertinya pekerjaan untuk <a href=\"https://autohotkey.com/download/\" rel=\"nofollow noopener\" target=\"_blank\"> AutoHotKey </a> . </p>\n\n<blockquote>\n  <p> AutoHotkey (AHK) adalah perangkat lunak pembuatan makro dan otomatisasi sumber terbuka gratis untuk Windows yang memungkinkan pengguna untuk mengotomatiskan tugas yang berulang. Ini didorong oleh bahasa skrip yang pada awalnya ditujukan untuk menyediakan pintasan keyboard, atau dikenal sebagai tombol pintas, yang seiring waktu berkembang menjadi bahasa skrip yang lengkap. </p>\n</blockquote>\n\n<p><a href=\"https://autohotkey.com/boards/viewtopic.php?t=4373\" rel=\"nofollow noopener\" target=\"_blank\"> Menurut posting forum ini dari 2014 </a> Anda harus dapat mengubah visibilitas jendela dengan skrip yang mirip dengan ini: </p> <pre><code>#NoTrayIcon\n#Persistent\n\nglobal hBatFile\n\n/* Setup Tray icon and add item that will handle\n* double click events\n*/\nMenu Tray, Icon\nMenu Tray, Icon, C:\\windows\\system32\\cmd.exe\nMenu Tray, Add, Show / Hide Pingu, TrayClick\nMenu Tray, Add, Close Pingu, CloseItem\nMenu Tray, Default, Show / Hide Pingu\n\n;// Run program or batch file hidden\nDetectHiddenWindows On\nRun pingu.bat,, Hide, PID\nWinWait ahk_pid %PID%\nhBatFile := WinExist()\nDetectHiddenWindows Off\nreturn\n\nTrayClick:\nOnTrayClick()\nreturn\n\n;// Show / hide program or batch file on double click\nOnTrayClick() {\n    if DllCall(\"IsWindowVisible\", \"Ptr\", hBatFile) {\n        WinHide ahk_id %hBatFile%\n\n    } else {\n        WinShow ahk_id %hBatFile%\n        WinActivate ahk_id %hBatFile%\n    }\n}\n\nCloseItem() {\n\n       DetectHiddenWindows On\n       WinWait ahk_class ConsoleWindowClass\n       Process, Close, cmd.exe\n       DetectHiddenWindows Off\n       ExitApp\n\n}\n</code></pre> <p> Skrip ini telah diuji dengan AutoHotKey 1.1.24.00 (Mei 2016). </p>\n\n<p> EDIT: <a href=\"https://autohotkey.com/boards/viewtopic.php?f=5&t=20939&p=100705#p100705\" rel=\"nofollow noopener\" target=\"_blank\"> Berikut ini tautan ke versi modifikasi OP dengan peningkatan. </a></p>\n\n<p> Dalam hal ini: </p>\n\n<ul>\n<li><em> pingu.bat </em> adalah nama (sembarang) dari file batch yang ingin kita jalankan </li>\n<li><em> hBatFile </em> adalah nama variabel sembarang yang menyimpan beberapa informasi jendela </li>\n<li><em> Pingu </em> adalah nama arbitrer yang ditampilkan di item menu baki AHK tambahan </li>\n</ul>\n\n<p> Cukup simpan skrip sebagai sesuatu seperti <code>tray.ahk</code> (perhatikan ekstensi skrip <code>.ahk</code>) dan klik dua kali untuk menjalankannya (dengan asumsi Anda telah menginstal AutoHotKey). </p>\n\n<p> Skrip memulai file batch diminimalkan dan menggantikan ikon skrip AHK default dengan ikon jendela konsol miniatur di baki. </p>\n\n<p> Visibilitas jendela konsol dapat diubah dengan mengklik dua kali ikon baki atau item menu baki yang ditambahkan (muncul dalam huruf tebal di bagian bawah menu pilihan). </p>\n\n<p> Menutup file batch dan jendela perintah dapat dilakukan dengan menambahkan item menu <code>Close</code> di bawah <code>Show / Hide</code> (<code>Exit</code> hanya akan menutup skrip, bukan jendela konsol). </p>\n\n<p> Perhatikan juga itu </p> <pre><code>Run pingu.bat,, Hide, PID\n</code></pre> <p> jelas membutuhkan <code>pingu.bat</code> untuk diganti dengan nama file batch Anda sendiri. Baris ini mengasumsikan bahwa skrip AHK muncul di direktori yang sama dengan <code>pingu.bat</code> atau <code>pingu.bat</code> dapat diakses secara global (yaitu telah ditambahkan ke folder di Path sistem Anda atau variabel PATH pengguna). Jika tidak, Anda ingin mengganti <code>pingu.bat</code> dengan path lengkap ke executable (perhatikan spasi!). </p>\n\n<hr>\n\n<p><strong> Peringatan </strong></p>\n\n<p> Skrip ini sebagian besar bertindak sebagai antarmuka untuk visibilitas jendela. Artinya, jika Anda <code>Exit</code> melalui ikon baki, Anda hanya keluar dari skrip AHK, bukan file batch Anda. </p>\n\n<p> Solusi sederhana adalah dengan menggunakan item menu <code>Close</code> yang ditambahkan untuk keluar dari skrip dan menghentikan <code>cmd.exe</code>. Alternatifnya, Anda dapat: </p>\n\n<ul>\n<li><p> Tampilkan jendela konsol dan gunakan <kbd> Ctrl </kbd> + <kbd> C </kbd> (atau cukup tutup jendela konsol dengan &#39;X&#39; merah) untuk menghentikan proses batch. </p></li>\n<li><p> Pilih <code>Exit</code> dari ikon baki untuk menghentikan skrip AHK </p></li>\n</ul>\n\n<p> Mereka adalah proses terpisah, seperti yang disebutkan. </p>\n\n<hr>\n\n<p><em> Catatan: Program konsol yatim piatu dengan jendela tersembunyi tidak dapat langsung diakses lagi jika skrip AHK diakhiri dengan <code>Exit</code> terlebih dahulu - tetapi Anda dapat menggunakan Task Manager untuk menutup proses <code>cmd.exe</code> terkait. </em></p>\n\n<hr>\n\n<p> Item menu <code>Close</code> seperti yang tertulis berfungsi dengan baik jika hanya ada satu proses <code>pingu.bat</code>. Namun, jika lebih dari satu proses <code>cmd.exe</code> sedang berjalan, ini mungkin tidak benar menutup file batch yang Anda mulai dengan skrip (mungkin menutup sesuatu yang lain). Anda mungkin ingin melihat penutupan dengan ID proses (PID) sebagai gantinya. Meskipun demikian, Anda juga dapat menggunakan proses Tampilkan / Tutup / Keluar yang sama di atas. </p>\n\n<hr>\n\n<p><strong> Catatan Skrip </strong></p> <pre><code>Menu Tray, Icon, C:\\windows\\system32\\cmd.exe\n</code></pre> <p> mengacu pada lokasi dari file executable yang dikompilasi dengan file ikon yang disematkan terkait. Anda harus dapat mengganti ini dengan referensi ke file yang dapat dieksekusi dengan ikon yang disematkan atau dengan referensi langsung ke file ikon <code>.ico</code> juga mis. </p> <pre><code>Menu Tray, Icon, C:\\Path\\To\\Icons\\icon.ico\n</code></pre>","votes":"3","source":"https://superuser.com/a/1106399","author":"<a href=\"https://superuser.com/users/302907/anaksunaman\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Anaksunaman</span></a>","replies":[{"reply":"Saya mengikuti instruksi Anda, dan menghasilkan skrip AHK, tetapi saya mengalami masalah lain. Saya sudah menanyakannya di forum AHK; apakah Anda pikir Anda bisa memeriksanya? <a href=\"https://autohotkey.com/boards/viewtopic.php?f=5&t=20939&p=100705#p100705\" rel=\"nofollow noopener\" target=\"_blank\"> autohotkey.com/boards/… </a>","author":"<a href=\"https://superuser.com/users/285373/nicholas-richards\" target=\"_blank\" rel=\"nofollow noopener\">Nicholas Richards</a>"},{"reply":"Anda dapat melihat di sana seluruh skrip yang saya gunakan. Masalahnya adalah bahwa <i> Skrip AHK </i> menjadi yatim piatu, bukan jendela konsol.","author":"<a href=\"https://superuser.com/users/285373/nicholas-richards\" target=\"_blank\" rel=\"nofollow noopener\">Nicholas Richards</a>"},{"reply":"Tidak apa-apa, masalahnya sudah hilang. Terima kasih atas jawaban Anda yang sangat mendetail :)","author":"<a href=\"https://superuser.com/users/285373/nicholas-richards\" target=\"_blank\" rel=\"nofollow noopener\">Nicholas Richards</a>"},{"reply":"@NicholasRichards Selamat datang untuk jawabannya. Saya senang Anda membuatnya berfungsi seperti yang Anda suka. :)","author":"<a href=\"https://superuser.com/users/302907/anaksunaman\" target=\"_blank\" rel=\"nofollow noopener\">Anaksunaman</a>"}]},{"answer":"<h3 class=\"h5\"> Bagaimana cara membuat file * .bat berjalan di baki? </h3>\n<p> Kamu bisa gunakan <a href=\"http://rbtray.sourceforge.net/\" rel=\"nofollow noopener\" target=\"_blank\"> RBTray </a> : </p>\n<blockquote>\n<p> RBTray adalah program Windows kecil yang berjalan di latar belakang dan memungkinkan hampir semua jendela diminimalkan ke baki sistem dengan mengklik kanan tombol minimalkan. </p>\n<p> Ini gratis, sumber terbuka, dan didistribusikan di bawah ketentuan Lisensi Publik Umum GNU. </p>\n</blockquote>\n<p> Ini hanya 45k dan memiliki versi 32 dan 64 bit. </p>\n<hr>\n<h3 class=\"h5\"> Penolakan </h3>\n<p> Saya tidak berafiliasi dengan <a href=\"http://rbtray.sourceforge.net/\" rel=\"nofollow noopener\" target=\"_blank\"> RBTray </a> dengan cara apapun, saya hanyalah pengguna akhir dari perangkat lunak mereka. </p>","votes":"3","source":"https://superuser.com/a/1106461","author":"<a href=\"https://superuser.com/users/337631/davidpostill\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">DavidPostill</span></a>","replies":[{"reply":"Saya menggunakan perangkat lunak ini juga, mudah digunakan, cukup klik kanan pada tombol perkecil dan ada di baki Anda, bekerja dengan hampir semua program!","author":"<a href=\"https://superuser.com/users/267244/alex\" target=\"_blank\" rel=\"nofollow noopener\">Alex</a>"},{"reply":"Apakah mungkin untuk melakukan ini secara otomatis setiap kali jendela / program tertentu terbuka? EDIT: Lupakan. Saya baru saja memeriksa, ini tidak berfungsi dengan jendela cmd. Software yang bagus.","author":"<a href=\"https://superuser.com/users/285373/nicholas-richards\" target=\"_blank\" rel=\"nofollow noopener\">Nicholas Richards</a>"},{"reply":"@NicholasRards Tidak ada ide. Saya tidak pernah merasa perlu untuk mengotomatiskannya. Mungkin AutoHotkey atau sejenisnya bisa melakukan ini ...","author":"<a href=\"https://superuser.com/users/337631/davidpostill\" target=\"_blank\" rel=\"nofollow noopener\">DavidPostill&#9830;</a>"}]},{"answer":"<p> Anda dapat menggunakan alat open source <strong><a href=\"https://movemouse.codeplex.com\" rel=\"nofollow noopener\" target=\"_blank\"> MoveMouse </a></strong> yang memungkinkan untuk menjalankan mininized dalam SysTray dan dengan mudah memungkinkan untuk menjalankan skrip Batch secara terjadwal atau berdasarkan acara. </p>\n\n<p> Tujuan aslinya adalah untuk memindahkan sedikit penunjuk mouse untuk mencegah tindakan aplikasi / atau sistem (seperti memasukkan status dalam program obrolan atau menjalankan screensaver selama presentasi) berdasarkan ketidakaktifan. </p>\n\n<hr>\n\n<p><strong> Mempersiapkan: </strong></p>\n\n<p> Untuk mengaturnya, buka aplikasi, lalu klik <strong> Tab &quot;Skrip&quot; </strong> , di sana Anda punya pilihan <strong> &quot;Jalankan skrip di setiap interval&quot; </strong> : Impor skrip (power shell) yang ingin Anda jalankan melalui <strong> Impor </strong> tombol dan kemudian klik <strong> Mulailah </strong> tombol. Waktu interval dapat diatur di <strong> Tab &quot;Tindakan&quot; </strong> , ditentukan dalam hitungan detik. </p>\n\n<p> Melalui <strong> Tab &quot;Jadwal&quot; </strong> Anda juga dapat mengatur kapan harus memulai / berhenti menjalankan skrip berdasarkan jadwal waktu. Jika perlu, Anda juga dapat menyiapkan <strong> periode black out </strong> dengan memasukkan waktu mulai dan berhenti di <strong> Tab &quot;Pemadaman&quot; </strong> , memblokir eksekusi skrip selama waktu itu. </p>\n\n<hr>\n\n<p><strong> catatan: </strong> Karena MoveMouse hanya mendukung skrip PowerShell, jika Anda perlu menjalankan file batch, Anda dapat memanggilnya sebagai <code>start-process C:Pathfile.bat</code> atau <code>start-process \"cmd.exe\" \"/c C:Pathfile.bat\"</code>, seperti yang dijelaskan <a href=\"https://www.jamsscheduler.com/blog/how-to-execute-a-bat-file-within-a-powershell-job/\" rel=\"nofollow noopener\" target=\"_blank\"> sini. </a></p>","votes":"0","source":"https://superuser.com/a/1106599","author":"<a href=\"https://superuser.com/users/146810/matt\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Matt</span></a>","replies":[]}]}
