{"title":"Menggunakan supervisord untuk mengontrol MTA postfix","draft":false,"url":"/menggunakan-supervisord-untuk-mengontrol-mta-postfix-ziirdf6l","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["postfix"],"snippet":"Saya mencoba menggunakan  supervisord  untuk mengontrol postfix. Metode yang biasa digunakan adalah menentukan perintah yang memulai daemon, saya menggunakan postfix -c /etc/postfix start. Halaman manual postfix mengatakan bahwa untuk menghentikan Anda mengganti...","body":"<p> Saya mencoba menggunakan <a href=\"http://supervisord.org/configuration.html#programx\" rel=\"nofollow noopener\" target=\"_blank\"> supervisord </a> untuk mengontrol postfix. Metode yang biasa digunakan adalah menentukan perintah yang memulai daemon, saya menggunakan <code>postfix -c /etc/postfix start</code>. Halaman manual postfix mengatakan bahwa untuk menghentikan Anda mengganti <code>start</code> dengan <code>stop</code> pada perintah di atas. </p>\n\n<p> Saya tidak melihat cara untuk menentukan perintah lain untuk menghentikan daemon, hanya sebuah sinyal. Halaman manual <pre><code>[program:master]\nprocess_name    = master\npriority        = 5\ndirectory       = /etc/postfix\ncommand         = /usr/sbin/postfix -c /etc/postfix start\nstartsecs       = 0\nuser            = root\nstopsignal      = INT\n</code></pre> mengatakan bahwa sinyal <code>TERM</code> akan berfungsi seolah-olah <code>postfix abort</code> digunakan tetapi tidak bersuara saat dimatikan dengan baik melalui sinyal. </p>\n\n<p> Juga, metode start / stop paragraf pertama adalah rumit sejauh menyangkut supervisor. Skrip melakukan banyak pemeriksaan dan kemudian memanggil <code>master</code>, <code>qmgr</code> dan <code>pickup</code> dengan <code>master</code> sebagai pemimpin grup proses. Dengan demikian, supervisord memiliki pegangan pada PID yang tidak berguna (salah satu skrip yang dijalankan) dan oleh karena itu tidak dapat menggunakan PID tersebut untuk menghentikan daemon. Apa yang harus ditangani adalah proses <code>master</code>. </p>\n\n<p> Seberapa jauh saya punya: </p> <pre><code>[program:master]\nprocess_name    = master\npriority        = 5\ndirectory       = /etc/postfix\ncommand         = /usr/sbin/postfix -c /etc/postfix start\nstartsecs       = 0\nuser            = root\nstopsignal      = INT\n</code></pre> <p> Ini memulai postfix tetapi tidak bisa menghentikannya. </p>","source":"https://superuser.com/questions/168412/using-supervisord-to-control-the-postfix-mta","author":"<a href=\"https://superuser.com/users/44239/alephnull\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">alephnull</span></a>","replies":[],"answers":[{"answer":"<p> Solusi saya adalah menulis skrip pembungkus bernama postfix.sh sebagai berikut: </p> <pre><code># call \"postfix stop\" when exiting\ntrap \"{ echo Stopping postfix; /usr/sbin/postfix stop; exit 0; }\" EXIT\n\n# start postfix\n/usr/sbin/postfix -c /etc/postfix start\n# avoid exiting\nsleep infinity   \n</code></pre> <p> Setelah itu, ubah supervisord.conf: </p> <pre><code>[program:postfix]\ncommand=path/to/postfix.sh \n</code></pre>","votes":"4","source":"https://superuser.com/a/843542","author":"<a href=\"https://superuser.com/users/127033/hui-zheng\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Hui Zheng</span></a>","replies":[]},{"answer":"<p> Ternyata lebih mudah menggunakan sesuatu seperti <a href=\"http://mmonit.com/monit/\" rel=\"nofollow noopener\" target=\"_blank\"> Monit </a> untuk memantau daemon: </p>\n\n<blockquote>\n  <p> Monit adalah utilitas open source gratis untuk mengelola dan memantau,\n  proses, program, file, direktori, dan sistem file pada UNIX\n  sistem. Monit melakukan perawatan dan perbaikan otomatis dan bisa\n  melaksanakan tindakan kausal yang berarti dalam situasi kesalahan. </p>\n  \n  <p> Anda dapat menggunakan Monit untuk memantau proses daemon atau program serupa\n  berjalan di localhost. Monit sangat berguna untuk memonitor daemon\n  proses, seperti yang dimulai pada waktu boot sistem dari\n  /etc/init.d/. Misalnya sendmail, sshd, apache dan mysql. </p>\n</blockquote>\n\n<p><img src=\"https://i.stack.imgur.com/g3FhF.png\" alt=\"enter image description here\" class=\"img-fluid d-block my-2\" loading=\"lazy\"></p>","votes":"1","source":"https://superuser.com/a/275860","author":"<a href=\"https://superuser.com/users/44239/alephnull\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">alephnull</span></a>","replies":[]},{"answer":"<p> Sama seperti @Hui Zheng tetapi memeriksa apakah posfix hidup </p> <pre><code>trap \"postfix stop\" SIGINT\ntrap \"postfix stop\" SIGTERM\ntrap \"postfix reload\" SIGHUP\n\n# force new copy of hosts there (otherwise links could be outdated)\ncp /etc/hosts /var/spool/postfix/etc/hosts\n\n# start postfix\npostfix start\n\n# lets give postfix some time to start\nsleep 3\n\n# wait until postfix is dead (triggered by trap)\nwhile kill -0 \"`cat /var/spool/postfix/pid/master.pid`\"; do\n  sleep 5\ndone\n</code></pre> <p> kredit pergi <a href=\"https://www.snip2code.com/Snippet/309436/postfix-wrapper-sh-for-supervisord-in-do\" rel=\"nofollow noopener\" target=\"_blank\"> sini </a></p>","votes":"1","source":"https://superuser.com/a/1045366","author":"<a href=\"https://superuser.com/users/75803/ivailo-bardarov\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Ivailo Bardarov</span></a>","replies":[]}]}
