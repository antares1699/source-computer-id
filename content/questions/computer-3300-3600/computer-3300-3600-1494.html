{"title":"Gunakan pengaturan DivX untuk menyandikan ke mp4 dengan ffmpeg","draft":false,"url":"/gunakan-pengaturan-divx-untuk-menyandikan-ke-mp4-dengan-ffmpeg-vfynvixx","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["windows-7","ffmpeg"],"snippet":"Saya terbiasa menggunakan VirtualDub untuk menyandikan video ke wadah AVI dengan DivX-codec (dan MP3 untuk audio). Sekarang saya berencana menggunakan ffmpeg untuk menyandikan video ke wadah MP4 dengan h264-codec. Apa yang saya...","body":"<p> Saya terbiasa menggunakan VirtualDub untuk menyandikan video ke wadah AVI dengan DivX-codec (dan MP3 untuk audio). Sekarang saya berencana menggunakan ffmpeg untuk menyandikan video ke wadah MP4 dengan h264-codec. Apa yang saya temukan adalah bahwa saya perlu menggunakan libx264 dan salah satu preset tersebut untuk membuat apa pun berfungsi. Namun, saya kagum dengan bitrate video yang digunakan ffmpeg untuk encoding. </p>\n\n<p> Apa yang saya miliki saat ini adalah file batch kecil ini: </p> <pre><code>@ECHO OFF\n\nSETLOCAL\n\nSET IN=source.avs\nSET FFMPEG_PATH=C:\\Program Files (x86)\\ffmpeg\nSET PRESET=-fpre \"%FFMPEG_PATH%\\presets\\libx264-lossless_slow.ffpreset\" \nSET AUDIO=-acodec libmp3lame -ab 128000\nSET VIDEO=-vcodec libx264 -vb 1978000\n\n\"%FFMPEG_PATH%\\ffmpeg.exe\" -i %IN% %AUDIO% %VIDEO% %PRESET% test.mp4\n\nENDLOCAL\n</code></pre> <p> Dengan ini saya memberi tahu ffmpeg untuk menggunakan 1978k sebagai bitrate, tetapi ffmpeg menggunakan 15000k +! Saya mencoba preset lain, tetapi mereka tidak menggunakan bitrate yang saya tentukan. Berikut adalah preset yang saya miliki: </p>\n\n<ul>\n<li> libx264-baseline.ffpreset </li>\n<li> libx264-ipod320.ffpreset </li>\n<li> libx264-ipod640.ffpreset </li>\n<li> libx264-lossless_fast.ffpreset </li>\n<li> libx264-lossless_max.ffpreset </li>\n<li> libx264-lossless_medium.ffpreset </li>\n<li> libx264-lossless_slow.ffpreset </li>\n<li> libx264-lossless_slower.ffpreset </li>\n<li> libx264-lossless_ultrafast.ffpreset </li>\n</ul>\n\n<p> versi ffmpeg: </p> <pre><code>FFmpeg git-N-29181-ga304071\nlibavutil    50. 40. 1 / 50. 40. 1\nlibavcodec   52.120. 0 / 52.120. 0\nlibavformat  52.108. 0 / 52.108. 0\nlibavdevice  52.  4. 0 / 52.  4. 0\nlibavfilter   1. 79. 0 /  1. 79. 0\nlibswscale    0. 13. 0 /  0. 13. 0\n</code></pre> <p><em> Perhatikan bahwa saya tidak menggunakan versi terbaru karena memiliki masalah dengan spasi dalam nama file. </em></p>\n\n<p> Inilah yang tampaknya menjadi daftar parameter lengkap yang digunakan DivX 6.9.2: </p> <pre><code>-bvnn 1978000 -vbv 218691200,100663296,100663296 -dir \"C:\\Users\\sjngm\\AppData\\Roaming\\DivX\\DivX Codec\" -w -b 1 -use_presets=1 -preset=10 -windowed_fullsearch=2 -thread_delay=1\n</code></pre> <p> Parameter baris perintah apa itu untuk ffmpeg? </p>\n\n<hr>\n\n<p> EDIT: </p>\n\n<p> Sesuai dengan saran slhck, saya mencoba versi 32-bit yang baru. Saya tidak tahu apakah itu 0.9 atau lebih baru, saya tidak dapat menemukan info itu. </p> <pre><code>ffmpeg version N-36890-g67f5650\nlibavutil      51. 34.100 / 51. 34.100\nlibavcodec     53. 56.105 / 53. 56.105\nlibavformat    53. 30.100 / 53. 30.100\nlibavdevice    53.  4.100 / 53.  4.100\nlibavfilter     2. 59.100 /  2. 59.100\nlibswscale      2.  1.100 /  2.  1.100\nlibswresample   0.  6.100 /  0.  6.100\nlibpostproc    51.  2.100 / 51.  2.100\n</code></pre> <p> Saya mengerjakan ulang file batch saya agar terlihat seperti ini (yang cukup menarik, saya tidak dapat menemukan parameter <code>-vprofile</code> dalam dokumentasi): </p> <pre><code>@ECHO OFF\n\nSETLOCAL\n\nSET IN=VTS_01_1.avs\nSET FFMPEG_PATH=C:\\Program Files (x86)\\ffmpeg\nSET PRESET=-vprofile high -preset veryslow\nSET AUDIO=-acodec libmp3lame -ab 128000\nSET VIDEO=-vcodec libx264 -vb 1978000\n\n\"%FFMPEG_PATH%\\ffmpeg.exe\" -i %IN% %AUDIO% %PRESET% %VIDEO% test.mp4\n\nENDLOCAL\n</code></pre> <p> Saya melihat bahwa sekarang menggunakan bitrate dengan benar (terima kasih kepada LongNeckbeard untuk menunjukkan bahwa lossless-stuff mengabaikan bitrate!). </p>\n\n<p> Kalau-kalau Anda bertanya-tanya bagaimana saya menghasilkan 1978000, saya menggunakan rumus ini yang menurut saya valid untuk file DivX (saya rasa bitrate tidak akan banyak berubah untuk h264): </p> <pre><code>width * height * 25 * 0.22 / 1000\n</code></pre> <p> Saya tidak yakin apakah 0,22 berkorelasi dengan CRF. </p>\n\n<p> Secara keseluruhan saya lupa mengatakan bahwa saya akan menggunakan skenario dua langkah, itulah sebabnya saya tidak menggunakan CRF di sini. Saya akan mencoba membaca lebih lanjut tentang ini. Saat ini saya hanya mencoba menjalankan sesuatu yang menunjukkan bahwa saya melakukan sesuatu dengan benar (ffmpeg bukanlah alat termudah untuk dipahami;)). </p> <pre><code>C:\\Program Files (x86)\\ffmpeg\\ffmpeg.exe\" -i VTS_01_1.avs -acodec libmp3lame -ab 128000 -vcodec libx264 -vb 1978000 -vprofile high -preset veryslow test.mp4\n</code></pre> <p> Outputnya sekarang: </p> <pre><code>ffmpeg version N-36890-g67f5650 Copyright (c) 2000-2012 the FFmpeg developers\n  built on Jan 16 2012 21:57:13 with gcc 4.6.2\n  configuration: --enable-gpl --enable-version3 --disable-w32threads --enable-runtime-cpudetect --enable-avisynth --enable-bzlib --enable-frei0r --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libfreetype --enable-libgsm --enable-libmp3lame --enable-libopenjpeg --enable-librtmp --enable-libschroedinger --enable-libspeex --enable-libtheora --enable-libvo-aacenc --enable-libvo-amrwbenc --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libxavs --enable-libxvid --enable-zlib\n  libavutil      51. 34.100 / 51. 34.100\n  libavcodec     53. 56.105 / 53. 56.105\n  libavformat    53. 30.100 / 53. 30.100\n  libavdevice    53.  4.100 / 53.  4.100\n  libavfilter     2. 59.100 /  2. 59.100\n  libswscale      2.  1.100 /  2.  1.100\n  libswresample   0.  6.100 /  0.  6.100\n  libpostproc    51.  2.100 / 51.  2.100\nInput #0, avs, from 'VTS_01_1.avs':\n  Duration: 00:58:46.12, start: 0.000000, bitrate: 0 kb/s\n    Stream #0:0: Video: rawvideo (YV12 / 0x32315659), yuv420p, 576x448, 77414 kb/s, 25 tbr, 25 tbn, 25 tbc\n    Stream #0:1: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 48000 Hz, 2 channels, s16, 1536 kb/s\nFile 'test.mp4' already exists. Overwrite ? [y/N] y\nw:576 h:448 pixfmt:yuv420p tb:1/1000000 sar:0/1 sws_param:\n[libx264 @ 05A2C400] using cpu capabilities: MMX2 SSE2Fast FastShuffle SSEMisalign LZCNT\n[libx264 @ 05A2C400] profile High, level 3.1\n[libx264 @ 05A2C400] 264 - core 120 r2120 0c7dab9 - H.264/MPEG-4 AVC codec - Copyleft 2003-2011 - http://www.videolan.org/x264.html - options: cabac=1 ref=16 deblock=1:0:0 analyse=0x3:0x133 me=umh subme=10 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=24 chroma_me=1 trellis=2 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=8 b_pyramid=2 b_adapt=2 b_bias=0 direct=3 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=60 rc=abr mbtree=1 bitrate=1978 ratetol=1.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00\nOutput #0, mp4, to 'test.mp4':\n  Metadata:\n    encoder         : Lavf53.30.100\n    Stream #0:0: Video: h264 (![0][0][0] / 0x0021), yuv420p, 576x448, q=-1--1, 1978 kb/s, 25 tbn, 25 tbc\n    Stream #0:1: Audio: mp3 (i[0][0][0] / 0x0069), 48000 Hz, 2 channels, s16, 128 kb/s\nStream mapping:\n  Stream #0:0 -&gt; #0:0 (rawvideo -&gt; libx264)\n  Stream #0:1 -&gt; #0:1 (pcm_s16le -&gt; libmp3lame)\nPress [q] to stop, [?] for help\nframe=    0 fps=  0 q=0.0 size=       0kB time=00:00:00.00 bitrate=   0.0kbits/s\nframe=    0 fps=  0 q=0.0 size=       0kB time=00:00:00.00 bitrate=   0.0kbits/s\nframe=    0 fps=  0 q=0.0 size=       0kB time=00:00:00.00 bitrate=   0.0kbits/s\nframe=    3 fps=  1 q=22.0 size=      39kB time=00:00:00.04 bitrate=8063.8kbits/\nframe=    8 fps=  2 q=22.0 size=      82kB time=00:00:00.24 bitrate=2801.3kbits/\nframe=   13 fps=  3 q=23.0 size=     120kB time=00:00:00.44 bitrate=2229.5kbits/\nframe=   16 fps=  4 q=23.0 size=     147kB time=00:00:00.56 bitrate=2156.7kbits/\nframe=   20 fps=  4 q=22.0 size=     175kB time=00:00:00.72 bitrate=1987.4kbits/\n:\nvideo:4387kB audio:273kB global headers:0kB muxing overhead 0.260038%\n[libx264 @ 05A2C400] frame I:2     Avg QP:19.53  size: 29850\n[libx264 @ 05A2C400] frame P:76    Avg QP:22.24  size: 19541\n[libx264 @ 05A2C400] frame B:359   Avg QP:25.93  size:  8210\n[libx264 @ 05A2C400] consecutive B-frames:  0.5%  0.5%  0.0%  8.2% 17.2% 52.2% 16.0%  5.5%  0.0%\n[libx264 @ 05A2C400] mb I  I16..4:  5.4% 75.3% 19.3%\n[libx264 @ 05A2C400] mb P  I16..4:  1.3% 16.5%  2.2%  P16..4: 36.3% 28.6% 12.7% 1.8%  0.2%    skip: 0.4%\n[libx264 @ 05A2C400] mb B  I16..4:  0.4%  3.8%  0.3%  B16..8: 40.0% 18.4%  4.7% direct:18.5%  skip:13.9%  L0:45.4% L1:38.1% BI:16.5%\n[libx264 @ 05A2C400] final ratefactor: 20.35\n[libx264 @ 05A2C400] 8x8 transform intra:83.1% inter:68.5%\n[libx264 @ 05A2C400] direct mvs  spatial:99.2% temporal:0.8%\n[libx264 @ 05A2C400] coded y,uvDC,uvAC intra: 64.9% 83.4% 49.2% inter: 49.0% 50.4% 4.4%\n[libx264 @ 05A2C400] i16 v,h,dc,p: 25% 22% 27% 26%\n[libx264 @ 05A2C400] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 10%  7% 23%  9% 10% 10% 10%10% 13%\n[libx264 @ 05A2C400] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 12% 11% 13%  9% 12% 11% 10% 9% 12%\n[libx264 @ 05A2C400] i8c dc,h,v,p: 42% 28% 16% 14%\n[libx264 @ 05A2C400] Weighted P-Frames: Y:18.4% UV:7.9%\n[libx264 @ 05A2C400] ref P L0: 29.1% 11.3% 15.7%  7.3%  6.9%  4.9%  5.1%  3.4%3.9%  2.7%  2.8%  1.8%  1.7%  1.2%  1.4%  0.9%\n[libx264 @ 05A2C400] ref B L0: 68.8% 11.4%  5.5%  2.9%  2.3%  1.9%  1.5%  1.1%1.1%  1.0%  0.9%  0.7%  0.5%  0.3%  0.1%\n[libx264 @ 05A2C400] ref B L1: 91.9%  8.1%\n[libx264 @ 05A2C400] kb/s:2055.88\n</code></pre> <p> Sejauh yang saya ketahui, itu tidak terlihat buruk bagi saya. </p>","source":"https://superuser.com/questions/380633/use-divx-settings-to-encode-to-mp4-with-ffmpeg","author":"<a href=\"https://superuser.com/users/114557/sjngm\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">sjngm</span></a>","replies":[{"reply":"Preset lossless akan mengabaikan <code>-b</code> yang Anda nyatakan.","author":"<a href=\"https://superuser.com/users/110524/llogan\" target=\"_blank\" rel=\"nofollow noopener\">llogan</a>"},{"reply":"saya menemukan sebuah <a href=\"http://www.virag.si/2012/01/web-video-encoding-tutorial-with-ffmpeg-0-9/\" rel=\"nofollow noopener\" target=\"_blank\"> dokter yang baik </a> untuk membantu menemukan opsi yang bagus.","author":"<a href=\"https://superuser.com/users/114557/sjngm\" target=\"_blank\" rel=\"nofollow noopener\">sjngm</a>"}],"answers":[{"answer":"<p> Pertama-tama Anda harus meningkatkan ke setidaknya FFmpeg 0.9. <code>vpre</code> tidak benar-benar didorong untuk digunakan untuk kontrol prasetel lagi. Inilah sebabnya mengapa file <code>ffpreset</code> telah dihapus dari versi yang lebih baru. Kontrol prasetel untuk libx264 sekarang terjadi melalui x264 itu sendiri, bukan melalui FFmpeg. </p>\n\n<p> Karena itu, menyetel bitrate rata-rata untuk x264 adalah <a href=\"http://git.videolan.org/?p=x264.git;a=blob_plain;f=doc/ratecontrol.txt;hb=HEAD\" rel=\"nofollow noopener\" target=\"_blank\"> mode kontrol tingkat terburuk </a> ada. Daripada kecepatan bit rata-rata, Anda harus mempertimbangkan untuk menggunakan pengkodean dua jalur jika Anda menargetkan ukuran file keluaran tertentu, atau menyetel <a href=\"http://homepage.univie.ac.at/werner.robitza/crf.html\" rel=\"nofollow noopener\" target=\"_blank\"> Faktor Tingkat Konstan </a> (CRF) jika Anda hanya peduli tentang pencapaian kualitas tertentu. Jika ragu, gunakan CRF. </p>\n\n<hr>\n\n<p> Biasanya Anda menginginkan sintaks berikut untuk menggunakan FFmpeg dan x264: </p> <pre><code>ffmpeg -i in.mp4 -vcodec libx264 &lt;options&gt; out.mp4\n</code></pre> <p> … Dengan opsi tidak wajib berikut ini. Penting untuk menentukannya sebelum output dan setelah sakelar <code>vcodec</code>. Itu hanya beberapa (lihat juga <a href=\"https://sites.google.com/site/linuxencoding/x264-ffmpeg-mapping\" rel=\"nofollow noopener\" target=\"_blank\"> pemetaan opsi </a> untuk lebih): </p>\n\n<ul>\n<li><p> <code>-vprofile</code>: Setel batasan profil h.264, mis. <code>baseline</code>, <code>main</code>, <code>high</code> </p></li>\n<li><p> <code>-preset</code>: Setel prasetel pengkodean, yang umumnya mengaktifkan strategi pengoptimalan. Anda dapat memilih dari <code>veryslow</code>, <code>slow</code>, <code>fast</code>, <code>ultrafast</code>, dan banyak lagi. Preset yang lebih lambat menghasilkan kompresi yang lebih baik dengan biaya encoding yang lebih lambat. Anda biasanya menggunakan pengaturan awal yang paling lambat yang Anda bisa kesabaran. </p></li>\n<li><p> <code>-tune</code>: Setel faktor nada khusus, mis. untuk film: <code>film</code> </p></li>\n<li><p> <code>-b</code>: Setel bitrate. Seperti yang telah dikatakan, ini bukan yang Anda inginkan dengan pengkodean sekali jalan, tetapi jika perlu, ini akan berfungsi. Nilai yang mungkin ada dalam Bits, atau lebih tepatnya <code>500K</code>, <code>1M</code>, dan lain-lain. </p></li>\n<li><p> <code>-crf</code>: Atur kualitas. Saling eksklusif dengan <code>-b</code>. Nilai awal yang baik adalah 24. Nilai yang lebih rendah berarti kualitas yang lebih tinggi. Gunakan nilai tertinggi yang masih terlihat bagus untuk Anda. </p></li>\n</ul>\n\n<hr>\n\n<p> Contoh dua lintasan, video H.264, audio AAC dalam MP4: </p> <pre><code>ffmpeg -i input -c:v libx264 -preset slow -b:v 500k -pass 1 -an -f mp4 -y NUL\nffmpeg -i input -c:v libx264 -preset slow -b:v 500k -pass 2 -c:a libfaac -b:a 128k output.mp4\n</code></pre> <p> Contoh CRF, video H.264, audio MP3 di MKV: </p>\n\n<p> <code>ffmpeg -i input -c:v libx264 -preset medium -crf 24 -c:a libmp3lame -q:a 4 output.mkv</code> </p>","votes":"9","source":"https://superuser.com/a/380757","author":"<a href=\"https://superuser.com/users/48078/slhck\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">slhck</span></a>","replies":[{"reply":"Selain itu, jika Anda masih mengalami masalah, silakan kirim baris perintah lengkap dan keluaran FFmpeg / x264 lengkap yang Anda dapatkan.","author":"<a href=\"https://superuser.com/users/48078/slhck\" target=\"_blank\" rel=\"nofollow noopener\">slhck</a>"},{"reply":"Terima kasih banyak, itu menunjukkan beberapa info baru untuk saya! Silakan baca pertanyaan saya saat saya menambahkan temuan terbaru saya ke dalamnya. Ini terlihat oke bagiku.","author":"<a href=\"https://superuser.com/users/114557/sjngm\" target=\"_blank\" rel=\"nofollow noopener\">sjngm</a>"},{"reply":"Mengenai dua umpan: jika saya menggunakan <code>-vcodec libx264</code> sebagai satu-satunya opsi khusus video untuk umpan kedua, saya mendapatkan kesalahan (<code>maybe incorrect parameters such as bit_rate, rate, width or height</code>). Ini berfungsi jika saya menambahkan <code>-vb 1978k</code>. Jadi saya harus menambahkan opsi bitrate. <code>-minrate</code> dan <code>-maxrate</code> tampak agak kabur bagi saya. Atau apakah <code>-vb</code> baik-baik saja untuk dua lintasan?","author":"<a href=\"https://superuser.com/users/114557/sjngm\" target=\"_blank\" rel=\"nofollow noopener\">sjngm</a>"},{"reply":"Beberapa komentar atas pertanyaan Anda yang diperbarui: 1) MP3 tidak didukung secara resmi di MP4. 2) Gunakan pengkodean dua langkah jika Anda menargetkan ukuran file keluaran tertentu dan tidak peduli dengan kualitas. Gunakan CRF jika Anda ingin menargetkan kualitas tertentu dan tidak peduli dengan ukuran file.","author":"<a href=\"https://superuser.com/users/110524/llogan\" target=\"_blank\" rel=\"nofollow noopener\">llogan</a>"},{"reply":"@LordNeckbeard Terima kasih atas pengeditannya. <code>&#47;dev&#47;null</code> tidak akan berfungsi di Windows Saya kira, apakah Anda tahu apa yang harus digunakan?","author":"<a href=\"https://superuser.com/users/48078/slhck\" target=\"_blank\" rel=\"nofollow noopener\">slhck</a>"},{"reply":"@sjngm Ping Anda tentang jawaban yang diperbarui dan komentar LordNeckbeard.","author":"<a href=\"https://superuser.com/users/48078/slhck\" target=\"_blank\" rel=\"nofollow noopener\">slhck</a>"},{"reply":"@slhck ya, ini <code>NUL</code>","author":"<a href=\"https://superuser.com/users/114557/sjngm\" target=\"_blank\" rel=\"nofollow noopener\">sjngm</a>"},{"reply":"@LordNeckbeard Anda membingungkan saya. Saya membaca komentar Anda seolah-olah saya melakukan sesuatu yang salah. Namun, saya katakan saya menggunakan <code>-vb</code> untuk pass kedua dan dalam edit dua pass Anda, Anda memasukkan <code>-b:v</code> yang merupakan IMHO yang sama. Jadi, apakah saya melakukan sesuatu yang salah atau apakah saya baik-baik saja?","author":"<a href=\"https://superuser.com/users/114557/sjngm\" target=\"_blank\" rel=\"nofollow noopener\">sjngm</a>"},{"reply":"@luthfiqhhhh. Saya lupa bahwa sjngm menggunakan Windows dan saya tidak yakin apa yang setara dengan Windows. Sebagai alternatif, nama file sederhana dapat digunakan dan akses kedua dapat menggunakan nama file yang sama dengan opsi <code>-y</code>. Mungkin pengguna Windows harus mengubah contohnya.","author":"<a href=\"https://superuser.com/users/110524/llogan\" target=\"_blank\" rel=\"nofollow noopener\">llogan</a>"},{"reply":"@slhck <code>-b:v</code> adalah sintaks saat ini untuk menyatakan bitrate video. <code>-vb</code> akan bekerja untuk versi FFmpeg yang lebih lama dan mungkin masih dipetakan ke <code>-b:v</code>. Saya tidak yakin apa yang menyebabkan pesan &quot;parameter salah&quot; Anda tanpa mengetahui perintah Anda, tetapi mulailah dengan perintah sederhana. Anda mungkin tidak membutuhkan <code>-minrate</code> dan <code>-maxrate</code>.","author":"<a href=\"https://superuser.com/users/110524/llogan\" target=\"_blank\" rel=\"nofollow noopener\">llogan</a>"},{"reply":"@LordNeckbeard Saya kira yang Anda maksud adalah saya;). Terima kasih kepada semua orang, saya pikir saya mendapatkan apa yang saya butuhkan sekarang.","author":"<a href=\"https://superuser.com/users/114557/sjngm\" target=\"_blank\" rel=\"nofollow noopener\">sjngm</a>"}]}]}
