{"title":"Rsyslog: cara memisahkan log masuk dengan alamat IP","draft":false,"url":"/rsyslog-cara-memisahkan-log-masuk-dengan-alamat-ip-4z1r4jrf","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["syslog"],"snippet":"Saya mencoba menyiapkan Rsyslog dengan konfigurasi berikut:Saya mendengarkan port 514 untuk menerima data dari host yang berbeda: 172.16.111.222, 172.16.111.111 dan 172.16.222.111. Dan saya ingin menyimpan log itu di folder yang berbeda...","body":"<p> Saya mencoba menyiapkan Rsyslog dengan konfigurasi berikut:\nSaya mendengarkan port 514 untuk menerima data dari host yang berbeda: 172.16.111.222, 172.16.111.111 dan 172.16.222.111. Dan saya ingin menyimpan log itu di folder yang berbeda untuk setiap host.\nJadi saya melakukan conf ini: </p> <pre><code>$ModLoad imudp\n\n\n$Ruleset RemoteConnections\n$RulesetCreateMainQueue on\n$ActionQueueType LinkedList\n$ActionQueueFileName dbremotecons\n$ActionResumeRetryCount -1\n*.* ~\n\n\n$InputUDPServerBindRuleset RemoteConnections\n$UDPServerRun 514\n\nif $fromhost-ip=='172.16.111.222' then /var/log/prod1/%FROMHOST-IP%/%syslogfacility-text%.log\n&amp; ~\nif $fromhost-ip=='172.16.111.111' then /var/log/prod1/%FROMHOST-IP%/%syslogfacility-text%.log\n&amp; ~\n\nif $fromhost-ip=='172.16.222.111' then /var/log/product2/%FROMHOST-IP%/%syslogfacility-text%.log\n&amp; ~\n</code></pre> <p> Sayangnya, ini tidak berfungsi, rsyslog tidak mencatat apa pun.\nSaya tidak yakin apa artinya &quot;&amp; ~&quot;, saya menemukannya di internet. </p>\n\n<p> Ada ide untuk membuatnya berhasil? </p>","source":"https://superuser.com/questions/1002856/rsyslog-how-to-separate-incoming-logs-with-ip-addresses","author":"<a href=\"https://superuser.com/users/505579/ctaf\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">ctaf</span></a>","replies":[],"answers":[{"answer":"<p> Anda tidak dapat menggunakan placeholder secara langsung di aturan. Gunakan template sebagai gantinya. Berikut ini seharusnya bekerja: </p> <pre><code>$template DynaFile,\"/var/log/%FROMHOST-IP%/%syslogfacility-text%.log\"\n*.* -?DynaFile\n</code></pre> <p> Atau, agar lebih dekat dengan kode Anda: </p> <pre><code>$template prod1,\"/var/log/prod1/%FROMHOST-IP%/%syslogfacility-text%.log\"\n$template prod2,\"/var/log/prod2/%FROMHOST-IP%/%syslogfacility-text%.log\"\nif $fromhost-ip=='172.16.111.111' then ?prod1\nif $fromhost-ip=='172.16.111.222' then ?prod1\nif $fromhost-ip=='172.16.222.111' then ?prod2\n</code></pre>","votes":"4","source":"https://superuser.com/a/1127769","author":"<a href=\"https://superuser.com/users/644724/mozsalles\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">MOzSalles</span></a>","replies":[]},{"answer":"<p> &quot;~&quot; berarti buang atau hentikan, yang merupakan rsyslog &quot; <a href=\"http://www.rsyslog.com/doc/v8-stable/configuration/actions.html?highlight=discard\" rel=\"nofollow noopener\" target=\"_blank\"> tindakan </a> &quot;. </p>\n\n<p> Begitu: </p> <pre><code>if $fromhost-ip=='172.16.111.222' then /var/log/prod1/%FROMHOST-IP%/%syslogfacility-text%.log\n&amp; ~\n</code></pre> <p> berarti jika pernyataan &quot;jika ... maka ...&quot; berfungsi, yaitu kondisi terpenuhi dan pesan dimasukkan ke dalam file, maka hentikan - jangan lanjutkan lebih jauh. </p>","votes":"2","source":"https://superuser.com/a/1264264","author":"<a href=\"https://superuser.com/users/301697/wei-wang\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Wei Wang</span></a>","replies":[]}]}
