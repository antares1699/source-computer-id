{"title":"Jika shell default tidak kompatibel dengan bash, mengapa skrip bash tidak berfungsi dengan baik?","draft":false,"url":"/jika-shell-default-tidak-kompatibel-dengan-bash-mengapa-skrip-bash-tidak-berfungsi-dengan-baik-opufqkyj","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["bash","shell-script","fish","chsh"],"snippet":"Kerang default saya adalah ikan, karena jauh lebih enak. Tetapi seringkali ketika saya menjalankan skrip, saya mendapatkan kesalahan yang sepertinya berasal dari skrip bash yang sedang diproses oleh ikan. Saya pikir ini...","body":"<p> Kerang default saya adalah ikan, karena jauh lebih enak. Tetapi seringkali ketika saya menjalankan skrip, saya mendapatkan kesalahan yang sepertinya berasal dari skrip bash yang sedang diproses oleh ikan. Saya pikir ini karena penulis skrip berasumsi bahwa shell default adalah bash, tetapi saya tidak memahami mekanismenya. </p>\n\n<p> Misalnya, skrip install.sh CrashPlan dimulai dengan bash shebang: </p> <pre><code>~/CrashPlan-install&gt; head install.sh\n#!/bin/bash\n\n#############################################################\n# Linux Client Installer Script\n#############################################################\n</code></pre> <p> Jadi ketika saya menjalankan <code>./install.sh</code> itu harus diproses oleh bash, bukan? Shell terminal default seharusnya tidak relevan. Namun, ketika shell default saya adalah fish, menjalankan skrip seperti ini menyebabkan fish mengembalikan kesalahan, seolah memproses skrip: </p> <pre><code>fish: Expected a command name, got token of type “Run job in background”. Did you mean\n “COMMAND; and COMMAND”? See the help section for the “and” builtin command by typing “help and”.\nStandard input: sed -imod \"s|Exec=.*|Exec=/usr/local/crashplan/bin/CrashPlanDesktop|\" \n /home/username/Desktop/CrashPlan.desktop &amp;&amp; rm -rf /home/username/Desktop/CrashPlan.desktopmod \n</code></pre> <p> Apakah ini karena kesalahan konfigurasi komputer saya atau karena skrip ditulis dengan cara yang tidak portabel? </p>","source":"https://superuser.com/questions/506613/when-default-shell-is-not-bash-compatible-why-do-bash-scripts-not-work-well","author":"<a href=\"https://superuser.com/users/13889/endolith\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">endolith</span></a>","replies":[],"answers":[{"answer":"<blockquote>\n  <p> Jadi ketika saya menjalankan <code>./install.sh</code> itu harus diproses oleh bash, bukan? </p>\n</blockquote>\n\n<p> Memang. Itulah gunanya shebang. </p>\n\n<h3 class=\"h5\"> Penyelesaian masalah </h3>\n\n<ul>\n<li><p> Simpan yang berikut ini sebagai <code>test.sh</code> dan coba jalankan dari ikan. </p> <pre><code>#!/bin/bash\n\ntrue &amp;&amp; true\n</code></pre> <p> Ini berfungsi di komputer saya, dan seharusnya di komputer Anda. </p></li>\n<li><p> Periksa apakah baris pertama <code>install.sh</code> hanya berisi karakter <code>#!/bin/bash</code>. </p>\n\n<p> Karakter yang tidak terlihat (seperti pemecah baris CR) dapat membingungkan ikan. </p></li>\n<li><p> Lari </p> <pre><code>/bin/bash --version\n</code></pre> <p> untuk memeriksa bahwa bash sebenarnya adalah bash dan belum diganti / dimodifikasi secara diam-diam dari waktu ke waktu. </p></li>\n</ul>\n\n<h3 class=\"h5\"> install.sh </h3>\n\n<p> <code>$SRC_USER</code> hanyalah sinonim yang dibuat skrip untuk <code>$SUDO_USER</code>. </p>\n\n<p> Akibatnya, ketika skrip dijalankan dengan hak akses root, perintah tersebut </p> <pre><code>su ${SRC_USER} -c \"sed -imod \\\"s|Exec=.*|Exec=${GUISCRIPT}|\\\" ${DESKTOP_LAUNCHER} &amp;&amp; rm -rf ${DESKTOP_LAUNCHER}mod\"\n</code></pre> <p> secara otomatis menggunakan shell default pengguna sudo, yaitu ikan. </p>\n\n<p> Untuk mengesampingkan default ini, tambahkan instruksi <code>-s /bin/bash</code> ke perintah <code>su</code>. </p>","votes":"6","source":"https://superuser.com/a/506646","author":"<a href=\"https://superuser.com/users/101836/dennis\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Dennis</span></a>","replies":[{"reply":"<code>.&#47;test.sh</code> berjalan dengan baik, tidak menghasilkan kesalahan, dan hex dump test.sh dan install.sh identik untuk 13 byte pertama. Dan ya, ini <code>GNU bash, version 4.2.24(1)-release</code>. Ada hubungannya dengan bagian <code>Exec=</code> dari skrip install.sh?","author":"<a href=\"https://superuser.com/users/13889/endolith\" target=\"_blank\" rel=\"nofollow noopener\">endolith</a>"},{"reply":"Mungkin, tapi sulit untuk membedakannya di luar konteks. Bisakah Anda memposting <code>install.sh</code> di sini atau, jika terlalu panjang, di Pastebin?","author":"<a href=\"https://superuser.com/users/101836/dennis\" target=\"_blank\" rel=\"nofollow noopener\">Dennis</a>"},{"reply":"<a href=\"http://pastebin.com/xAZM1BgF\" rel=\"nofollow noopener\" target=\"_blank\"> pastebin.com/xAZM1BgF </a> Oh tidak, sekarang saya melihat &quot;Exec&quot; adalah bagian dari file <code>.desktop</code> yang dibuat oleh skrip, bukan bagian dari skrip itu sendiri.","author":"<a href=\"https://superuser.com/users/13889/endolith\" target=\"_blank\" rel=\"nofollow noopener\">endolith</a>"},{"reply":"Sejujurnya saya tidak mengerti: ikan tidak dapat menangani salah satu dari perintah if, jadi mengapa menunggu sampai garis sed tersedak? Apa yang terjadi jika Anda menjalankan <code>bash install.sh</code>?","author":"<a href=\"https://superuser.com/users/101836/dennis\" target=\"_blank\" rel=\"nofollow noopener\">Dennis</a>"},{"reply":"hal yang sama terjadi dengan <code>sudo install.sh</code> atau <code>bash install.sh</code>. Ada hubungannya dengan <code>su ${SRC_USER}</code>? Tapi shell default root adalah bash.","author":"<a href=\"https://superuser.com/users/13889/endolith\" target=\"_blank\" rel=\"nofollow noopener\">endolith</a>"},{"reply":"Saya pikir Anda mengerti. <code>su</code> menjalankan perintah menggunakan shell <code>SRC_USER</code>, yang jika saya benar, tepatnya bukan <code>root</code>. Coba ganti <code>su</code> dengan <code>su -s &#47;bin&#47;bash</code>.","author":"<a href=\"https://superuser.com/users/101836/dennis\" target=\"_blank\" rel=\"nofollow noopener\">Dennis</a>"},{"reply":"Ya, saya pikir itu adalah perintah <code>su</code>. Saya telah membuat pengguna <code>fishy</code> dengan ikan sebagai cangkang defaultnya. Dari bash, <code>su fishy &quot;true &amp;&amp; true&quot;</code> menghasilkan error. <code>su fishy -s &#47;bin&#47;bash -c &quot;true &amp;&amp; true&quot;</code> berfungsi dengan baik.","author":"<a href=\"https://superuser.com/users/101836/dennis\" target=\"_blank\" rel=\"nofollow noopener\">Dennis</a>"},{"reply":"mengagumkan, sepertinya sudah memperbaikinya. dapatkah Anda memasukkannya ke dalam jawaban Anda sebelum saya menerimanya?","author":"<a href=\"https://superuser.com/users/13889/endolith\" target=\"_blank\" rel=\"nofollow noopener\">endolith</a>"},{"reply":"Senang untuk itu. Saya telah memperbarui jawaban saya.","author":"<a href=\"https://superuser.com/users/101836/dennis\" target=\"_blank\" rel=\"nofollow noopener\">Dennis</a>"}]}]}
