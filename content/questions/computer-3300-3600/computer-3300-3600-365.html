{"title":"Skalakan hamparan tanda air menurut ukuran video dengan ffmpeg","draft":false,"url":"/skalakan-hamparan-tanda-air-menurut-ukuran-video-dengan-ffmpeg-ihjbz2aj","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["video","ffmpeg","watermark","overlay"],"snippet":"Saya ingin mengubah ukuran watermark menjadi 5% dari lebar video.  Saya butuh sesuatu seperti itu:  ffmpeg -i 1.mp4 -i logo.png -filter_complex \"[1:v] scale=1_MP4_VIDEO_WIDTH*0.05:-1 [logo1]; [0:v][logo1] overlay=0:0\" -y -b 1600k -c:v libx264 -profile...","body":"<p> Saya ingin mengubah ukuran watermark menjadi 5% dari lebar video. </p>\n\n<p> Saya butuh sesuatu seperti itu: </p> <pre><code>ffmpeg -i 1.mp4 -i logo.png -filter_complex \"[1:v] scale=1_MP4_VIDEO_WIDTH*0.05:-1 [logo1]; [0:v][logo1] overlay=0:0\" -y -b 1600k -c:v libx264 -profile high -level 4.1 -c:a libfaac -q:a 128k 2.mp4\n</code></pre> <p> Bagaimana saya bisa mereferensikan lebar video? </p>","source":"https://superuser.com/questions/809820/scale-watermark-overlay-by-video-size-with-ffmpeg","author":"<a href=\"https://superuser.com/users/298993/face\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">face</span></a>","replies":[],"answers":[{"answer":"<p> Dengan asumsi lingkungan linux (atau cygwin di windows), satu-satunya cara yang saya temukan adalah dengan menjalankan 2 perintah. </p>\n\n<p> Pertama untuk mendapatkan ukuran video utama dan menghitungnya (catatan: <code>x/20 == x*0.05</code>: </p> <pre><code>val=`ffmpeg.exe -i 1.mp4 2&gt;&amp;1 | grep Video: | sed 's_.*, \\([0-9]*x[0-9]*\\) .*_\\1_' | awk 'BEGIN {FS=\"x\"} {print int($1/20)\"x\"int($2/20)}'`\n</code></pre> <p> Kedua untuk mengukur dan menghamparkan video </p> <pre><code>ffmpeg -i 1.mp4 -i logo.png -filter_complex \"[1:v] scale=$val [logo1]; [0:v][logo1] overlay=0:0\" -y -b 1600k -c:v libx264 -profile high -level 4.1 -c:a libfaac -q:a 128k 2.mp4\n</code></pre> <p> Juga, Anda bisa mengganti <code>$val</code> pada baris kedua dengan ekspresi pertama (termasuk kutipan balik) dan mendapatkan hasil yang sama, tetapi saya merasa sedikit lebih mudah untuk membaca perintah pemisahan menjadi dua. </p>","votes":"3","source":"https://superuser.com/a/809878","author":"<a href=\"https://superuser.com/users/354491/nuttyx\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">NuTTyX</span></a>","replies":[{"reply":"Karena sepertinya tidak ada budaya lain, saya terima milik Anda. Terima kasih!","author":"<a href=\"https://superuser.com/users/298993/face\" target=\"_blank\" rel=\"nofollow noopener\">face</a>"}]},{"answer":"<p> Ini sekarang dapat dilakukan secara langsung menggunakan filter <code>scale2ref</code>. </p> <pre><code>ffmpeg -i 1.mp4 -i logo.png \\\n-filter_complex \"[1:v][0:v]scale2ref=iw*0.05:-1[logo1][base]; \\\n [base][logo1]overlay=0:0[v]\" \\\n-map [v] -map 0:a -y -b:v 1600k -c:v libx264 -profile high -level 4.1 \\\n-c:a libfaac -b:a 128k 2.mp4\n</code></pre>","votes":"8","source":"https://superuser.com/a/1053647","author":"<a href=\"https://superuser.com/users/114058/gyan\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Gyan</span></a>","replies":[{"reply":"Hei, perintah Anda berfungsi dan terima kasih, tetapi itu tidak mempertahankan rasio aspek tanda air, itu merentangkannya ke ukuran video. Bagaimana memperbaikinya ?","author":"<a href=\"https://superuser.com/users/682699/emad-ghasemi\" target=\"_blank\" rel=\"nofollow noopener\">Emad Ghasemi</a>"},{"reply":"@EmadGhasemi jika Anda ingin rasio aspek. pertama Anda harus menghitung rasio watermark (tinggi / lebar). Kemudian ubah ini [1: v] [0: v] scale2ref = iw * 0.05: (iw * 0.05) * watermark_ratio [logo1] [base]","author":"<a href=\"https://superuser.com/users/183129/mollyjane\" target=\"_blank\" rel=\"nofollow noopener\">mollyjane</a>"},{"reply":"Lihat komentar saya dalam jawaban ini di sini: <a href=\"https://superuser.com/a/1100429/85904\" target=\"_blank\" rel=\"nofollow noopener\"> superuser.com/a/1100429/85904 </a> Anda sekarang dapat melakukan ini dengan satu perintah","author":"<a href=\"https://superuser.com/users/85904/bhh1988\" target=\"_blank\" rel=\"nofollow noopener\">bhh1988</a>"},{"reply":"Saya mendapatkan video 45 mb yang sebelumnya 5 mb","author":"<a href=\"https://superuser.com/users/349172/pratik-butani\" target=\"_blank\" rel=\"nofollow noopener\">Pratik Butani</a>"}]},{"answer":"<p> Sedangkan untuk Windows, saya menemukan metode berikut menggunakan ffprobe dan ffmpeg. Berikut adalah kode file bat: </p> <pre><code>@echo off\n   SetLocal EnableExtensions EnableDelayedExpansion\n\n   for %%a in (\"*.mp4\") do (\n      For /F \"usebackq\" %%I In (`ffprobe -v error -show_entries stream\"=\"width -of default\"=\"noprint_wrappers\"=\"1:nokey\"=\"1 \"%%~a\"`) Do (\n\n      Set V=%%~I\n      ffmpeg -i \"%%a\" -i logo.png -b:v 1M -filter_complex \"[1:v]scale=(SCALE_FACTOR*!V!):-1 [wm]; [0:v][wm] overlay=x=(main_w-overlay_w):y=(main_h-overlay_h)\" -y -v 2 \"new\\%%~na.mp4\"\n)\n</code></pre> <p> ) </p>\n\n<p> Di sini SLACE_FACTOR adalah lebar gambar hamparan yang dibagi menjadi beberapa lebar file video referensi (misalnya, 320px / 1280px). </p>","votes":"1","source":"https://superuser.com/a/1053634","author":"<a href=\"https://superuser.com/users/571524/fk\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">F&#39;K</span></a>","replies":[{"reply":"Saya rasa tanda kurung kiri dan kanan tidak cocok dengan kode.","author":"<a href=\"https://superuser.com/users/493903/techraf\" target=\"_blank\" rel=\"nofollow noopener\">techraf</a>"}]}]}
