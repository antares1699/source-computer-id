{"title":"antarmuka macvtap yang dibuat di atas antarmuka macvlan dari kontainer Docker tidak dapat berkomunikasi","draft":false,"url":"/antarmuka-macvtap-yang-dibuat-di-atas-antarmuka-macvlan-dari-kontainer-docker-tidak-dapat-berkomunikasi-vnxcj5wu","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["linux","networking","docker","container"],"snippet":"Saya memiliki kasus penggunaan di mana saya membuat jaringan Docker macvlan (mode jembatan default) &amp; menghubungkan jaringan ini ke wadah Docker yang sedang berjalan (misalnya C1). Jadi wadah akan memiliki antarmuka macvlan...","body":"<p> Saya memiliki kasus penggunaan di mana saya membuat jaringan Docker macvlan (mode jembatan default) &amp; menghubungkan jaringan ini ke wadah Docker yang sedang berjalan (misalnya C1). Jadi wadah akan memiliki antarmuka macvlan baru (misalnya eth1). </p> <pre><code>docker network create -d macvlan --subnet=172.16.16.0/24 --gateway=172.16.16.1 -o parent=ens224 macvlan-ens224\ndocker network connect macvlan-ens224 C1\n</code></pre> <p> Di dalam container C1, saya membuat antarmuka macvtap menggunakan antarmuka macvlan (eth1) &amp; IP yang ditetapkan. </p> <pre><code>ip link add link eth1 name mymacvtap0 type macvtap mode private\nip addr add 172.17.17.2/24 dev mymacvtap0\nip link set up dev mymacvtap0\n</code></pre> <p> Sekarang, Ketika saya melakukan ping ke beberapa IP subnet 172.17.17.2/24 dari dalam kontainer, permintaan ARP disiarkan menggunakan alamat MAC sumber antarmuka macvtap kontainer. Target IP mengirimkan balasan ARP. Balasan ARP mencapai antarmuka fisik ens224 (dilihat dari tcpdump). Tapi Balasan tidak pernah sampai ke dalam wadah. </p>\n\n<p> Seseorang tolong tunjukkan apa yang saya lewatkan di sini? </p>","source":"https://superuser.com/questions/1205346/macvtap-interface-created-on-top-of-macvlan-interface-of-a-docker-container-cann","author":"<a href=\"https://superuser.com/users/178464/xemx\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">XemX</span></a>","replies":[],"answers":[{"answer":"<p> ini adalah skema utama bagaimana driver macvlan bekerja: </p> <pre><code>                                    +---------------+\n                                    | network stack |\n                                    +---------------+\n                                        |  |  |  |\n                              +---------+  |  |  +------------------+\n                              |            |  +------------------+  |\n                              |            +------------------+  |  |\n                              |                               |  |  |\n                              |            aa  +----------+   |  |  |\n                              | eth0     +-----| macvlan0 |---+  |  |\n                              |         /      +----------+      |  |\n Wire   +------+       +---------------+   bb  +----------+      |  |\n--------| eth0 |------/ if dst mac is /--------| macvlan1 |------+  |\n        +------+     +---------------+ \\       +----------+         |\n                                        \\  cc  +----------+         |\n                                         +-----| macvlan2 |---------+\n                                               +----------+\n</code></pre> <p> Seperti yang dapat Anda lihat, jenis antarmuka ini bekerja dengan prinsip berikut:\nitu mendengarkan pada kartu jaringan fisik dan hanya menangkap alamat-mac sendiri. </p>\n\n<p> Jika Anda akan menambahkan antarmuka lain di bagian bawah macvlan. Misalnya bridge atau antarmuka macvlan / macvtap lainnya, ini akan mentransfer lalu lintas apa pun darinya ke jaringan eksternal, tetapi bukan sisi sebaliknya. Karena itu menangkap lalu lintas hanya untuk alamat-mac sendiri. </p>\n\n<p> Untuk mengatasi masalah Anda, Anda harus menggunakan linux bridge dan menghubungkan container Anda ke bridge melalui pasangan veth-interfaces. </p>\n\n<p> Anda harus menggunakan antarmuka macvlan / macvtap hanya jika itu titik akhir. </p>\n\n<p> Di sini Anda bisa mendapatkan info lebih lanjut tentang jenis antarmuka ini: </p>\n\n<ul>\n<li><a href=\"http://suhu0426.github.io/Web/Presentation/20150203/index.html#macvlan\" rel=\"nofollow noopener\" target=\"_blank\"> Jaringan virtual: TUN / TAP, MacVLAN, dan MacVTap </a></li>\n<li><a href=\"https://superuser.com/a/765078/327550\" target=\"_blank\" rel=\"nofollow noopener\"> Cara menyiapkan jaringan virtual <code>veth</code> </a></li>\n</ul>","votes":"6","source":"https://superuser.com/a/1243630","author":"<a href=\"https://superuser.com/users/327550/kvaps\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">kvaps</span></a>","replies":[{"reply":"tautan pertama tidak dapat diakses.","author":"<a href=\"https://superuser.com/users/858540/allenwang\" target=\"_blank\" rel=\"nofollow noopener\">allenwang</a>"}]}]}
