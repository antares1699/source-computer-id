{"title":"Fungsi Powershell mana yang dapat memeriksa apakah port tertentu dalam status MENDENGARKAN di localhost?","draft":false,"url":"/fungsi-powershell-mana-yang-dapat-memeriksa-apakah-port-tertentu-dalam-status-mendengarkan-di-localhost-65vi6wlw","votes":"4","answers_count":"5","categories":["Komputer"],"tags":["windows","powershell","port","localhost"],"snippet":"pengantar  Tujuan:  untuk memeriksa apakah port ada di LISTENING state on localhost dengan menggunakan fungsi PowerShell  Perintah berikut:  New-Object Net.Sockets.TcpClient.Connect(\"127.0.0.1\",10389)  menghasilkan:  PS C:\\Windows\\system32&gt; New-Object Net.Sockets.TcpClient.Connect(\"127.0.0.1\",10389)At line:1 char:33+ New-Object Net.Sockets.TcpClient.Connect(\"127.0.0.1\",10389)+...","body":"<p><strong> pengantar </strong></p>\n\n<p><strong> Tujuan: </strong> untuk memeriksa apakah port ada di <code>LISTENING state on localhost</code> dengan menggunakan fungsi PowerShell </p>\n\n<p> Perintah berikut: </p>\n\n<p> <code>New-Object Net.Sockets.TcpClient.Connect(\"127.0.0.1\",10389)</code> </p>\n\n<p> menghasilkan: </p> <pre><code>PS C:\\Windows\\system32&gt; New-Object Net.Sockets.TcpClient.Connect(\"127.0.0.1\",10389)\nAt line:1 char:33\n+ New-Object Net.Sockets.TcpClient.Connect(\"127.0.0.1\",10389)\n+                                 ~\nUnexpected token ')' in expression or statement.\n    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException\n    + FullyQualifiedErrorId : UnexpectedToken\n\nPS C:\\Windows\\system32&gt;\n</code></pre> <p><strong> Pertanyaan </strong></p>\n\n<p> Fungsi PowerShell mana yang dapat digunakan untuk memeriksa apakah port tertentu dalam status MENDENGARKAN di localhost? </p>","source":"https://superuser.com/questions/770022/which-powershell-function-could-check-whether-a-certain-port-is-in-listening-sta","author":"<a href=\"https://superuser.com/users/313985/030\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">030</span></a>","replies":[{"reply":"Apakah Anda mencoba untuk melihat apakah port pada mesin lokal dalam status MENDENGARKAN, atau Anda mencoba untuk menangkap kesalahan ketika TCPClient.Connect gagal menyambung ke host? Ini adalah dua hal yang sangat berbeda. :) PS: coba tambahkan tanda kurung: <code>(New-Object Net.Sockets.TcpClient).Connect(&quot;127.0.0.1&quot;,10389)</code>, karena ini akan mengubah urutan operasi dan membuat instance objek soket baru sebelum memanggil Connect. Atau bagi menjadi dua perintah terpisah menggunakan variabel.","author":"<a href=\"https://superuser.com/users/23133/%c6%ac%e1%b4%87c%ca%9c%ce%b9%e1%b4%87007\" target=\"_blank\" rel=\"nofollow noopener\">&#x1AC;&#x1D07;c&#x29C;&#x3B9;&#x1D07;007</a>"},{"reply":"Pertanyaan telah diperbarui.","author":"<a href=\"https://superuser.com/users/313985/030\" target=\"_blank\" rel=\"nofollow noopener\">030</a>"}],"answers":[{"answer":"<p> Jika Anda menggunakan PowerShell v3.0 + di Windows 8 / Server 2012 atau lebih baru, alih-alih mencoba menyambungkan ke port untuk menentukan status, Anda cukup menggunakan <a href=\"http://technet.microsoft.com/en-us/library/hh826153.aspx\" rel=\"nofollow noopener\" target=\"_blank\"> <code>Get-NetTCPConnection</code> </a> : </p>\n\n<p> <code>Get-NetTCPConnection -State Listen</code> </p>\n\n<p> Bagi saya ini lebih akurat karena membaca status port di komputer. Menggunakan koneksi untuk menguji dapat membuatnya tampak seperti tidak &quot;MENDENGARKAN&quot; saat itu, jika firewall atau sejenisnya menghalangi atau sesuatu. </p>","votes":"8","source":"https://superuser.com/a/770030","author":"<a href=\"https://superuser.com/users/23133/%c6%ac%e1%b4%87c%ca%9c%ce%b9%e1%b4%87007\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Ƭᴇcʜιᴇ007</span></a>","replies":[{"reply":"<code>Get-NetTCPConnection –LocalPort 10389</code> berfungsi sempurna di Windows8. Terima kasih.","author":"<a href=\"https://superuser.com/users/313985/030\" target=\"_blank\" rel=\"nofollow noopener\">030</a>"}]},{"answer":"<p> Pertama buat dan simpan koneksi: </p> <pre><code>$connection = (New-Object Net.Sockets.TcpClient)\n$connection.Connect(\"127.0.0.1\",10389)\n</code></pre> <p> Kemudian periksa apakah sudah terhubung </p> <pre><code>if ($connection.Connected) {\n    \"We're connected\"\n    }\n</code></pre> <p> Atau seperti yang disarankan oleh Colyn1337 </p> <pre><code>Try {\n    $connection = (New-Object Net.Sockets.TcpClient)\n    $connection.Connect(\"127.0.0.1\",10389)\n    \"Connected\"\n    }\nCatch {\n    \"Can't Connect\"\n    }\n</code></pre>","votes":"2","source":"https://superuser.com/a/770027","author":"<a href=\"https://superuser.com/users/326171/tim-ferrill\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Tim Ferrill</span></a>","replies":[{"reply":"Saya akan merekomendasikan menggunakan blok coba / tangkap / akhirnya untuk menangani kesalahan penghentian jika koneksi ditolak.","author":"<a href=\"https://superuser.com/users/246976/colyn1337\" target=\"_blank\" rel=\"nofollow noopener\">Colyn1337</a>"},{"reply":"PS C: \\ Windows \\ system32&gt;. &quot;C: \\ path \\ to \\ file.ps1&quot; PS Terhubung C: \\ Windows \\ system32&gt; net stop apacheds Layanan apacheds berhenti. Layanan apached berhasil dihentikan. PS C: \\ Windows \\ system32&gt;. &quot;C: \\ path \\ to \\ file.ps1&quot; Tidak Dapat Menghubungkan PS C: \\ Windows \\ system32&gt; Bekerja dengan baik. Terima kasih","author":"<a href=\"https://superuser.com/users/313985/030\" target=\"_blank\" rel=\"nofollow noopener\">030</a>"}]},{"answer":"<p> Saya telah mencoba menambahkan ini ke jawaban teknisi, jadi ini adalah perluasannya. Anda dapat menyesuaikan hasilnya seperti ini: </p> <pre><code>Get-NetTCPConnection -State Listen | Where-Object {$_.LocalAddress -eq \"192.168.56.1\" -and $_.LocalPort -eq \"139\"}\n</code></pre> <p> Itu akan mengembalikan array data jika itu mendengarkan di port itu. Jika tidak ada listener, ia akan mengembalikan null dan oleh karena itu tidak perlu penanganan error. </p>","votes":"1","source":"https://superuser.com/a/770035","author":"<a href=\"https://superuser.com/users/246976/colyn1337\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Colyn1337</span></a>","replies":[]},{"answer":"<p> saya siap untuk memberikan salah satu jawaban Get-NetTCPConnection, setelah semua itu bekerja pada mesin saya. Sayangnya itu tidak berfungsi pada server Windows 2008 yang menjalankan Powershell 3.0 yang harus melakukan pemeriksaan. </p>\n\n<p> Namun berikut ini bekerja dengan sempurna </p>\n\n<p> <code>([Net.NetworkInformation.IPGlobalProperties]::GetIPGlobalProperties()).GetActiveTcpListeners() | Where Port -EQ 10389</code> </p>","votes":"1","source":"https://superuser.com/a/897081","author":"<a href=\"https://superuser.com/users/192746/rob\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">rob</span></a>","replies":[]},{"answer":"<p> Jika Anda memeriksa bahwa nomor Port sudah terisi atau tidak, maka normal jika -eq &quot;$ null&quot; tidak berfungsi: </p>\n\n<p> Misalnya jika Anda menjalankan perintah berikut </p> <pre><code>$PortNumberOutPut = Get-NetTCPConnection | where Localport -eq $portNumber\n</code></pre> <p> Anda ingin memeriksa apakah variabel nol </p> <pre><code>if (!$PortNumberOutPut) { Write-Host \"variable is null\" }\n</code></pre> <p> Dan jika Anda ingin memeriksa apakah $ PortNumberOutPut memiliki nilai apa pun kecuali $ null </p> <pre><code>if ($PortNumberOutPut) { Write-Host \"variable is NOT null\" }\n</code></pre>","votes":"1","source":"https://superuser.com/a/1450963","author":"<a href=\"https://superuser.com/users/337753/rudresh-bhatt\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Rudresh Bhatt</span></a>","replies":[]}]}
