{"title":"Kesalahan runtime Fungsi VBA Excel 1004: Kesalahan yang ditentukan aplikasi atau ditentukan objek","draft":false,"url":"/kesalahan-runtime-fungsi-vba-excel-1004-kesalahan-yang-ditentukan-aplikasi-atau-ditentukan-objek-gsnkxjji","votes":"4","answers_count":"4","categories":["Komputer"],"tags":["microsoft-excel","vba"],"snippet":"Saya mencoba mempelajari fungsi untuk tujuan menyederhanakan dan menggunakan kembali kode kapan pun diperlukan.  Saya mulai dengan mengubah sesuatu yang sering saya gunakan menjadi sebuah fungsi: Mengembalikan nilai integer dari kolom tidak...","body":"<p> Saya mencoba mempelajari fungsi untuk tujuan menyederhanakan dan menggunakan kembali kode kapan pun diperlukan. </p>\n\n<p> Saya mulai dengan mengubah sesuatu yang sering saya gunakan menjadi sebuah fungsi: Mengembalikan nilai integer dari kolom tidak kosong terakhir dalam spreadsheet. </p> <pre><code>Function FindLastDataLine(strColName As String) As Long\n    FindLastDataLine = Range(strColName).Offset(Rows.Count - 1, 0).End(xlUp).Row\nEnd Function\n\nSub PracticeMacro()\n    intItemCount = FindLastDataLine(\"A:A\")\n    MsgBox (\"There are \" &amp; intItemCount &amp; \" rows of data in column A.\")\nEnd Sub\n</code></pre> <p> Ketika saya menjalankan ini, saya menerima kesalahan runtime &#39;1004&#39; &quot;Kesalahan yang ditentukan aplikasi atau objek&quot; yang membantu membantu mendefinisikan sebagai &quot;kesalahan orang lain&quot; untuk mengutip tidak cukup kata demi kata. </p>\n\n<p> Di mana saya mungkin salah? </p>","source":"https://superuser.com/questions/301389/excel-vba-function-runtime-error-1004-application-defined-or-object-defined-err","author":"<a href=\"https://superuser.com/users/74026/music2myear\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">music2myear</span></a>","replies":[{"reply":"Selalu gunakan <code>Option Explicit</code> di bagian atas kode Anda, dan nyatakan variabel secara eksplisit. Saya tidak dapat menyatakan betapa pentingnya praktik itu sebagai programmer.","author":"<a href=\"https://superuser.com/users/6887/breakthrough\" target=\"_blank\" rel=\"nofollow noopener\">Breakthrough</a>"},{"reply":"Terima kasih @Breakthrough. Bertahun-tahun sejak komentar ini saya membiasakan diri melakukannya.","author":"<a href=\"https://superuser.com/users/74026/music2myear\" target=\"_blank\" rel=\"nofollow noopener\">music2myear</a>"}],"answers":[{"answer":"<p><strong> Mengapa metode Anda tidak berhasil: </strong> ada dua alasan disini. Yang pertama, ketika Anda meletakkan <code>Rows.Count</code>, tidak ada referensi untuk <code>Rows</code> - ini adalah properti dari <code>Range</code>. Untuk memperbaikinya, Anda hanya perlu mereferensikan kisaran yang sama seperti sebelumnya (tambahkan saja sebelum Anda memanggil <code>Rows.Count</code> seperti ini: </p> <pre><code>Function FindLastDataLine(strColName As String) As Long\n    FindLastDataLine = Range(strColName).Offset(Range(strColName).Rows.Count - 1, 0).End(xlUp).Row\nEnd Function\n</code></pre> <p> Alasan kedua adalah bahwa Anda menggunakan <code>Offset</code>. <code>Offset</code> secara harfiah menggeser <code>Range</code> dengan seberapa banyak Anda menceritakannya. Anda tidak ingin menggeser seluruh rentang sel, tetapi temukan sel terakhir dalam rentang tersebut. Anda dapat melakukan ini cukup hanya dengan mengubah <code>Offset</code> menjadi <code>Cells</code>, menghapus panggilan awal <code>Range()</code> (karena kita akan memilih satu sel), dan mengubah <code>0</code> ke kolom yang Anda inginkan. Namun, karena Anda meneruskan kolom sebagai <code>\"A:A\"</code>, itu tidak mungkin, jadi Anda harus menggantinya dengan <code>Range(strColName).Column</code> sebagai berikut: </p> <pre><code>Function FindLastDataLine(strColName As String) As Long\n    FindLastDataLine = Cells(Range(strColName).Rows.Count, Range(strColName).Column).End(xlUp).Row\nEnd Function\n</code></pre> <hr>\n\n<p><strong> Solusi yang lebih baik: </strong> solusi berikut akan bekerja pada semua versi terbaru MS Office (2003, 2007, dan 2010), dan akan menangani kesalahan. Anda menyebutnya dengan melewatkan huruf kolom, atau nomor kolom: </p> <pre><code>Function GetLastDataRow(col As Variant) As Long\n    GetLastDataRow = -1\n    If (IsNumeric(col) And col &gt;= 1) Or Len(col) &lt;= 2 Then\n        On Error Resume Next\n        GetLastDataRow = _\n            Cells(Cells(1, col).EntireColumn.Rows.Count, col).End(xlUp).Row\n        On Error GoTo 0\n    End If\nEnd Function\n</code></pre> <p> Berikut ini ilustrasi bagaimana Anda memanggil fungsi ini, dan beberapa contoh keluaran. Mari kita asumsikan bahwa seluruh lembar bersih, kecuali untuk beberapa data acak yang dimasukkan dalam sel <code>B1</code> hingga <code>B8</code> dan <code>B10</code> (<code>B9</code> dikosongkan). Perhatikan bahwa Anda tidak memasukkan kolom sebagai rentang, melainkan huruf kolom <em> atau </em> nomor kolom (nilai tidak valid mengembalikan -1): </p> <pre><code>GetLastDataRow(1)         =  1    GetLastDataRow(\"A\")       =  1\nGetLastDataRow(2)         = 10    GetLastDataRow(\"B\")       = 10\nGetLastDataRow(\"AX\")      =  1    GetLastDataRow(\"A:X\")     = -1\nGetLastDataRow(\"Oops...\") = -1    GetLastDataRow(200)       =  1\n</code></pre> <p> Sebagai catatan teknis, jika metode <code>Cells</code> gagal, diasumsikan bahwa input tidak valid, sehingga fungsi tersebut mengembalikan -1. Saya mendorong Anda untuk menggunakan praktik ini (mengembalikan nilai yang tidak valid jika inputnya tidak valid) dalam fungsi Anda, ini akan sangat membantu Anda untuk menghindari kesalahan di masa mendatang. </p>\n\n<p> Cara kerjanya, ia menemukan kemungkinan baris terakhir di kolom tertentu (tergantung pada versi MS Office Anda), dan kemudian menggunakan metode <code>End</code> untuk menemukan sel terakhir di kolom itu dengan data. </p>\n\n<hr>\n\n<p> Berikut adalah versi alternatif yang akan mengembalikan 0 jika semua sel di kolom itu kosong: </p> <pre><code>Function GetLastDataRow(col As Variant) As Long\n    GetLastDataRow = -1\n    If (IsNumeric(col) And col &gt;= 1) Or Len(col) &lt;= 2 Then\n        On Error Resume Next\n        If IsEmpty(Cells(Cells(1, col).EntireColumn.Rows.Count, col).End(xlUp).Value) Then\n            GetLastDataRow = 0\n        Else\n            GetLastDataRow = _\n                Cells(Cells(1, col).EntireColumn.Rows.Count, col).End(xlUp).Row\n        End If\n        On Error GoTo 0\n    End If\nEnd Function\n</code></pre> <p> Contoh keluaran: </p> <pre><code>GetLastDataRow(1)         =  0    GetLastDataRow(\"A\")       =  0\nGetLastDataRow(2)         = 10    GetLastDataRow(\"B\")       = 10\nGetLastDataRow(\"AX\")      =  0    GetLastDataRow(\"A:X\")     = -1\nGetLastDataRow(\"Oops...\") = -1    GetLastDataRow(200)       =  0\n</code></pre>","votes":"4","source":"https://superuser.com/a/317066","author":"<a href=\"https://superuser.com/users/6887/breakthrough\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Breakthrough</span></a>","replies":[{"reply":"Oke, maaf butuh waktu lama untuk kembali ke masalah ini, tapi ini dia. Sebuah pertanyaan: Mengacu pada bagian pertama dari jawaban Anda, jika saya melewati FindLastDataLine (&quot;A: 1&quot;) sistem saat ini akan bekerja karena menentukan sel satu yang kemudian dapat bekerja daripada rentang? Ini hanya berfokus pada bagian pertama agar saya dapat lebih memahami saran Anda.","author":"<a href=\"https://superuser.com/users/74026/music2myear\" target=\"_blank\" rel=\"nofollow noopener\">music2myear</a>"},{"reply":"Maaf, saya tidak begitu mengerti pertanyaan Anda ... <code>&quot;A:1&quot;</code> saja bukan kisaran yang valid. Sebelum fungsi kustom saya tulis, Anda harus meneruskan rentang yang valid sebagai string (mis. <code>A:A</code>, <code>A2:A15</code>, dll ...).","author":"<a href=\"https://superuser.com/users/6887/breakthrough\" target=\"_blank\" rel=\"nofollow noopener\">Breakthrough</a>"},{"reply":"Baik. Aku memahaminya. Terima kasih atas uraian menyeluruh tentang masalah dan solusinya.","author":"<a href=\"https://superuser.com/users/74026/music2myear\" target=\"_blank\" rel=\"nofollow noopener\">music2myear</a>"}]},{"answer":"<p> Anda menulis &quot;Mengembalikan nilai integer dari baris tidak kosong terakhir dalam spreadsheet.&quot; Tapi sepertinya Anda mencoba mendapatkan baris tidak kosong terakhir di kolom tertentu dari spreadsheet. </p>\n\n<p> Jika Anda mengubah fungsi Anda menjadi ini, saya pikir itu akan berhasil: </p> <pre><code>Function FindLastDataLine(strColName As String) As Long\n    FindLastDataLine = ActiveSheet.Cells(ActiveSheet.Rows.Count, strColName).End(xlUp).Row\nEnd Function\n</code></pre>","votes":"1","source":"https://superuser.com/a/317049","author":"<a href=\"https://superuser.com/users/35797/perryj\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">PerryJ</span></a>","replies":[{"reply":"Yeap ... tampaknya topik tersebut mengatakan satu hal, fungsi menamai hal lain ... dan kode itu sendiri adalah hal lain.","author":"<a href=\"https://superuser.com/users/68714/tiago-cardoso\" target=\"_blank\" rel=\"nofollow noopener\">Tiago Cardoso</a>"},{"reply":"Terima kasih, itu membuatku tertawa. Saya pikir komentar itu bisa berlaku untuk banyak pertanyaan.","author":"<a href=\"https://superuser.com/users/35797/perryj\" target=\"_blank\" rel=\"nofollow noopener\">PerryJ</a>"},{"reply":"Maaf, saya memang sedang mencari nilai integer dari sel non-hitam terakhir di kolom, bukan baris. Salahku.","author":"<a href=\"https://superuser.com/users/74026/music2myear\" target=\"_blank\" rel=\"nofollow noopener\">music2myear</a>"}]},{"answer":"<p> Ini mungkin tidak memperbaiki kesalahan Anda, tetapi akan mengembalikan ItemCount dalam kisaran ... </p> <pre><code>Function FindLastDataLine(strColName As String) As Long\n    FindLastDataLine = Evaluate(\"COUNTA(\" &amp; strColName &amp; \")\")\nEnd Function\n\nSub PracticeMacro()\n    intItemCount = FindLastDataLine(\"A:A\")\n    MsgBox (\"There are \" &amp; intItemCount &amp; \" rows of data in column A.\")\nEnd Sub\n</code></pre> <p> Perhatikan ada beberapa cara lain untuk memanggil fungsi COUNTA Excel ini ... </p>","votes":"1","source":"https://superuser.com/a/317050","author":"<a href=\"https://superuser.com/users/68714/tiago-cardoso\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Tiago Cardoso</span></a>","replies":[{"reply":"Ini tidak memperhitungkan kolom kosong, jadi ini bahkan tidak mendekati poster asli &quot;mengembalikan nilai integer dari baris tidak kosong terakhir dalam spreadsheet&quot;.","author":"<a href=\"https://superuser.com/users/6887/breakthrough\" target=\"_blank\" rel=\"nofollow noopener\">Breakthrough</a>"},{"reply":"Lihatlah apa yang tertulis di kotak pesan ... <code>MsgBox (&quot;There are &quot; &amp; intItemCount &amp; &quot; rows of data in column A.&quot;)</code>. AFAIK, COUNTA melakukan hal ini. Lihat @ komentar saya untuk posting @PerryJ.","author":"<a href=\"https://superuser.com/users/68714/tiago-cardoso\" target=\"_blank\" rel=\"nofollow noopener\">Tiago Cardoso</a>"},{"reply":"maaf, tidak melihatnya - keputusan bagus. Harus menyukai orang yang menggunakan nama yang sangat ambigu dalam kode mereka.","author":"<a href=\"https://superuser.com/users/6887/breakthrough\" target=\"_blank\" rel=\"nofollow noopener\">Breakthrough</a>"},{"reply":"NW. Saya percaya bahwa tujuan @ music2myear adalah untuk menguji keterampilannya daripada melakukan pengembangan khusus ... jadi saya kira dia memiliki kode &#39;default&#39; untuk menyesuaikannya lagi (tetapi tanpa memperbarui beberapa bagian yang dapat membantu kami, seperti kotak pesan).","author":"<a href=\"https://superuser.com/users/68714/tiago-cardoso\" target=\"_blank\" rel=\"nofollow noopener\">Tiago Cardoso</a>"},{"reply":"Saya sedang mengerjakan tugas tertentu. Ada makro yang sudah ada yang melakukan tugas dengan benar. Namun, metode ini menggunakan beberapa metode yang sangat tidak efisien. Tujuan saya adalah melalui dan membangun kembali makro untuk melakukan tugas dengan lebih efisien serta untuk menggulung beberapa proses pra-dan pasca-makro ke dalam makro itu sendiri. Proses ini berlaku untuk harus beralih dari tugas 5 menit yang terlibat menjadi tugas lepas tangan 30 detik.","author":"<a href=\"https://superuser.com/users/74026/music2myear\" target=\"_blank\" rel=\"nofollow noopener\">music2myear</a>"}]},{"answer":"<p> Mencoba: </p> <pre><code>FindLastDataLine = _\n     Range(strColName).Offset(ActiveSheet.Rows.Count - 1, 0).End(xlUp).Row\n</code></pre> <p> Baris adalah properti. </p>","votes":"0","source":"https://superuser.com/a/301407","author":"<a href=\"https://superuser.com/users/2394/lance-roberts\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Lance Roberts</span></a>","replies":[]}]}
