{"title":"Tambahkan baris ke file teks setelah baris tertentu dengan PowerShell","draft":false,"url":"/tambahkan-baris-ke-file-teks-setelah-baris-tertentu-dengan-powershell-gj0xickl","votes":"4","answers_count":"1","categories":["Komputer"],"tags":["command-line","powershell"],"snippet":"Saya harus mengedit dari jarak jauh file bernama nsclient.ini di ratusan komputer, file tersebut berisi beberapa definisi perintah. Sebagai contoh:  [/settings/external scripts/scripts]    check_event=\"C:\\Program Files\\NSClient++\\scripts\\Eventlog.exe\" -e System -t Errorcheck_event_application=\"C:\\Program Files\\NSClient++\\scripts\\Eventlog.exe\" -e Application...","body":"<p> Saya harus mengedit dari jarak jauh file bernama nsclient.ini di ratusan komputer, file tersebut berisi beberapa definisi perintah. Sebagai contoh: </p> <pre><code>[/settings/external scripts/scripts]    \ncheck_event=\"C:\\Program Files\\NSClient++\\scripts\\Eventlog.exe\" -e System -t Error\ncheck_event_application=\"C:\\Program Files\\NSClient++\\scripts\\Eventlog.exe\" -e Application -t Error\ncheck_activedir=cscript \"C:\\Program Files\\NSClient++\\scripts\\Check_AD.vbs\" //nologo\n</code></pre> <p> Saya perlu menambahkan baris baru tepat di bawah [/ settings / external scripts / scripts]\nBaris baru ini tidak boleh menimpa baris yang ada di bawahnya. </p>\n\n<p> Terima kasih atas bantuan Anda. </p>","source":"https://superuser.com/questions/821112/add-line-to-text-file-after-specific-line-with-powershell","author":"<a href=\"https://superuser.com/users/375486/thomasc\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">ThomasC.</span></a>","replies":[],"answers":[{"answer":"<p> Menggunakan cmdlet PowerShell asli: </p> <pre class=\"lang-powershell prettyprint-override\"><code># Set file name\n$File = '.\\nsclient.ini'\n\n# Process lines of text from file and assign result to $NewContent variable\n$NewContent = Get-Content -Path $File |\n    ForEach-Object {\n        # Output the existing line to pipeline in any case\n        $_\n\n        # If line matches regex\n        if($_ -match ('^' + [regex]::Escape('[/settings/external scripts/scripts]')))\n        {\n            # Add output additional line\n            'Your new line goes here'\n        }\n    }\n\n# Write content of $NewContent varibale back to file\n$NewContent | Out-File -FilePath $File -Encoding Default -Force\n</code></pre> <p> Menggunakan metode statis .Net ( <a href=\"https://msdn.microsoft.com/en-us/library/System.IO.File.ReadAllLines.aspx\" rel=\"nofollow noopener\" target=\"_blank\"> ReadAllLines </a> \\ <a href=\"https://msdn.microsoft.com/en-us/library/System.IO.File.WriteAllLines.aspx\" rel=\"nofollow noopener\" target=\"_blank\"> WriteAllLines </a> ): </p> <pre class=\"lang-powershell prettyprint-override\"><code># Set file name\n$File = '.\\nsclient.ini'\n\n# Process lines of text from file and assign result to $NewContent variable\n$NewContent = [System.IO.File]::ReadAllLines($File) |\n    ForEach-Object {\n        # Output the existing line to pipeline in any case\n        $_\n\n        # If line matches regex\n        if($_ -match ('^' + [regex]::Escape('[/settings/external scripts/scripts]')))\n        {\n            # Add output additional line right after it\n            'Your new line goes here'\n        }\n    }\n\n# Write content of $NewContent varibale back to file\n[System.IO.File]::WriteAllLines($File, $NewContent)\n</code></pre>","votes":"6","source":"https://superuser.com/a/894188","author":"<a href=\"https://superuser.com/users/418201/beatcracker\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">beatcracker</span></a>","replies":[{"reply":"Anda dapat menyederhanakan sedikit skrip dengan mengeluarkan <code>$_</code> sebelum <code>if</code> dan membuang bagian <code>else</code>. (Saya mengambil kebebasan untuk mengirimkan pengeditan, silakan rollback jika Anda ingin menyimpan kode yang lebih verbose)","author":"<a href=\"https://superuser.com/users/593435/pacopaco\" target=\"_blank\" rel=\"nofollow noopener\">Pacopaco</a>"}]}]}
