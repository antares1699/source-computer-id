{"title":"Tidak dapat menjalankan Node.js Script dengan launchd di Mac","draft":false,"url":"/tidak-dapat-menjalankan-nodejs-script-dengan-launchd-di-mac-najvzxvo","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["macos","osx-mountain-lion","launchd","node.js"],"snippet":"Saya mencoba menjalankan  simpul  skrip setiap jam di Mac saya (OSX 10.8.2 Mountain Lion). Menurut hasil pencarian peringkat tinggi, cara terbaik untuk melakukannya adalah dengan menambahkan agen peluncuran launchd.  Untuk beberapa alasan...","body":"<p> Saya mencoba menjalankan <a href=\"http://www.nodejs.org\" rel=\"nofollow noopener\" target=\"_blank\"> simpul </a> skrip setiap jam di Mac saya (OSX 10.8.2 Mountain Lion). Menurut hasil pencarian peringkat tinggi, cara terbaik untuk melakukannya adalah dengan menambahkan agen peluncuran <code>launchd</code>. </p>\n\n<p> Untuk beberapa alasan sepertinya itu tidak berhasil. </p>\n\n<p> Saya menulis file agen peluncuran berikut dan menyimpannya sebagai <code>~/Library/LaunchAgents/agenttest.plist</code>. </p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n    &lt;dict&gt;\n        &lt;key&gt;KeepAlive&lt;/key&gt;\n        &lt;dict&gt;\n            &lt;key&gt;SuccessfulExit&lt;/key&gt;\n            &lt;false/&gt;\n        &lt;/dict&gt;\n        &lt;key&gt;Label&lt;/key&gt;\n        &lt;string&gt;protocol&lt;/string&gt;\n        &lt;key&gt;ProgramArguments&lt;/key&gt;\n        &lt;array&gt;\n            &lt;string&gt;/usr/local/bin/node&lt;/string&gt;\n            &lt;string&gt;/Users/snorpey/PATH/TO/file.js&lt;/string&gt;\n        &lt;/array&gt;\n        &lt;key&gt;RunAtLoad&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;StartInterval&lt;/key&gt;\n        &lt;integer&gt;3600&lt;/integer&gt;\n    &lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre> <p> Saya memulai agen peluncuran dengan menjalankan <code>launchctl load ~/Library/LaunchAgents/agenttest.plist</code> di terminal. </p>\n\n<p> Saya juga membuat file skrip dapat dieksekusi dengan <code>sudo chmod -x /Users/snorpey/PATH/TO/file.js</code> dan memperbarui izin file dengan <code>sudo chmod 777 /Users/snorpey/PATH/TO/file.js</code>. </p>\n\n<p> Ketika saya menjalankan <code>/usr/local/bin/node /Users/snorpey/PATH/TO/file.js</code> di terminal, skrip berfungsi dengan baik. </p>\n\n<p> Namun, tampaknya tidak berfungsi ketika dijalankan oleh <code>launchd</code>. Saya mendapatkan pesan berikut di <code>/var/log/system.log</code>: </p> <pre><code>Jan 15 22:32:46 snorpey com.apple.launchd.peruser.501[595] (agenttest[21625]): Exited with code: 1\nJan 15 22:32:46 snorpey com.apple.launchd.peruser.501[595] (agenttest): Throttling respawn: Will start in 10 seconds\n</code></pre> <p> Mengapa gagal menjalankan skrip? </p>","source":"https://superuser.com/questions/536804/cant-run-node-js-script-with-launchd-on-mac","author":"<a href=\"https://superuser.com/users/190252/snorpey\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">snorpey</span></a>","replies":[],"answers":[{"answer":"<p> Saya mengalami ini untuk sementara waktu (mendapatkan 127 kesalahan). Ternyata Anda membutuhkan sesuatu seperti ini di plist Anda: </p> <pre><code>&lt;key&gt;EnvironmentVariables&lt;/key&gt;\n&lt;dict&gt;\n  &lt;key&gt;PATH&lt;/key&gt;\n  &lt;string&gt;/usr/local/bin:/usr/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin&lt;/string&gt;\n&lt;/dict&gt;\n</code></pre> <p> launchd tampaknya menjalankan hal-hal dengan jalur minimal yang tidak menyertakan / usr / local / bin, dan node tampaknya membutuhkan ini pada PATH Anda agar berfungsi dengan baik. </p>","votes":"5","source":"https://superuser.com/a/1442700","author":"<a href=\"https://superuser.com/users/1042987/brian-duff\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Brian Duff</span></a>","replies":[]},{"answer":"<p> Ternyata saya harus menjalankan pekerjaan ini sebagai root untuk alasan apapun. </p>\n\n<p> Saya memindahkan file ke <code>/Library/LaunchAgents/agenttest.plist</code>. </p>\n\n<p> Saya juga memperbarui kepemilikan file dengan <code>sudo chown root /Library/LaunchAgents/agenttest.plist</code>. </p>\n\n<p> Dan izin file dengan <code>sudo chmod 644 /Library/LaunchAgents/agenttest.plist</code>. </p>\n\n<p> Untuk menjalankan pekerjaan sebagai root: <code>sudo launchctl load /Library/LaunchAgents/agenttest.plist</code> </p>","votes":"1","source":"https://superuser.com/a/537203","author":"<a href=\"https://superuser.com/users/190252/snorpey\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">snorpey</span></a>","replies":[{"reply":"Jika tidak perlu dijalankan sebagai root, mungkin kesalahan telah diperbaiki hanya dengan memuat ulang plist. Biasanya Anda harus membongkar dan memuat plist untuk menerapkan perubahan.","author":"<a href=\"https://superuser.com/users/69039/lri\" target=\"_blank\" rel=\"nofollow noopener\">Lri</a>"},{"reply":"Saya masih melihat kesalahan 127 ketika menjalankan daftar launchd :(","author":"<a href=\"https://superuser.com/users/310207/chet\" target=\"_blank\" rel=\"nofollow noopener\">Chet</a>"}]},{"answer":"<p> Cara lain untuk mengatur PATH kita sendiri dengan menjalankan perintah seperti ini <code>bash -c &quot;PATH=xxx &amp;&amp; run_script&quot;</code> </p> <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE plist PUBLIC &quot;-//Apple Computer//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;\n&lt;plist version=&quot;1.0&quot;&gt;\n    &lt;dict&gt;\n        &lt;key&gt;ProgramArguments&lt;/key&gt;\n        &lt;array&gt;\n            &lt;string&gt;bash&lt;/string&gt;\n            &lt;string&gt;-c&lt;/string&gt;\n            &lt;string&gt;PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin &amp;&amp; node /Users/snorpey/PATH/TO/file.js&lt;/string&gt;\n        &lt;/array&gt;\n        &lt;key&gt;RunAtLoad&lt;/key&gt;\n        &lt;true/&gt;\n    &lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre>","votes":"0","source":"https://superuser.com/a/1631673","author":"<a href=\"https://superuser.com/users/729486/wrkwrk\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">wrkwrk</span></a>","replies":[]}]}
