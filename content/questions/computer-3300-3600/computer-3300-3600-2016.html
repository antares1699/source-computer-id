{"title":"Memeriksa kemacetan transfer samba","draft":false,"url":"/memeriksa-kemacetan-transfer-samba-7g0vvflw","votes":"4","answers_count":"5","categories":["Komputer"],"tags":["linux","networking","samba"],"snippet":"Ini adalah pertanyaan tentang penyiapan jaringan rumah saya.  Saya memiliki NAS, terhubung melalui gigabit ethernet ke sakelar, yang terhubung melalui ethernet 100mbit ke router. Kemudian saya memiliki mac saya, terhubung melalui wireless...","body":"<p> Ini adalah pertanyaan tentang penyiapan jaringan rumah saya. </p>\n\n<p> Saya memiliki NAS, terhubung melalui gigabit ethernet ke sakelar, yang terhubung melalui ethernet 100mbit ke router. Kemudian saya memiliki mac saya, terhubung melalui wireless N ke router saya. </p>\n\n<p> Sekarang, saya mentransfer file ke dan dari NAS saya melalui samba. NAS saya memiliki spesifikasi yang buruk, RAM 64mb dan cpu powerpc. </p>\n\n<p> Pertanyaan saya adalah, apakah kecepatan transfer saya dibatasi oleh wifi saya, atau oleh spesifikasi NAS saya?\nBagaimana jika saya terhubung langsung ke router 100mbit? atau saklar 1gbit? Lalu apa faktor pembatasnya? </p>\n\n<p> Saya ingin tahu cara saya dapat memeriksanya, melalui alat linux di NAS, sebaiknya apakah saya memaksimalkan CPU atau RAM? Bagaimana saya mempersiapkan laporan tentang ini dengan nomor dunia nyata jika saya melakukan ini dengan benar? </p>\n\n<p> Ini sebagian besar untuk rasa ingin tahu saya (Dan untuk melihat ke mana uang perlu dibelanjakan selanjutnya). </p>","source":"https://superuser.com/questions/553912/checking-for-samba-transfer-bottlenecks","author":"<a href=\"https://superuser.com/users/200273/salgar\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Salgar</span></a>","replies":[{"reply":"&gt; Bagaimana jika saya terhubung langsung ke router 100mbit? Yah, saya rasa ini adalah sesuatu yang bisa Anda coba, bukan?","author":"<a href=\"https://superuser.com/users/43056/scherand\" target=\"_blank\" rel=\"nofollow noopener\">scherand</a>"}],"answers":[{"answer":"<p> Jadi pada dasarnya Anda memiliki: </p>\n\n<p> Mac &lt;- nirkabel N -&gt; Router &lt;- 100MbE -&gt; Switch &lt;- GbE -&gt; NAS </p>\n\n<p> Hal utama yang dapat Anda periksa di sini adalah kemampuan lalu lintas jaringan Anda dan kemampuan menyalin file dari perangkat Anda. Ada sejumlah utilitas yang cepat dan efisien dalam menangani karakteristiknya masing-masing. </p>\n\n<p><strong> Jaringan </strong></p>\n\n<p> Ada program lintas platform bernama <code>iperf</code> yang menggunakan model klien-server untuk menilai, antara lain, bandwidth jaringan. Anda akan ingin mengunduh dan / atau mengkompilasi salinan iperf ke kotak NAS dan Mac Anda. Kotak NAS Anda dalam hal ini bertindak sebagai server Anda, jadi Anda akan ingin memulai iperf sebagai server: <code>iperf -s</code>. Di Mac Anda, Anda akan ingin menjalankan <code>iperf -c &lt;ip&gt;</code> di mana <code>ip</code> adalah alamat IP kotak NAS Anda. Ini akan memberi Anda perkiraan kapabilitas mentah konfigurasi jaringan Anda antara Mac dan sistem NAS. </p>\n\n<p><strong> Salinan File NAS </strong></p>\n\n<p> Saya perhatikan bahwa Synology 407e memiliki dua port USB di belakang. Satu hal yang dapat Anda lakukan untuk menilai secara ketat kapabilitas salinan file dari sistem NAS Anda adalah dengan memasang hard drive eksternal yang cepat, atau lebih disukai hard disk solid state, dan menyalin file ke dan dari drive eksternal ke share Samba Anda. Untuk melakukan ini, Anda cukup menyalin file besar dan memperkirakan waktu yang dibutuhkan untuk transfer dan membaginya menjadi ukuran transfer massal. Atau Anda dapat menggunakan utilitas seperti <code>fio</code> yang beroperasi sebagai benchmark I / O file. <code>fio</code> adalah utilitas kaya fitur yang menyediakan statistik komprehensif tentang operasi I / O yang dijalankannya. Sehubungan dengan saran Chris, Anda dapat menjalankan <code>top</code> saat transfer file sedang berlangsung untuk melihat penggunaan CPU dan memori secara real-time. Beberapa utilitas stat sistem yang baik lainnya adalah <code>vmstat</code> dan <code>dstat</code> </p>\n\n<p><strong> Ringkasan </strong></p>\n\n<p> Jika jaringan, kotak NAS, Mac, sakelar, dan router Anda semuanya berfungsi dalam spesifikasinya, ada kemungkinan bahwa satu atau lebih hard drive Anda di dalam NAS rusak, atau larik RAID rusak. Mungkin juga ada masalah latensi dalam jaringan Anda yang mungkin memerlukan penyelidikan lebih lanjut. </p>\n\n<p><strong> Alat </strong></p>\n\n<ul>\n<li> fio </li>\n<li> iperf </li>\n<li> Wireshark </li>\n<li> dstat </li>\n<li> traceroute </li>\n</ul>\n\n<p><strong> Persiapan Laporan </strong></p>\n\n<p> Biasanya laporan seperti itu akan berfokus pada bandwidth (MB / s), throughput (IO / s), dan latensi (ms). Ukuran file yang lebih kecil untuk transfer (512 byte) umumnya menawarkan throughput yang lebih tinggi tetapi bandwidth yang lebih buruk dengan latensi minimal. Ukuran file yang lebih besar&gt; 64 KB akan menunjukkan bandwidth yang lebih tinggi, throughput yang lebih rendah, dan peningkatan latensi bergantung pada ukuran transfer dan kecepatan media. </p>\n\n<p> Sumber: Tolok ukur aplikasi penyimpanan selama 14 bulan dalam sebuah perusahaan teknologi. </p>","votes":"4","source":"https://superuser.com/a/556074","author":"<a href=\"https://superuser.com/users/65359/aqua\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">aqua</span></a>","replies":[]},{"answer":"<p> Hambatan umumnya akan selalu menjadi jaringan. Nirkabel akan selalu lebih lambat dari kabel. Untuk mengujinya, sambungkan komputer Anda ke langsung ke NAS, lalu sakelar, lalu router, lalu melalui nirkabel, dan gunakan perintah berikut di komputer Anda: </p> <pre><code>time cp -r /nas/representative/directory /tmp # will print the durantion\nrm -r /tmp/directory\n</code></pre> <p> Itu akan menentukan waktu salinan untuk setiap koneksi, dan Anda dapat menilai dari sana. </p>","votes":"2","source":"https://superuser.com/a/558545","author":"<a href=\"https://superuser.com/users/130929/chloe\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Chloe</span></a>","replies":[]},{"answer":"<p> Kecepatan transfer apa yang Anda lihat sekarang? Jika sekitar 10MBps, itulah kecepatan koneksi 100Mb tercepat. Ini mungkin koneksi paling lambat di jaringan Anda, meskipun itu tebakan terbaik. </p>\n\n<p> Unit itu sendiri mungkin mampu menghasilkan 100MBps. Jelas tidak ada yang salah dengan arsitektur Power-PC. 64MB RAM cukup banyak untuk perangkat yang dibuat khusus juga. Saya tahu tentang beberapa Power-PC SoC yang dapat menghasilkan beberapa kali lipat dari apa yang dapat disediakan oleh koneksi Ethernet 1000Mb di bagian belakang kotak. </p>\n\n<p> Mungkin juga disk drive Anda dalam larik membatasi kinerja, atau pengontrol disk. Benar-benar ada beberapa tempat yang bisa menjadi hambatan. Tanpa mengetahui lebih banyak tentang penyiapan Anda, tidak mungkin memberikan tebakan yang masuk akal. </p>","votes":"1","source":"https://superuser.com/a/553914","author":"<a href=\"https://superuser.com/users/26262/chris-s\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Chris S</span></a>","replies":[{"reply":"Saya hanya melihat sekitar 4,5MB / s saat ini melalui wifi. NAS adalah sistem 407e dengan Freescale MPC8245 dan memiliki drive Samsung RAID 1 4x750gb 7200rpm SATA.","author":"<a href=\"https://superuser.com/users/200273/salgar\" target=\"_blank\" rel=\"nofollow noopener\">Salgar</a>"},{"reply":"Tetapi saya lebih suka memiliki cara untuk mengukur semua hal yang Anda sebutkan. misalnya Saya dapat memantau bagian atas dan melihat bahwa ketika saya menyalin SMBD menggunakan 20% cpu dan 40% ram, tetapi saya tidak tahu apakah itu karena hanya ada 40% dari ram yang tersedia atau karena hanya itu yang dibutuhkan.","author":"<a href=\"https://superuser.com/users/200273/salgar\" target=\"_blank\" rel=\"nofollow noopener\">Salgar</a>"},{"reply":"<code>top</code> harus menunjukkan berapa banyak RAM yang kosong. Periksa <code>ping</code> kali antara komputer Anda dan perangkat. Saya tidak terbiasa dengan perangkat Synology, dapatkah Anda mengubah konfigurasi <code>smbd</code> secara langsung? Prosesor Freescale lebih dari mampu memenuhi 1GbE dalam kondisi normal. Drive juga harus baik-baik saja.","author":"<a href=\"https://superuser.com/users/26262/chris-s\" target=\"_blank\" rel=\"nofollow noopener\">Chris S</a>"},{"reply":"<code>iotop</code> adalah setara untuk pemantauan IO. Umumnya throughput penyimpanan adalah fungsi drive dan kecepatan jaringan. CPU / RAM jarang menjadi masalah dalam transfer file. <code>sar</code> dari paket sysstat bagus untuk pemantauan yang lebih mendalam.","author":"<a href=\"https://superuser.com/users/201268/ryan\" target=\"_blank\" rel=\"nofollow noopener\">Ryan</a>"}]},{"answer":"<p> Jelas Anda memiliki beberapa gabungan kemacetan, yang tidak membuat segalanya menjadi lebih baik: </p>\n\n<ul>\n<li> NAS Anda maksimal sekitar 20MB / s dari apa yang dapat ditemukan di internet </li>\n<li> Jaringan 100MBit / dtk maksimal sekitar 12MB / dtk </li>\n<li> 802.11n memiliki kecepatan teoretis yang tinggi, tetapi saya curiga Anda menggunakan 2.4GHz, yang memiliki masalah kecepatan transfer efektif lebih dari 100MBit / s - itu juga jelas dari antarmuka LAN 100MBit / s </li>\n</ul>\n\n<p> Jadi untuk mendapatkan kinerja maksimum dari NAS Anda, jelas koneksi kabel langsung (1GBit / s) akan menjadi yang terbaik. </p>\n\n<p> Dengan router yang lebih baik (dan mungkin dukungan 5GHz) Anda setidaknya dapat meminimalkan perlambatan Wifi, tetapi jelas itu masih akan lebih lambat daripada koneksi kabel langsung. </p>\n\n<p> Dengan router yang lebih baik <em> dan </em> NAS yang lebih baik Anda akan dapat mencapai kinerja yang wajar (~ 30MByte / dtk saya curiga dari pengalaman saya sendiri), tetapi kemungkinan akan membebani Anda cukup banyak uang. Anda mungkin dapat melepas sakelar juga, meskipun itu bukan bagian dari masalah. Selain itu, 5GHz juga memiliki batasan berat dalam hal jangkauan. </p>","votes":"1","source":"https://superuser.com/a/557094","author":"<a href=\"https://superuser.com/users/156928/stefan-seidel\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Stefan Seidel</span></a>","replies":[]},{"answer":"<p> Periksa status tautan NIC ethernet NAS Anda. Mungkin dalam mode setengah dupleks 100Mbps.\nBeberapa chip tidak akan otomatis mendeteksi kecepatan tautan dengan benar dengan sakelar Gigabit. Saya memilikinya dengan beberapa chip Realtek. </p>\n\n<p> Lakukan saja <code>ethtool eth0</code> atau apa pun namanya NIC. Mungkin itu saja.\nUntuk memaksa kecepatan Gigabit gunakan <code>ethtool -s eth0 speed 1000 duplex full</code>. </p>","votes":"0","source":"https://superuser.com/a/557882","author":"<a href=\"https://superuser.com/users/199624/kschurig\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">kschurig</span></a>","replies":[{"reply":"10Mbps adalah ~ 1.2MB / s, jadi jelas bukan itu masalahnya karena @Salgar menyatakan bahwa dia melihat 4,5MB / s.","author":"<a href=\"https://superuser.com/users/156928/stefan-seidel\" target=\"_blank\" rel=\"nofollow noopener\">Stefan Seidel</a>"},{"reply":"Itu salah ketik. Maksud saya setengah dupleks 100Mbps yang merupakan 12,5 / 2 = 6,25 MB / s maksimum thorughput termasuk overhead protokol. Saya ingat karena saya juga punya masalah dengan throughput sekitar 4,5MB / dtk dengan samba.","author":"<a href=\"https://superuser.com/users/199624/kschurig\" target=\"_blank\" rel=\"nofollow noopener\">kschurig</a>"}]}]}
