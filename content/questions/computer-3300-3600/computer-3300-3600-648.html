{"title":"Mengganti pola multi-garis dalam file HTML","draft":false,"url":"/mengganti-pola-multi-garis-dalam-file-html-rs7wumiw","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["linux","sed","find-and-replace"],"snippet":"Saya memiliki serangkaian file HTML yang berisi dua baris seperti ini:  &lt;body&gt;&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;&lt;a href=\"url\"&gt;Description&lt;/a&gt;&lt;br&gt;  Saya ingin mengganti teks ini dengan yang lain menggunakan skrip bash. Saya mencoba  sed -i -r 's/&lt;h1&gt;Title.*?$\\/^.*?&lt;br&gt;/Replacement...","body":"<p> Saya memiliki serangkaian file HTML yang berisi dua baris seperti ini: </p> <pre><code>&lt;body&gt;\n&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;\n&lt;a href=\"url\"&gt;Description&lt;/a&gt;&lt;br&gt;\n</code></pre> <p> Saya ingin mengganti teks ini dengan yang lain menggunakan skrip bash. Saya mencoba </p> <pre><code>sed -i -r 's/&lt;h1&gt;Title.*?$\\/^.*?&lt;br&gt;/Replacement text/1' filename.html\n</code></pre> <p> tapi tidak berhasil. Saya curiga itu macet di jalur baru dan tidak tahu bagaimana mengatasi masalah tersebut. </p>\n\n<p> Setiap bantuan dihargai. Jangan ragu untuk menyarankan alat Linux lain selain <code>sed</code> selama masih berfungsi! </p>","source":"https://superuser.com/questions/597385/substituting-a-multi-line-pattern-in-an-html-file","author":"<a href=\"https://superuser.com/users/166863/to-do\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">To Do</span></a>","replies":[{"reply":"Apakah Anda benar-benar membutuhkan <code>sed</code> untuk ini? <code>sed</code> membaca baris demi baris, jadi mengganti teks multi-baris agak membosankan di sana.","author":"<a href=\"https://superuser.com/users/48078/slhck\" target=\"_blank\" rel=\"nofollow noopener\">slhck</a>"},{"reply":"Saya tidak harus menggunakan sed. Saya terbuka untuk perintah linux lainnya.","author":"<a href=\"https://superuser.com/users/166863/to-do\" target=\"_blank\" rel=\"nofollow noopener\">To Do</a>"},{"reply":"ya, pola yang melintasi beberapa garis mungkin menjadi masalah bagi sed.","author":"<a href=\"https://superuser.com/users/42672/barlop\" target=\"_blank\" rel=\"nofollow noopener\">barlop</a>"}],"answers":[{"answer":"<p> Saya akan menggunakan Perl untuk ini: </p> <pre><code>perl -0pe 's/&lt;h1&gt;Title.*\\n.*&lt;br&gt;/replacement/' filename.html\n</code></pre> <p> Di sini, <code>-0</code> membuat Perl memisahkan rekaman pada karakter <code>NUL</code> alih-alih membaca baris demi baris, yang merupakan default saat menggunakan opsi <code>-p</code>. </p>\n\n<p> Dengan ekspresi reguler Perl Anda memerlukan <code>.*</code> untuk mencocokkan karakter apa pun beberapa kali, dan Anda mencocokkan baris baru dengan <code>\\n</code>. </p>\n\n<p> Contoh: </p> <pre><code>$ echo '&lt;body&gt;\n&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;\n&lt;a href=\"url\"&gt;Description&lt;/a&gt;&lt;br&gt;' | perl -0pe 's/&lt;h1&gt;Title.*\\n.*&lt;br&gt;/replacement/'\n&lt;body&gt;\nreplacement\n</code></pre>","votes":"9","source":"https://superuser.com/a/597389","author":"<a href=\"https://superuser.com/users/48078/slhck\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">slhck</span></a>","replies":[{"reply":"Dan jangan lupa, <a href=\"http://stackoverflow.com/a/1732454/1081936\" target=\"_blank\" rel=\"nofollow noopener\"> jangan pernah menggunakan ekspresi reguler untuk mengurai HTML </a> ! :)","author":"<a href=\"https://superuser.com/users/151431/terdon\" target=\"_blank\" rel=\"nofollow noopener\">terdon</a>"},{"reply":"Ini adalah <i> hampir </i> baik. Saya menambahkan? setelah keduanya. * untuk menonaktifkan keserakahan. Apakah mungkin untuk membuat perintah memodifikasi file alih-alih menampilkannya ke STDOUT?","author":"<a href=\"https://superuser.com/users/166863/to-do\" target=\"_blank\" rel=\"nofollow noopener\">To Do</a>"},{"reply":"@ToDo Perl dapat melakukan pengeditan di tempat dengan opsi <code>-i</code>, jadi jalankan <code>perl -0p -i~ -e &#39;s&#47;…&#47;…&#47;&#39;</code> untuk mengedit file asli, membuat salinan cadangan dengan <code>~</code> sebagai sufiks. Atau, untuk mengganti tanpa file cadangan, hubungi <code>perl -0pi -e …</code>.","author":"<a href=\"https://superuser.com/users/48078/slhck\" target=\"_blank\" rel=\"nofollow noopener\">slhck</a>"}]},{"answer":"<p> <code>sed</code> tidak dapat mencocokkan lebih dari satu baris secara langsung. Saat pola multiline diperlukan, gunakan alat yang lebih canggih seperti Perl: </p> <pre><code>perl -i~ -ne 'if (/^&lt;h1&gt;Title/) {\n                  $n = &lt;&gt;;\n                  if ($n =~ /&lt;br&gt;$/) { print \"Replacement\\n\" }\n                  else { print \"$_$n\" }\n              } else { print }'\n</code></pre>","votes":"1","source":"https://superuser.com/a/597390","author":"<a href=\"https://superuser.com/users/105002/choroba\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">choroba</span></a>","replies":[]},{"answer":"<p> Ini bisa dilakukan dengan sed. </p> <pre><code>sed -nf repl.sed filename.html\n</code></pre> <p> dimana <code>repl.sed</code> berisi: </p> <pre><code># Must have one line loaded up before branching to rep.\n# Processing will start this way.\n:rep\n# Load extra line into pattern space\nN\n# Test for title\n/&lt;h1&gt;.*&lt;\\/h1&gt;&lt;p&gt;\\n&lt;a href=\".*\"&gt;.*&lt;\\/a&gt;&lt;br&gt;/{\n  #Substitute and print\n  s/&lt;h1&gt;\\(.*\\)&lt;\\/h1&gt;&lt;p&gt;\\n&lt;a href=\".*\"&gt;.*&lt;\\/a&gt;&lt;br&gt;/Title: \\1/p\n  #append next line without cycling\n  N\n  # everything but the last line\n  s/.*\\n\\([.\\n]*\\)/\\1/\n  #test for last line\n  ${\n    p\n    # this will effectively end the program\n    n\n  }\n  b rep\n}\n${\n  # will print pattern space (both lines)\n  p\n  # this will effectively end the program\n  n\n}\n#Print first line in pattern space\nP;\n#Remove first line in pattern space with newline\ns/.*\\n\\([.\\n]*\\)/\\1/\nb rep\n</code></pre> <p> Lihat <a href=\"http://www.grymoire.com/Unix/Sed.html#uh-51\" rel=\"nofollow noopener\" target=\"_blank\"> Bekerja dengan Banyak Garis </a></p>","votes":"1","source":"https://superuser.com/a/615240","author":"<a href=\"https://superuser.com/users/217564/chad-skeeters\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Chad Skeeters</span></a>","replies":[]}]}
