{"title":"Mengapa menambahkan IP lokal dan nama pengguna di scp mengembalikan kesalahan kunci publik?","draft":false,"url":"/mengapa-menambahkan-ip-lokal-dan-nama-pengguna-di-scp-mengembalikan-kesalahan-kunci-publik-hetbvjlx","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["linux","ssh","scp"],"snippet":"Saya memiliki dua server jarak jauh yang memiliki kunci pengguna dan id yang sama. Saya dapat dengan bebas SSH ke salah satu dari mereka dari mesin lokal, atau dari satu ke yang...","body":"<p> Saya memiliki dua server jarak jauh yang memiliki kunci pengguna dan id yang sama. Saya dapat dengan bebas SSH ke salah satu dari mereka dari mesin lokal, atau dari satu ke yang lain. Saya <code>ssh</code>-ed ke <code>100.100.100.1</code> dan saya mencoba menjalankan: </p> <pre><code>scp -i ~/keyfile -r ognjen@100.100.100.1:/path/1/ ognjen@100.100.100.2:/path/2/\n</code></pre> <p> Ini mengembalikan kesalahan publik dari jarak jauh tujuan dan koneksi yang hilang. </p>\n<p> Saya tidak sengaja menyadari bahwa ini berfungsi: </p> <pre><code>scp -i ~/keyfile -r /path/1/ ognjen@100.100.100.2:/path/2/\n</code></pre> <p> Mengapa yang pertama gagal? </p>","source":"https://superuser.com/questions/1586920/why-does-adding-local-ip-and-username-in-scp-return-public-key-error","author":"<a href=\"https://superuser.com/users/1031727/cindy-almighty\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Cindy Almighty</span></a>","replies":[],"answers":[{"answer":"<p> Catatan penting: Mesin yang Anda sebut &quot;mesin lokal&quot; sama sekali tidak relevan. Kisah sebenarnya dimulai ketika Anda sudah berada di <code>100.100.100.1</code>. Dalam konteks <code>scp</code> dan dalam konteks jawaban ini &quot;lokal&quot; adalah mesin di mana <code>scp</code> dipanggil oleh Anda. </p>\n<blockquote>\n<p> Mengapa [perintah] pertama gagal? </p>\n</blockquote>\n<p> Anda mencoba menyalin antara dua host jarak jauh (secara resmi). <code>scp</code> mengenali <code>ognjen@100.100.100.1:/path/1/</code> sebagai jalur non-lokal. Tidak masalah <code>ognjen@100.100.100.1</code> menunjuk ke mesin lokal. Alat tidak (dan tidak seharusnya) memeriksa apakah alamat yang terlihat mengarah jauh ke mesin lokal. Hanya dengan merujuk ke sumber seolah-olah itu jauh, Anda membuat <code>scp</code> memperlakukannya sebagai jarak jauh. Juga tujuannya jauh. </p>\n<p> Menyalin antara dua host jarak jauh dapat dilakukan dengan atau tanpa opsi <code>-3</code>: </p>\n<blockquote>\n<p> <code>-3</code> <br> Salinan antara dua host jarak jauh ditransfer melalui host lokal. <strong> Tanpa opsi ini, data akan disalin langsung antara dua host jarak jauh. </strong> [â€¦] </p>\n</blockquote>\n<p><sup> (penekanan milikku, <a href=\"https://man.openbsd.org/scp#3\" rel=\"nofollow noopener\" target=\"_blank\"> sumber </a> ) </sup></p>\n<p> Fragmen tebal berlaku untuk casing Anda (meskipun <code>scp</code> Anda tidak mendukung <code>-3</code>). </p>\n<p> Jika Anda menggunakan <code>-v</code> dengan perintah pertama Anda </p> <pre><code>scp -v -i ~/keyfile -r ognjen@100.100.100.1:/path/1/ ognjen@100.100.100.2:/path/2/\n</code></pre> <p> Anda akan melihat <code>scp</code> menghubungkan dari host lokal ke host sumber (&quot;kebetulan&quot; adalah host yang sama) menggunakan kunci yang ditentukan dengan <code>-i</code>. (Rupanya host dikonfigurasi untuk menerima kunci ini, mungkin karena server lain menggunakan kunci yang identik untuk Menghubung.) </p>\n<p> Kemudian Anda akan melihat <code>scp</code> lain dipanggil pada host sumber. Perintahnya adalah: </p> <pre><code>scp -v -r /path/1/ ognjen@100.100.100.2:/path/2/\n</code></pre> <p> <code>-v</code> dan <code>-r</code> ada di sana karena mereka ada di perintah lokal Anda. Jalur sumber diterjemahkan ke jalur lokal; tujuan tidak berubah. Jika perintah ini berhasil dijalankan, data akan &quot;disalin langsung antara dua host jarak jauh&quot;. </p>\n<p> Perhatikan bahwa tidak ada <code>-i</code>. Haruskah <code>-i ~/keyfile</code> ada di sana? Atau lebih tepatnya <code>-i /home/cindy/keyfile</code> atau lebih? (karena lokal <code>scp</code> mendapatkan sesuatu seperti ini setelah shell lokal memperluas tilde). </p>\n<p> Tidak. Secara umum, host sumber jarak jauh mungkin (dan biasanya) berbeda dari host lokal. Path yang valid untuk host lokal dapat menunjuk ke apapun atau tidak sama sekali pada host jarak jauh. Jika <code>scp</code> pada host sumber dipanggil dengan <code>-i</code>, itu akan menyebabkan lebih banyak masalah daripada yang bisa dipecahkannya. Untung saja <code>-i</code> tidak menyebar ke perintah yang dipanggil pada host sumber. Tetapi kemudian tuan rumah terhubung ke tujuan menggunakan kunci defaultnya atau apa pun konfigurasi yang diperintahkan untuk digunakan. </p>\n<p> Dalam kasus Anda, tampaknya perlu <code>~/keyfile</code> lokal untuk terhubung ke host tujuan. Host sumber memegang file yang benar (karena dalam kasus khusus ini lokal dan sumber adalah mesin yang sama), tetapi perintah <code>scp</code> yang benar-benar terhubung ke tujuan tidak memiliki <code>-i</code> (sebagaimana mestinya secara umum) dan oleh karena itu kuncinya tidak digunakan . </p>\n<p> Perintah kedua Anda menggunakan jalur lokal sebagai sumber, hanya tujuannya yang jauh. Dalam hal ini kunci yang ditentukan dengan <code>-i</code> digunakan untuk menghubungkan dari host lokal ke host tujuan, persis seperti yang Anda rencanakan. Oleh karena itu, itu berhasil. </p>\n<p> Catatan jika Anda mengkonfigurasi mesin lokal untuk secara otomatis menggunakan <code>~/keyfile</code> untuk menyambung ke server lain (<code>IdentityFile</code> di <code>~/.ssh/config</code>), maka perintah pertama akan berfungsi. Host lokal tidak perlu terhubung ke dirinya sendiri, hanya untuk memberitahu dirinya sendiri untuk terhubung ke tujuan, tetapi tetap akan berfungsi. Sambungan pertama akan menggunakan <code>~/keyfile</code> karena <code>-i</code>, sambungan kedua akan menggunakan <code>~/keyfile</code> karena konfigurasinya. </p>","votes":"8","source":"https://superuser.com/a/1586932","author":"<a href=\"https://superuser.com/users/432690/kamil-maciorowski\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Kamil Maciorowski</span></a>","replies":[{"reply":"Penerusan agen SSH dapat membantu, bukan? Misalnya, jika Anda tidak ingin meninggalkan keyfile di 100.100.100.1 untuk terhubung ke 100.100.100.2, sambil tetap dapat memindai file di antara kedua server secara langsung.","author":"<a href=\"https://superuser.com/users/665295/eric-duminil\" target=\"_blank\" rel=\"nofollow noopener\">Eric Duminil</a>"}]},{"answer":"<p> Dari manual scp, deskripsi opsi -3: Salinan antara dua host jarak jauh ditransfer melalui host lokal. Tanpa opsi ini, data akan disalin langsung antara dua host jarak jauh. Perhatikan bahwa opsi ini menonaktifkan pengukur kemajuan dan memilih mode batch untuk host kedua, karena scp tidak dapat meminta kata sandi atau frasa sandi untuk kedua host. </p>\n<p> Menurut deskripsi pertama gagal karena 2 server jarak jauh akan berkomunikasi secara langsung (dalam server 100.100.100.1 nyata akan berkomunikasi dengan server 100.100.100.2 melalui ssh) oleh karena itu Anda harus opsi: </p>\n<ol>\n<li> Gunakan opsi -3. </li>\n<li> Konfigurasikan 2 server jarak jauh agar dapat mengautentikasi dengan kunci ssh keyfile. Jika Anda dapat masuk dari server 100.100.100.1 hingga 100.100.100.2 dengan kunci ssh, perintah asli Anda akan berfungsi. </li>\n</ol>","votes":"2","source":"https://superuser.com/a/1586924","author":"<a href=\"https://superuser.com/users/1168319/gubo\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">GuBo</span></a>","replies":[{"reply":"Terima kasih, tetapi ketika saya menulis &quot;Saya dapat dengan bebas melakukan SSH ke salah satu dari mereka dari mesin lokal&quot;. Saya mengetahui opsi -3 tetapi itu bukan opsi bagi saya untuk masalah kinerja. Tetapi mengingat jawaban Anda, mengapa perintah kedua saya berfungsi?","author":"<a href=\"https://superuser.com/users/1031727/cindy-almighty\" target=\"_blank\" rel=\"nofollow noopener\">Cindy Almighty</a>"},{"reply":"Jawaban saya memberikan diagnosis yang sama, sedang dalam perbaikan saat Anda memposting. Saya memutuskan untuk tetap menerbitkannya karena kurang ringkas. Tampaknya OP tidak yakin, mungkin jawaban saya akan membantu. Bagaimanapun juga, +1 untuk Anda, karena Anda yang pertama dan berada di jalur yang benar.","author":"<a href=\"https://superuser.com/users/432690/kamil-maciorowski\" target=\"_blank\" rel=\"nofollow noopener\">Kamil Maciorowski</a>"},{"reply":"@CindyAlmighty Anda harus SSH dari satu server ke server lain (karena mereka akan berkomunikasi secara langsung bukan melalui mesin lokal), bukan dari mesin lokal.","author":"<a href=\"https://superuser.com/users/1168319/gubo\" target=\"_blank\" rel=\"nofollow noopener\">GuBo</a>"},{"reply":"@KamilMiorowski Anda benar, jawaban Anda memang membantu, tetapi saya tidak setuju bahwa jawaban ini adalah &quot;diagnosis yang sama&quot;. Segmen -3 membingungkan di kedua jawaban Anda dan menjauh dari poin utama, dan poin kedua tidak tepat.","author":"<a href=\"https://superuser.com/users/1031727/cindy-almighty\" target=\"_blank\" rel=\"nofollow noopener\">Cindy Almighty</a>"}]}]}
