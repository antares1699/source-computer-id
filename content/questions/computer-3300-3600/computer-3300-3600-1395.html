{"title":"LINUX Ping host, Menampilkan kesalahan pada kegagalan","draft":false,"url":"/linux-ping-host-menampilkan-kesalahan-pada-kegagalan-9lmaq4la","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["linux","ping","hosts"],"snippet":"Saya sedang menulis skrip bash untuk melakukan ping ke nama host yang diberikan, dan menampilkan apakah host tersebut aktif atau tidak (menampilkan pesan sederhana.) Seharusnya mudah, tetapi malah memusingkan.Inilah yang saya...","body":"<p> Saya sedang menulis skrip bash untuk melakukan ping ke nama host yang diberikan, dan menampilkan apakah host tersebut aktif atau tidak (menampilkan pesan sederhana.) Seharusnya mudah, tetapi malah memusingkan.\nInilah yang saya miliki sejauh ini: </p> <pre><code>    echo &amp; echo \"DOI (Domain):\" &amp;&amp;read input \n    ip=$(ping -c 1 $input | gawk -F'[()]' '/PING/{print $2}') \n    if [ $? -eq 0 ]; then  \n        echo \"$ip is up\";  \n    else   \n        echo \"host is down\";  \n    fi  \n    sleep 60  \n</code></pre> <p> Inilah hasilnya: <br> Ping berhasil (&amp; balasan), itu merespon: </p> <pre><code>    74.125.226.119 is up\n</code></pre> <p> Namun, jika gagal menerima balasan, ia masih menanggapi: </p> <pre><code>    ping: unknown host google.ccccaa \n    is up\n</code></pre> <p> daripada gema &quot;host sedang down&quot; </p>\n\n<p> Jelas, saya telah melewatkan sesuatu. Saya benci mengajukan pertanyaan seperti ini, dan saya yakin jawabannya sudah tersembunyi di sini, tetapi sekali lagi saya terhenti dan tidak dapat menemukan apa yang saya cari. Saya bahkan tidak begitu yakin apa yang saya cari. </p>\n\n<p> EDIT: Selesai! Terima kasih atas saran yang membantu! </p>\n\n<p> Ini finalnya: </p> <pre><code>    echo &amp; echo \"DOI (Domain):\" &amp;&amp;read input    \n    output=$(ping -c 1 \"$input\" 2&gt;/dev/null)  \n    if [ $? -eq 0 ]; then  \n       ip=$(printf '%s' \"$output\" | gawk -F'[()]' '/PING/{print $2}'  2&gt;/dev/null )  \n       echo \"$input ($ip) is up\";  \n    else  \n       echo \"Host not found\";  \n    fi  \n    sleep 60  \n</code></pre>","source":"https://superuser.com/questions/602776/linux-ping-host-display-error-on-failure","author":"<a href=\"https://superuser.com/users/228430/ice\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">ICE</span></a>","replies":[{"reply":"<code>$?</code> mengembalikan status keluar dari perintah terakhir, dalam kasus Anda yaitu <code>gawk</code> yang akan keluar dengan sukses bahkan jika <code>ping</code> mengembalikan kesalahan.","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"<code>ip=$(ping...</code> pertama tidak diperlukan.","author":"<a href=\"https://superuser.com/users/58777/sergey-vlasov\" target=\"_blank\" rel=\"nofollow noopener\">Sergey Vlasov</a>"}],"answers":[{"answer":"<p> Pertama, Anda harus menambahkan <code>2&gt;/dev/null</code> ke permintaan <code>ping</code>, sehingga pesan kesalahan dari <code>ping</code> tidak akan dicetak ke kesalahan standar. </p>\n\n<p> Kedua, <code>$?</code> dalam kode Anda tidak akan berisi hasil yang Anda harapkan, karena status kembalian pipa adalah status keluar dari <strong> terakhir </strong> perintah, yaitu <code>gawk</code> dalam kasus Anda, dan status keluar dari <code>ping</code> diabaikan begitu saja. Anda dapat menulis ulang kode tersebut, misalnya seperti ini: </p> <pre><code>output=$(ping -c 1 \"$input\" 2&gt;/dev/null)\nif [ $? -eq 0 ]; then\n    ip=$(printf '%s' \"$output\" | gawk -F'[()]' '/PING/{print $2}')  \n    echo \"$ip is up\";\nelse\n    echo \"host is down\";\nfi\n</code></pre>","votes":"5","source":"https://superuser.com/a/602779","author":"<a href=\"https://superuser.com/users/58777/sergey-vlasov\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Sergey Vlasov</span></a>","replies":[]},{"answer":"<p> Saya pikir <code>awk</code> tidak perlu. Kecuali saya melewatkan sesuatu, kode itu harus melakukan trik: </p> <pre><code>#!/bin/bash\n\nhost=$1\nping -c1 $host &gt; /dev/null 2&gt; /dev/null\n[[ $? == 0 ]] &amp;&amp; echo \"$host is up\" || echo \"$host is down/not reachable\"\n</code></pre> <p> Berikut contohnya: </p> <pre><code>$ ./checkping www.google.com\nwww.google.com is up\n$ ./checkping www.google.utld\nwww.google.utld is down/not reachable\n</code></pre>","votes":"4","source":"https://superuser.com/a/602778","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">mpy</span></a>","replies":[{"reply":"<code>awk</code> di sini digunakan untuk mendapatkan alamat IP dari keluaran <code>ping</code> dan mencetaknya sebagai ganti nama host.","author":"<a href=\"https://superuser.com/users/58777/sergey-vlasov\" target=\"_blank\" rel=\"nofollow noopener\">Sergey Vlasov</a>"},{"reply":"@SergeyVlasov: Tentu, tetapi saya tidak menyadari bahwa mengembalikan IP adalah persyaratan sampai saya membaca pertanyaan OP sebelumnya ( <a href=\"http://superuser.com/q/602674/195224\" target=\"_blank\" rel=\"nofollow noopener\"> superuser.com/q/602674/195224 </a> ). Btw. pendekatan yang bagus dalam jawaban Anda (+1)!","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"Terima kasih atas nasehatnya! semuanya bekerja seperti pesona sekarang XD","author":"<a href=\"https://superuser.com/users/228430/ice\" target=\"_blank\" rel=\"nofollow noopener\">ICE</a>"},{"reply":"@ Michael: Baik. Tapi saya pikir (menilai dari &#39;pertanyaan Anda yang terakhir&#39;) jawaban Sergey layak, diterima &#39;. Jika Anda juga menyukai jawaban saya, Anda dapat kembali dan memberi suara positif, setelah Anda memiliki cukup perwakilan <code>;)</code>","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"Itu tidak akan membiarkan saya memberikan suara positif untuk jawaban apa pun: S sayangnya, saya hanya dapat menerima (beberapa), dan mengomentari yang lain. Jadi saya pasti mengucapkan terima kasih kepada semua orang untuk saat ini. 15 rep?","author":"<a href=\"https://superuser.com/users/228430/ice\" target=\"_blank\" rel=\"nofollow noopener\">ICE</a>"},{"reply":"@ Michael: Anda hanya bisa menerima <i> satu </i> jawaban yang merupakan solusi untuk masalah Anda atau (jika itu tidak berlaku) paling membantu Anda. Upvoting memerlukan setidaknya 15 reputasi (tetapi saat menulis itu, Anda sudah mencapai 10 karena s / b memberi suara positif pada pertanyaan ini;) dan kami tahu itu dan tidak marah ketika pengguna baru tidak mau memberi suara positif <code>;)</code>","author":"<a href=\"https://superuser.com/users/195224/mpy\" target=\"_blank\" rel=\"nofollow noopener\">mpy</a>"},{"reply":"versi pendek ... <code>ping -c1 google.com &gt; &#47;dev&#47;null 2&gt; &#47;dev&#47;null &amp;&amp; echo &quot;host alive&quot; || echo &quot;host dead&quot;</code>","author":"<a href=\"https://superuser.com/users/498348/lenny\" target=\"_blank\" rel=\"nofollow noopener\">Lenny</a>"}]}]}
