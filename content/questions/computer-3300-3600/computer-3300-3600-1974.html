{"title":"Edit file host dari dalam PowerShell","draft":false,"url":"/edit-file-host-dari-dalam-powershell-lyslxuc4","votes":"4","answers_count":"2","categories":["Komputer"],"tags":["windows","powershell"],"snippet":"Saya harus dapat mengelola lingkungan saya menggunakan skrip PowerShell. Saya perlu mengubah file host saya secara berkala. Namun, setiap kali saya mencoba mengedit host dari skrip saya, saya mendapatkan kesalahan berikut:  Access...","body":"<p> Saya harus dapat mengelola lingkungan saya menggunakan skrip PowerShell. Saya perlu mengubah file host saya secara berkala. Namun, setiap kali saya mencoba mengedit host dari skrip saya, saya mendapatkan kesalahan berikut: </p> <pre><code>Access to the path C:\\windows\\system32\\drivers\\etc\\hosts is denied\n</code></pre> <p> Saat ini skrip saya terlihat seperti ini: </p> <pre><code>Function ManageHosts([string] $environment)\n{\ncd C:\\windows\\system32\\drivers\\etc\nif($environment.StartsWith(\"p\"))\n{\nget-content .\\hosts.prod | set-content .\\hosts -force\n}\nelse\n{\nget-content .\\hosts.dev | set-content .\\hosts -force\n}\n}\n</code></pre>","source":"https://superuser.com/questions/631416/edit-hosts-file-from-within-powershell","author":"<a href=\"https://superuser.com/users/245362/david-rett\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">David Rett</span></a>","replies":[{"reply":"Apakah masalahnya adalah fakta bahwa Anda harus menjalankannya sebagai administrator?","author":"<a href=\"https://superuser.com/users/154090/freudianslip\" target=\"_blank\" rel=\"nofollow noopener\">FreudianSlip</a>"},{"reply":"Saya pikir tombol -force pada dasarnya sama dengan menjalankan sebagai administrator: /","author":"<a href=\"https://superuser.com/users/245362/david-rett\" target=\"_blank\" rel=\"nofollow noopener\">David Rett</a>"},{"reply":"Hai David. Silakan gunakan pratinjau di bawah posting Anda untuk melihat bagaimana itu akan diformat. Anda perlu memasukkan kode sebanyak 4 spasi atau memilihnya dan menekan <code>Ctrl-K</code> (atau tombol <code>{}</code>).","author":"<a href=\"https://superuser.com/users/48078/slhck\" target=\"_blank\" rel=\"nofollow noopener\">slhck</a>"}],"answers":[{"answer":"<p> Ini adalah masalah hak istimewa. Jika Anda adalah admin di kotak lokal Anda, saya dapat membantu. <br> Coba ini: Klik kanan ikon Powershell Anda dan pilih <em> Jalankan sebagai administrator </em> . Kemudian coba jalankan skrip Anda; itu akan berhasil. </p>\n\n<p> Namun, ini tidak menjawab bagaimana Anda dapat melakukan ini dari dalam skrip. Anda dapat menambahkan beberapa kode ke skrip Anda yang secara otomatis akan mencoba membuat sesi PS Anda meningkat, tetapi Anda masih harus berinteraksi dengan kotak dialog keamanan yang muncul setiap kali Anda mencoba dan menjalankan sesuatu sebagai admin yaitu Vista atau yang lebih baru. Jadi, tidak yakin seberapa mudah ini daripada hanya memulai sesi Anda sebagai admin, tetapi tambahkan ini ke awal skrip Anda: </p> <pre><code>$WindowsID=[System.Security.Principal.WindowsIdentity]::GetCurrent()\n$WindowsPrincipal=new-object System.Security.Principal.WindowsPrincipal($WindowsID)\n$adminRole=[System.Security.Principal.WindowsBuiltInRole]::Administrator\nif ($WindowsPrincipal.IsInRole($adminRole))\n{\n$Host.UI.RawUI.WindowTitle = $myInvocation.MyCommand.Definition + \"(Elevated)\"\n}\nelse\n{\n$newProcess = new-object System.Diagnostics.ProcessStartInfo \"PowerShell\";\n$newProcess.Arguments = $myInvocation.MyCommand.Definition;\n$newProcess.Verb = \"runas\";\n[System.Diagnostics.Process]::Start($newProcess);\nexit\n</code></pre>","votes":"6","source":"https://superuser.com/a/631420","author":"<a href=\"https://superuser.com/users/244055/darian-everett\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Darian Everett</span></a>","replies":[]},{"answer":"<p> Anda perlu menjalankan skrip ini dengan hak administrator. Cukup buka PowerShell ISE sebagai Administrator dan itu akan berjalan. </p>\n\n<p> Jika Anda ingin mengotomatiskan jalannya skrip, Anda harus menjalankannya sebagai skrip startup, atau menggunakan psexec untuk menjalankannya sebagai Sistem atau Administrator, atau membuat tugas terjadwal. </p>","votes":"2","source":"https://superuser.com/a/631422","author":"<a href=\"https://superuser.com/users/146694/rtf\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">rtf</span></a>","replies":[]}]}
