{"title":"Cara mendapatkan ukuran file sebelum mendownload file LWP :: useragent","draft":false,"url":"/cara-mendapatkan-ukuran-file-sebelum-mendownload-file-lwp-useragent-ppu1t5eu","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["perl"],"snippet":"Saya menulis skrip, jadi saya dapat mengunduh secara otomatis dari hotfile menggunakan  LWP :: UserAgent  . Saya telah berhasil mengunduh file dengan benar. Bagaimana cara mendapatkan ukuran file dari file tersebut sebelum...","body":"<p> Saya menulis skrip, jadi saya dapat mengunduh secara otomatis dari hotfile menggunakan <a href=\"http://www.xav.com/perl/site/lib/LWP/UserAgent.html\" rel=\"nofollow noopener\" target=\"_blank\"> LWP :: UserAgent </a> . Saya telah berhasil mengunduh file dengan benar. Bagaimana cara mendapatkan ukuran file dari file tersebut sebelum mengunduh? </p>\n\n<p> Saya membutuhkan ini untuk menampilkan banyak file yang telah diunduh. </p>","source":"https://superuser.com/questions/200468/how-to-get-file-size-before-downloading-the-file-lwpuseragent","author":"<a href=\"https://superuser.com/users/16313/ageis23\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">ageis23</span></a>","replies":[],"answers":[{"answer":"<p> Berikut adalah cuplikan singkat yang melakukan ini. </p> <pre><code>use LWP::UserAgent;\n\nsub GetFileSize{\n    my $url=shift;\n    $ua = new LWP::UserAgent;\n    $ua-&gt;agent(\"Mozilla/5.0\");\n    my $req = new HTTP::Request 'HEAD' =&gt; $url;\n    $req-&gt;header('Accept' =&gt; 'text/html');\n    $res = $ua-&gt;request($req);\n    if ($res-&gt;is_success) {\n        my $headers = $res-&gt;headers;\n        return $headers;\n    }\n    return 0;\n}\n\n$link = 'http://www.domain.com/anyfile.zip';\n$header = GetFileSize($link);\n\nprint \"File size: \" . $header-&gt;content_length . \" bytes\\n\";\nprint \"Last moified: \" . localtime($header-&gt;last_modified) . \"\\n\";\nexit;\n</code></pre> <p><a href=\"http://www.bigprism.com/cgi-perl-snippets/get-file-size-over-http.html\" rel=\"nofollow noopener\" target=\"_blank\"> Sumber </a></p>","votes":"4","source":"https://superuser.com/a/200471","author":"<a href=\"https://superuser.com/users/2013/nifle\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Nifle</span></a>","replies":[]},{"answer":"<p> Hanya mendapatkan ukurannya sangat sederhana: </p> <pre><code>use LWP::Simple;\n\nmy $url='http://www.superuser.com/favicon.ico';\nmy ($type, $size) = head($url) or die \"ERROR $url: $!\";\nprint \"$url: type: $type, size: $size$/\";\n</code></pre> <p> . </p>\n\n<p> Namun, untuk a <strong> indikator kemajuan nyata </strong> Anda harus mendaftarkan panggilan balik, seperti ini: </p> <pre><code>use LWP::UserAgent;\n\nmy $url='http://superuser.com/questions/200468/how-to-get-file-size-before-downloading-the-file-lwpuseragent?rq=1';#'http://www.superuser.com/favicon.ico';\nmy $ttlDown = 0;\nmy $resp = LWP::UserAgent-&gt;new()-&gt;get($url, ':content_cb' =&gt; sub {\n      my ($data, $response) = @_;\n      my $size = $response-&gt;content_length;\n      $ttlDown += length $data;\n      printf(\"%7.1f KB of %7.1f (%5.1f%%)$/\", \n        $ttlDown / 1024.0, $size / 1024.0, $ttlDown * 100.0 / $size\n      );\n      ##### TODO: append $data to file #####\n});\nprint \"$/-----$/\".$resp-&gt;as_string();\n</code></pre> <p> Perhatikan baris <code>##### TODO</code>: Anda mungkin ingin menulis byte yang diterima ke disk di sana. </p>","votes":"2","source":"https://superuser.com/a/462881","author":"<a href=\"https://superuser.com/users/152695/meisl\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">meisl</span></a>","replies":[]},{"answer":"<p> Jawaban di atas oleh <strong> Nifle </strong> banyak membantu saya. Saya hanya ingin menambahkannya untuk situs HTTP yang diautentikasi, Anda hanya perlu menambahkan satu baris, <strong> $ req-&gt; authorization_basic (&quot;$ name&quot;, &quot;$ pwd&quot;); </strong> Dan itu bekerja dengan baik. </p> <pre><code>sub GetFileSize{\n    my $url=shift;\n    my $name = shift;\n    my $pwd = shift;\n\n    my $browser = LWP::UserAgent-&gt;new;\n    $browser-&gt;agent(\"Mozilla/5.0\");\n    my $req =  HTTP::Request-&gt;new( HEAD =&gt; \"$url\");\n    $req-&gt;authorization_basic( \"$name\", \"$pwd\" );\n\n    $req-&gt;header('Accept' =&gt; 'text/html');\n    my $res = $browser-&gt;request($req);\n    if ($res-&gt;is_success) {\n        my $headers = $res-&gt;headers;\n        return $headers-&gt;content_length;\n    }\n    return 0;\n}\n</code></pre>","votes":"1","source":"https://superuser.com/a/725917","author":"<a href=\"https://superuser.com/users/305826/sanjay-bhosale\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Sanjay Bhosale</span></a>","replies":[]}]}
