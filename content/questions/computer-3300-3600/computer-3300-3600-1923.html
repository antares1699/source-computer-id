{"title":"Fungsi Excel bekerja seperti grup SQL dengan + hitungan (berbeda *)?","draft":false,"url":"/fungsi-excel-bekerja-seperti-grup-sql-dengan-hitungan-berbeda-jfb0w19h","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["microsoft-excel","worksheet-function"],"snippet":"Misalkan saya memiliki lembar Excel dengan data di bawah ini   CODE (COL A) | VALUE (COL B)==============================  A01         | 10  A01         | 20  A01         | 30  A01         | 10  B01         |...","body":"<p> Misalkan saya memiliki lembar Excel dengan data di bawah ini </p> <pre>\n CODE (COL A) | VALUE (COL B)\n==============================\n  A01         | 10\n  A01         | 20\n  A01         | 30\n  A01         | 10\n  B01         | 30\n  B01         | 30\n</pre> <p> Apakah ada fungsi Excel yang berfungsi seperti .. </p> <pre>\n\nSELECT CODE, count (Distinct *) FROM TABLE GROUP BY CODE\n\n\n CODE    | Distinct Count of Value\n===================================\n  A01    | 3\n  B01    | 1\n</pre> <p> atau, lebih baik lagi, apakah rumus Excel dapat ditempelkan di kolom <strong> C </strong> untuk mendapatkan sesuatu seperti ini: </p> <pre> \n CODE (COL A) | VALUE (COL B) | DISTINCT VALUE COUNT WITH MATCHING CODE (COL C)\n===============================================================================\n  A01         | 10            | 3\n  A01         | 20            | 3\n  A01         | 30            | 3\n  A01         | 10            | 3\n  B01         | 30            | 1\n  B01         | 30            | 1\n</pre> <p> Saya tahu saya bisa menggunakan tabel pivot untuk mendapatkan hasil ini dengan mudah.\nNamun karena persyaratan pelaporan, saya harus menambahkan <strong> &quot;hitungan berbeda&quot; </strong> kolom ke lembar Excel, maka tabel pivot bukanlah pilihan. </p>\n\n<p> Pilihan terakhir saya adalah menggunakan makro Excel (yang baik-baik saja), tetapi sebelumnya saya ingin mempelajari apakah fungsi Excel dapat menyelesaikan tugas semacam ini. </p>","source":"https://superuser.com/questions/764070/excel-function-working-like-sql-group-by-countdistinct","author":"<a href=\"https://superuser.com/users/298034/solo\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Solo</span></a>","replies":[{"reply":"Ya kamu bisa. Makro akan jauh lebih mudah. <a href=\"http://office.microsoft.com/en-us/excel-help/count-unique-values-among-duplicates-HP010070481.aspx\" rel=\"nofollow noopener\" target=\"_blank\"> mulai di sini </a>","author":"<a href=\"https://superuser.com/users/116196/raystafarian\" target=\"_blank\" rel=\"nofollow noopener\">Raystafarian</a>"},{"reply":"Apakah nilai di kolom A selalu alfa-numerik?","author":"<a href=\"https://superuser.com/users/97028/charlierb\" target=\"_blank\" rel=\"nofollow noopener\">CharlieRB</a>"},{"reply":"Pertanyaan serupa, tetapi tanpa persyaratan pencocokan KODE: <a href=\"http://superuser.com/q/520486/76571\" target=\"_blank\" rel=\"nofollow noopener\"> superuser.com/q/520486/76571 </a>","author":"<a href=\"https://superuser.com/users/76571/excellll\" target=\"_blank\" rel=\"nofollow noopener\">Excellll</a>"}],"answers":[{"answer":"<p> Masukkan rumus ini di sel C2, dengan asumsi Anda memiliki data di baris 2 hingga 7, </p> <pre><code>=SUMPRODUCT(($A$2:$A$7=A2)  /  COUNTIFS($B$2:$B$7, $B$2:$B$7, $A$2:$A$7, $A$2:$A$7))\n</code></pre> <p> dan tarik ke bawah. </p>\n\n<h3 class=\"h5\"> Bagaimana itu bekerja: </h3>\n\n<p> Ketika <code>SUMPRODUCT</code> diberi daftar argumen skalar, ini berfungsi seperti <code>SUM</code>, tetapi ini akan mengambil array sebagai argumen tanpa entri array khusus. </p>\n\n<p> Larik diisi dengan angka nol untuk rekaman yang tidak cocok dengan nilai <code>CODE</code> di kolom <code>A</code>. Untuk yang cocok, larik diisi dengan <code>1/(the number of records that have the same A and B values as this record)</code>. Jadi, misalnya, ada dua rekaman yang memiliki A = <code>A01</code> dan B = <code>10</code> , jadi untuk dua rekaman tersebut <code>1/2</code> (½) dimasukkan ke dalam larik. Pikirkan ini sebagai semacam pembobotan untuk nilai duplikat. Setiap kali nilai ini dijumlahkan, jumlah untuk setiap nilai B unik adalah 1 (dalam contoh, kedua record akan berjumlah ½ + ½ = 1). Ini memberikan jumlah rekaman yang berbeda. </p>\n\n<p> Contoh lengkap menggunakan data contoh Anda: </p>\n\n<p> Untuk rekaman apa pun dengan A = <code>A01</code>, rumus akan mengembalikan jumlah <code>{½,1,1,½,0,0}</code> = <code>3</code>. <br> Untuk rekaman apa pun dengan A = <code>B01</code>, rumus akan mengembalikan jumlah <code>{0,0,0,0,½,½}</code> = <code>1</code>. </p>","votes":"6","source":"https://superuser.com/a/764186","author":"<a href=\"https://superuser.com/users/76571/excellll\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Excellll</span></a>","replies":[{"reply":"Penggunaan SUMPRODUCTS dan COUNTIFS dengan sangat baik! Sudah dicoba dan itu juga berfungsi pada data yang tidak diurutkan.","author":"<a href=\"https://superuser.com/users/298034/solo\" target=\"_blank\" rel=\"nofollow noopener\">Solo</a>"},{"reply":"Namun kinerjanya tidak bagus untuk dataset besar (&gt; 1000 baris). Saya mengerti ini adalah batasan Excel, jadi saya akan menggunakan Excel Macros sebagai gantinya.","author":"<a href=\"https://superuser.com/users/298034/solo\" target=\"_blank\" rel=\"nofollow noopener\">Solo</a>"}]},{"answer":"<p> Berikut adalah pendekatan yang sedikit lebih mudah dipahami daripada pendekatan Excellll,\ntetapi itu membutuhkan kolom tambahan.\nDengan asumsi bahwa data Anda berada di Baris 2 hingga 7 (Kolom A dan B), masukkan ini di C2: </p> <pre><code>=COUNTIFS($A$2:$A2, $A2, $B$2:$B2, $B2)=1\n</code></pre> <p> dan ini di D2: </p> <pre><code>=COUNTIFS($C$2:$C$7, TRUE, $A$2:$A$7, $A2)\n</code></pre> <p> dan tarik ke bawah. </p>\n\n<h3 class=\"h5\"> Bagaimana itu bekerja: </h3>\n\n<p> <code>COUNTIFS($A$2:$A2, $A2, $B$2:$B2, $B2)</code> menghitung berapa baris <em> di atas dan termasuk yang sekarang </em> memiliki nilai <code>A</code> dan <code>B</code> yang sama dengan baris saat ini.\nIni akan menjadi 1 pada kemunculan pertama pasangan nilai (Baris 2, 3, 4, dan 6)\ndan lebih tinggi pada baris yang mengulangi pasangan nilai yang terjadi di atas\n(mis., ini akan menjadi 2 pada Baris 5 dan 7).\nMenguji apakah 1 menghasilkan <code>TRUE</code> pada kemunculan pertama dari setiap pasangan nilai yang berbeda\ndan <code>FALSE</code> di tempat lain.\nMaka rumus di Kolom D menghitung berapa <code>TRUE</code> yang ada untuk nilai sekarang <code>A</code>. </p>\n\n<p> Anda dapat sedikit menyederhanakan rumusnya: </p> <pre><code>C:    =COUNTIFS($A$2:$A2, $A2, $B$2:$B2, $B2)\n\nD:    =COUNTIFS($C$2:$C$7, 1, $A$2:$A$7, $A2)\n</code></pre> <p> dan tentu saja Anda dapat menyembunyikan Kolom C. </p>","votes":"2","source":"https://superuser.com/a/764221","author":"<a href=\"https://superuser.com/users/150988/scott\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Scott</span></a>","replies":[{"reply":"Penjelasan yang sangat jelas. Satu-satunya downside adalah kebutuhan kolom tambahan. Senang mengetahui teknik ini untuk referensi di masa mendatang.","author":"<a href=\"https://superuser.com/users/298034/solo\" target=\"_blank\" rel=\"nofollow noopener\">Solo</a>"}]},{"answer":"<p> Saya akan menggunakan Add-In Power Pivot Excel. Itu makan Hitungan Berbeda untuk sarapan ... </p>\n<p> Pertama saya akan menambahkan tabel Excel ke Power Pivot menggunakan tombol Buat Tabel Tertaut pada pita Power Pivot. </p>\n<p> Kemudian saya akan menggunakan tombol PivotTable pada pita Power Pivot untuk membuat Tabel Pivot, menyeret kolom Kode (Col A) ke zona Label Baris dan kolom Nilai (Kolom B) ke zona Nilai (di Daftar Bidang Power Pivot ). </p>\n<p> Secara default, bidang Nilai akan digabungkan sebagai Jumlah Nilai (Kolom B). Saya akan mengubahnya dengan mengklik entri Sum of Value (Col B) di zona Nilai dan memilih Summarize By, lalu Distinct Count. </p>\n<p> Berikut tangkapan layar hasilnya </p>\n<p><img src=\"https://i.stack.imgur.com/D3pN4.png\" alt=\"distinct count example\" class=\"img-fluid d-block my-2\" loading=\"lazy\"></p>","votes":"0","source":"https://superuser.com/a/764294","author":"<a href=\"https://superuser.com/users/310267/mike-honey\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Mike Honey</span></a>","replies":[]}]}
