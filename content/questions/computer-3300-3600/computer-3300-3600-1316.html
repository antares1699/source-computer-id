{"title":"Apakah ada cara untuk menyalin dan menempel secara terprogram ke RDP?","draft":false,"url":"/apakah-ada-cara-untuk-menyalin-dan-menempel-secara-terprogram-ke-rdp-ttddujib","votes":"4","answers_count":"4","categories":["Komputer"],"tags":["windows-7","remote-desktop","file-transfer","windows-server-2012"],"snippet":"Saya ingin menulis skrip cepat untuk mengirim satu file (yang sering saya ubah) dari workstation saya (OS windows7) ke server jauh (windows server 2012) melalui klien RDP.  Idealnya, saya mencari untuk membuat...","body":"<p> Saya ingin menulis skrip cepat untuk mengirim satu file (yang sering saya ubah) dari workstation saya (OS windows7) ke server jauh (windows server 2012) melalui klien RDP. </p>\n\n<p> Idealnya, saya mencari untuk membuat contoh proses rdpclip.exe dengan beberapa argumen. Sesuatu seperti:\n<code>rdpclip.exe -f [fileToCopyFromLocalToRemote]</code>\ntetapi sepengetahuan saya (dan pencarian singkat di Google) tidak ada yang setara seperti itu. </p>\n\n<p> Juga, saya <strong> tidak </strong> mencari alat pihak ketiga untuk melakukan ini! </p>","source":"https://superuser.com/questions/966428/is-there-a-way-to-programatically-copy-and-paste-to-an-rdp","author":"<a href=\"https://superuser.com/users/321591/matthew-peters\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Matthew Peters</span></a>","replies":[],"answers":[{"answer":"<p> Anda dapat menggunakan PowerShell untuk meletakkan file ke clipboard: </p> <pre><code>Add-Type -AssemblyName System.Windows.Forms\n$f = New-Object System.Collections.Specialized.StringCollection\n$f.Add(\"D:\\tmp\\mypic1.bmp\")\n[System.Windows.Forms.Clipboard]::SetFileDropList($f)\n</code></pre>","votes":"2","source":"https://superuser.com/a/972169","author":"<a href=\"https://superuser.com/users/459935/eldarien\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Eldarien</span></a>","replies":[{"reply":"Untuk melengkapi jawaban Anda, Anda perlu menambahkan bahwa pengguna juga perlu menambahkan skrip di sisi jarak jauh untuk mengambil file yang disalin. Selain itu, kedua skrip ini harus sinkron atau setidaknya responsif satu sama lain. Selain itu, saya tidak begitu yakin apakah ini akan berhasil dan tidak dapat mengujinya sendiri (masalah keamanan pada mesin lokal saya). Jika Anda dapat mengujinya dan membahas dua poin pertama saya, ini akan menjadi solusi paling sederhana sejauh ini ...","author":"<a href=\"https://superuser.com/users/321591/matthew-peters\" target=\"_blank\" rel=\"nofollow noopener\">Matthew Peters</a>"}]},{"answer":"<p> Jika Anda berniat untuk tetap terhubung ke sesi RDP, maka Anda bisa <a href=\"http://haacked.com/archive/2010/05/18/remote-desktop-file-copy.aspx/\" rel=\"nofollow noopener\" target=\"_blank\"> memetakan perjalanan </a> pada koneksi Anda yang dapat membuat drive lokal Anda tersedia untuk komputer jarak jauh. Ini ada di Remote Desktop <em> Sumber Daya Lokal </em> tab di bawah <em> Lebih... </em> tombol. </p>\n\n<p> Setelah diaktifkan, Anda dapat membuat tugas terjadwal untuk menyalin file. Anda dapat mengakses drive lokal dari nama berbagi khusus <code>\\\\tsclient\\c</code> atau drive mana pun yang Anda coba akses, seperti yang dijelaskan di <a href=\"https://technet.microsoft.com/en-us/library/Cc757834%28v=WS.10%29.aspx?f=255&MSPPError=-2147217396\" rel=\"nofollow noopener\" target=\"_blank\"> artikel TechNet ini </a> . Sekian contoh script yang akan Anda jalankan <em> di komputer jarak jauh </em> mungkin terlihat seperti ini: </p> <pre><code>IF EXIST \"\\\\tsclient\\c\\Mydir\\MyFile\" copy /Y \"\\\\tsclient\\c\\Mydir\\MyFile\" \"C:\\Syncrhonized\\MyDir\\MyFile\"\n</code></pre> <p> Anda dapat memasukkan ini sebagai tugas terjadwal untuk dijalankan setiap beberapa menit atau lebih. Waspadai masalah potensial jika orang lain masuk ke komputer ini dengan pemetaan drive dan struktur file. Skrip Anda tidak akan tahu komputer mana yang benar, kecuali Anda memasukkan semacam logika untuk memeriksanya. </p>","votes":"5","source":"https://superuser.com/a/970489","author":"<a href=\"https://superuser.com/users/430831/guitarpicker\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">GuitarPicker</span></a>","replies":[{"reply":"Saya baru saja menulis yang serupa tetapi Anda mengalahkan saya untuk itu. Masalah pengguna adalah bahwa Anda tidak dapat memetakan drive server secara lokal melalui RDP dan RDPClip.exe tidak memiliki argumen baris perintah apa pun sehingga tidak dapat digunakan secara terprogram. Solusi ideal adalah VPN ke server dan kemudian akses terprogram apa pun dapat dilakukan menggunakan alat asli seperti robocopy. Untuk memperluas jawaban Anda, Anda dapat merekomendasikan VPN.","author":"<a href=\"https://superuser.com/users/321172/kinnectus\" target=\"_blank\" rel=\"nofollow noopener\">Kinnectus</a>"},{"reply":"Saya berusaha sedekat mungkin dengan permintaan asli, karena saya tidak tahu sifat jaringannya. Bisa jadi server berada di jaringan DMZ yang di-firewall hanya tersedia melalui RDP. Solusi saya akan menjadi dua bagian - koneksi RDP, dan skrip untuk dijalankan dari mesin jarak jauh. Harap dicatat bahwa <code>\\\\tsclient</code> bukanlah pemetaan server tradisional, meskipun berfungsi seperti pemetaan. Itu tidak memerlukan konektivitas jaringan selain sesi RDP yang melaluinya tunneling. Untuk sedikit memperjelas jawabannya, <code>tsclient</code> adalah nama literal yang digunakan, bukan placeholder.","author":"<a href=\"https://superuser.com/users/430831/guitarpicker\" target=\"_blank\" rel=\"nofollow noopener\">GuitarPicker</a>"},{"reply":"Jadi saya tidak dapat memetakan drive jaringan karena keamanan dikunci. Apakah ada cara untuk menggunakan beberapa proses windows asli (seperti rdpclip.exe) untuk hanya melakukan secara terprogram apa yang dapat saya lakukan secara manual dengan mengklik (salin dan tempel). Secara hipotesis, saya tidak melihat alasan hal ini tidak dapat dilakukan. Pengguna mengirim perintah ke suatu tempat dan OS menafsirkannya untuk benar-benar melakukan transfer ....","author":"<a href=\"https://superuser.com/users/321591/matthew-peters\" target=\"_blank\" rel=\"nofollow noopener\">Matthew Peters</a>"},{"reply":"@ Matius: Solusi yang saya berikan <i> tidak </i> melibatkan drive jaringan. Ini menggunakan sintaks yang sama sebagai drive jaringan, tetapi itu bukan salah satu. Itu semua terowongan melalui sesi desktop jarak jauh. Anda harus secara manual atau membuat sesi desktop jarak jauh ke komputer dengan berbagi drive diaktifkan, tetapi setelah itu selesai, Anda dapat menyambung ke \\\\ tsclient \\ c dari komputer jarak jauh untuk masuk ke drive C komputer lokal. Tautan yang saya sertakan memiliki tangkapan layar dari keseluruhan proses. Cobalah. Saya sering menggunakan teknik ini untuk memindahkan file ke dan dari mesin jarak jauh yang ada di jaringan aman.","author":"<a href=\"https://superuser.com/users/430831/guitarpicker\" target=\"_blank\" rel=\"nofollow noopener\">GuitarPicker</a>"},{"reply":"Versi lama RDP biasanya memiliki opsi baris perintah untuk menjalankan aplikasi saat Anda terhubung, tetapi saya pikir ini telah dihapus beberapa waktu lalu. Sayang sekali, karena itu akan sangat berguna untuk apa yang Anda coba lakukan.","author":"<a href=\"https://superuser.com/users/430831/guitarpicker\" target=\"_blank\" rel=\"nofollow noopener\">GuitarPicker</a>"},{"reply":"Saya mungkin menyebutnya istilah yang salah tetapi saya tidak dapat menautkan drive workstation saya langsung ke remote melalui klien RDP seperti yang dijelaskan dalam artikel yang Anda sebutkan.","author":"<a href=\"https://superuser.com/users/321591/matthew-peters\" target=\"_blank\" rel=\"nofollow noopener\">Matthew Peters</a>"},{"reply":"Aduh. Mungkin saja fitur tersebut diblokir oleh server atau melalui Kebijakan Grup. Jika demikian, Anda mungkin harus meminta pengecualian. Cara berbelit-belit lainnya untuk melakukan ini adalah melalui semacam sihir Auto Hotkeys, tetapi saya akan membiarkan orang lain menulis jawabannya.","author":"<a href=\"https://superuser.com/users/430831/guitarpicker\" target=\"_blank\" rel=\"nofollow noopener\">GuitarPicker</a>"},{"reply":"Inilah yang saya cari! Terima kasih","author":"<a href=\"https://superuser.com/users/874798/friesgaard\" target=\"_blank\" rel=\"nofollow noopener\">Friesgaard</a>"},{"reply":"apakah ada cara untuk menyalin dari server tanpa memetakan drive? dapatkah Anda memberikan beberapa sumber?","author":"<a href=\"https://superuser.com/users/464311/vaibhavcool20\" target=\"_blank\" rel=\"nofollow noopener\">vaibhavcool20</a>"}]},{"answer":"<p> Menurut penelitian saya, rdpclip.exe tidak menerima argumen baris perintah apa pun. Untuk menggunakannya untuk menyalin file secara terprogram tampaknya tidak dimaksudkan. </p>\n\n<p> Sejak Windows Vista <em> robocopy </em> adalah bagian dari setiap instalasi Windows.\nSaya tidak tahu bagaimana Anda ingin menggunakan rdpclip.exe untuk mentransfer file ke host jarak jauh.\nTapi pikiran pertama saya adalah memasang netshare, menggunakan robocopy untuk mentransfer file dan turun dari netshare.\nDalam sebuah skrip akan terlihat seperti: </p> <pre><code>net use \\\\Server\\Sharename /USER:[username] [passwort]\nrobocopy [Source] [Destination]\nnet use \\\\Servername\\Sharename /del\n</code></pre>","votes":"1","source":"https://superuser.com/a/970475","author":"<a href=\"https://superuser.com/users/495164/hirnwunde\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">hirnwunde</span></a>","replies":[{"reply":"Bisakah Anda memberi contoh? Misalkan servernya 192.11.12.33","author":"<a href=\"https://superuser.com/users/337310/michael-haephrati\" target=\"_blank\" rel=\"nofollow noopener\">Michael Haephrati</a>"}]},{"answer":"<p> Seperti yang Anda katakan bahwa Anda tidak dapat berbagi hard disk lokal Anda dengan server,\nsatu-satunya mekanisme berbagi yang tersisa adalah papan klip. </p>\n\n<p> Jika papan klip dapat dibagikan melalui koneksi RDP, Anda dapat menggunakan sumber terbuka\nproyek <a href=\"http://gauravkumar37.github.io/clipboard-rdc/\" rel=\"nofollow noopener\" target=\"_blank\"> Clipboard RDC </a> . </p>\n\n<p> Proyek ini terdiri dari program Java yang sangat kecil yang diluncurkan pada keduanya\nsisi koneksi. Program sisi klien digunakan untuk menyandikan file\ndan memuatnya ke clipboard, sementara program sisi server menerjemahkan dan\nmenyimpannya dalam file lokal.\nBatasannya di sini adalah bahwa file harus cukup kecil agar muat di papan klip. </p>\n\n<p> Seperti berdiri, ini lebih banyak pekerjaan daripada yang ingin Anda lakukan.\nTetapi Anda dapat memodifikasi program sederhana ini dan memisahkannya menjadi dua bagian: </p>\n\n<ol>\n<li> Program sisi klien yang akan menerima jalur file sebagai parameter\ndan letakkan file yang disandikan di clipboard. </li>\n<li> Program sisi server yang akan berulang, menguji setiap beberapa detik untuk file\nkeberadaan file tersebut di clipboard, mendekode dan menyimpannya di folder. </li>\n</ol>\n\n<p> Karena ini akan menjadi program Anda sendiri yang Anda kontrol sepenuhnya,\nAnda bisa menambahkan fitur seperti itu\nseperti menambahkan jalur tujuan ke informasi yang Anda tempatkan di\nclipboard, sehingga ini menjadi alat tujuan umum untuk mentransfer secara otomatis\nbeberapa file berukuran cukup kecil dari klien ke server. </p>","votes":"1","source":"https://superuser.com/a/970923","author":"<a href=\"https://superuser.com/users/8672/harrymc\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">harrymc</span></a>","replies":[{"reply":"Tanpa menggali terlalu dalam ke clipboard RDC (yang akan saya lakukan nanti), apakah ada perintah windows asli untuk memuat sesuatu ke clipboard? Jika ada, saya pada dasarnya dapat melakukan apa yang dilakukan FOSS tetapi secara native.","author":"<a href=\"https://superuser.com/users/321591/matthew-peters\" target=\"_blank\" rel=\"nofollow noopener\">Matthew Peters</a>"},{"reply":"Saya menyebutkan proyek itu sebagai contoh. Jika Anda menggunakan Win32 API, mulailah dengan <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms649051%28v=vs.85%29.aspx\" rel=\"nofollow noopener\" target=\"_blank\"> Fungsi SetClipboardData </a> . C / C ++ akan lebih mudah daripada Java untuk berinteraksi dengan Windows.","author":"<a href=\"https://superuser.com/users/8672/harrymc\" target=\"_blank\" rel=\"nofollow noopener\">harrymc</a>"},{"reply":"Anda juga dapat menggunakan utilitas gratis <a href=\"http://www.nirsoft.net/utils/nircmd.html\" rel=\"nofollow noopener\" target=\"_blank\"> nircmd.exe </a> clipboard perintah untuk memuat file ke dan menyimpan dari clipboard.","author":"<a href=\"https://superuser.com/users/8672/harrymc\" target=\"_blank\" rel=\"nofollow noopener\">harrymc</a>"}]}]}
