{"title":"Solusi satu gerakan untuk menonaktifkan / mengaktifkan perangkat di pengelola perangkat (tanpa alat pihak ketiga)?","draft":false,"url":"/solusi-satu-gerakan-untuk-menonaktifkan-mengaktifkan-perangkat-di-pengelola-perangkat-tanpa-alat-pihak-ketiga-wfag09j2","votes":"4","answers_count":"3","categories":["Komputer"],"tags":["windows-10","script","device-manager"],"snippet":"Untuk mengatasi bug yang mengganggu di Windows 10, saya menemukan solusinya. Masalahnya adalah, banyak yang mengklik dan saya ingin mengotomatiskan langkah-langkahnya (skrip?) Jika memungkinkan. Ini  konteks  dari Reddit:    Ada perbaikan yang lebih...","body":"<p> Untuk mengatasi bug yang mengganggu di Windows 10, saya menemukan solusinya. Masalahnya adalah, banyak yang mengklik dan saya ingin mengotomatiskan langkah-langkahnya (skrip?) Jika memungkinkan. Ini <a href=\"https://www.reddit.com/r/Surface/comments/58c0ut/anyone_else_have_to_restart_their_sp4_to_get/d903pn3/\" rel=\"nofollow noopener\" target=\"_blank\"> konteks </a> dari Reddit: </p>\n\n<blockquote>\n  <p> Ada perbaikan yang lebih mudah daripada memulai ulang, jika Anda pergi ke <strong> Pengaturan perangkat </strong> , lalu di bawah <strong> Pengontrol Suara, Video dan Game </strong> , Temukan: <strong> Audio Tampilan Intel </strong> dan <strong> nonaktifkan </strong> kemudian <strong> aktifkan kembali </strong> dan itu harus memperbaikinya. </p>\n</blockquote>\n\n<p> Ada <a href=\"https://superuser.com/a/788412/128228\" target=\"_blank\" rel=\"nofollow noopener\"> menjawab </a> menunjukkan cara melakukan ini di baris perintah dengan alat pihak ketiga (devcon). Tetapi saya tidak senang menginstal / merawatnya dan bahkan tidak yakin apakah itu berfungsi di Windows 10. Saya ingin dapat melakukan ini tanpa alat pihak ketiga. </p>\n\n<p> Ini tidak harus berupa skrip baris perintah. Saya hanya ingin dapat melakukan ini dalam satu gerakan (klik dua kali ikon desktop baik-baik saja, mungkin perintah Cortana dapat melakukannya?). </p>","source":"https://superuser.com/questions/1165637/one-gesture-solution-to-disable-enable-a-device-in-device-manager-without-a-thi","author":"<a href=\"https://superuser.com/users/128228/fuhrmanator\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Fuhrmanator</span></a>","replies":[{"reply":"Saya tidak dapat menemukan solusi tanpa Devcon atau modul PowerShell untuk diunduh. Berikut adalah artikel yang menjelaskan cara menonaktifkan perangkat dengan PowerShell, menggunakan modul sederhana untuk mengimpor: <a href=\"https://blog.kulman.sk/enabling-and-disabling-hardware-devices-with-powershell/\" rel=\"nofollow noopener\" target=\"_blank\"> blog.kulman.sk/â€¦ </a>","author":"<a href=\"https://superuser.com/users/318290/ob1lan\" target=\"_blank\" rel=\"nofollow noopener\">Ob1lan</a>"},{"reply":"Hai, di Windows 10 saya menemukan sesuatu yang mungkin menarik bagi Anda: Get-PnpDevice. Coba gunakan perintah ini untuk mendapatkan FriendlyName perangkat suara Anda, kemudian coba sesuatu seperti ini: Get-PnpDevice -FriendlyName &quot;My USB Audio Device&quot; | Nonaktifkan-PnpDevice -confirm: $ false","author":"<a href=\"https://superuser.com/users/318290/ob1lan\" target=\"_blank\" rel=\"nofollow noopener\">Ob1lan</a>"},{"reply":"@ Ob1lan Ini berfungsi di sistem saya, dengan <code>Get-PnpDevice -FriendlyName &quot;Intel(R) Display Audio&quot; | Disable-PnpDevice -confirm:$false; Get-PnpDevice -FriendlyName &quot;Intel(R) Display Audio&quot; | Enable-PnpDevice -confirm:$false</code> - saya taruh ini di file <code>.ps1</code>, lalu pintasan per <a href=\"http://stackoverflow.com/a/10137272/1168342\" target=\"_blank\" rel=\"nofollow noopener\"> stackoverflow.com/a/10137272/1168342 </a> - Saya tidak tahu bagaimana membuatnya berjalan selalu sebagai admin yang meminta, tetapi mengklik kanan pintasan memungkinkan opsi itu. Tidak hanya satu gerakan, tapi mungkin bisa dilakukan. Terima kasih!","author":"<a href=\"https://superuser.com/users/128228/fuhrmanator\" target=\"_blank\" rel=\"nofollow noopener\">Fuhrmanator</a>"},{"reply":"Memposting jawaban dengan solusi untuk Jalankan sebagai admin. Semoga ini membantu !","author":"<a href=\"https://superuser.com/users/318290/ob1lan\" target=\"_blank\" rel=\"nofollow noopener\">Ob1lan</a>"}],"answers":[{"answer":"<p> Berdasarkan penelitian saya dan karena perintah berfungsi untuk Anda (sesuai komentar Anda), berikut adalah skrip terakhir yang dapat berfungsi sebagai &#39;satu isyarat&#39;. Saya telah menambahkan di awal beberapa instruksi untuk dijalankan sebagai admin secara otomatis (self elevated). Ini hanya akan berfungsi jika pengguna adalah admin komputer, tentunya. </p>\n\n<p> Skrip terakhir, Anda dapat menyimpan sebagai file &#39;.ps1&#39;, dan mengeksekusi dengan PowerShell: </p> <pre><code># Get the ID and security principal of the current user account\n$myWindowsID=[System.Security.Principal.WindowsIdentity]::GetCurrent()\n$myWindowsPrincipal=new-object System.Security.Principal.WindowsPrincipal($myWindowsID)\n\n# Get the security principal for the Administrator role\n$adminRole=[System.Security.Principal.WindowsBuiltInRole]::Administrator\n\n# Check to see if we are currently running \"as Administrator\"\nif ($myWindowsPrincipal.IsInRole($adminRole))\n{\n    # We are running \"as Administrator\" - so change the title and background color to indicate this\n    $Host.UI.RawUI.WindowTitle = $myInvocation.MyCommand.Definition + \"(Elevated)\"\n    $Host.UI.RawUI.BackgroundColor = \"DarkBlue\"\n    clear-host\n}\nelse\n{\n    # We are not running \"as Administrator\" - so relaunch as administrator\n\n    # Create a new process object that starts PowerShell\n    $newProcess = new-object System.Diagnostics.ProcessStartInfo \"PowerShell\";\n\n    # Specify the current script path and name as a parameter\n    $newProcess.Arguments = $myInvocation.MyCommand.Definition;\n\n    # Indicate that the process should be elevated\n    $newProcess.Verb = \"runas\";\n\n    # Start the new process\n    [System.Diagnostics.Process]::Start($newProcess);\n\n    # Exit from the current, unelevated, process\n    exit\n}\nGet-PnpDevice -FriendlyName \"Intel(R) Display Audio\" | Disable-PnpDevice -confirm:$false\nGet-PnpDevice -FriendlyName \"Intel(R) Display Audio\" | Enable-PnpDevice -confirm:$false\n</code></pre>","votes":"4","source":"https://superuser.com/a/1166288","author":"<a href=\"https://superuser.com/users/318290/ob1lan\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Ob1lan</span></a>","replies":[{"reply":"Ini berfungsi, tetapi saya tidak yakin apa yang ditambahkan semua kode if / else. Ketika saya mencoba ini, saya masih mendapatkan munculan untuk meningkatkan izin (jadi itu dua gerakan, sama seperti <a href=\"http://superuser.com/a/1166546/128228\" target=\"_blank\" rel=\"nofollow noopener\"> Jawabanku </a> yang baru saja saya tambahkan). Di Windows 10, saya dapat mencentang &quot;Jalankan sebagai administrator&quot; pada opsi lanjutan Pintasan untuk mencapai hal yang sama dengan semua kode itu (menurut saya). Apakah saya melewatkan sesuatu dalam solusi Anda? Yang aneh bagi saya adalah tidak ada ketinggian yang diperlukan jika saya melakukan hal-hal ini dengan mengklik di pengelola perangkat.","author":"<a href=\"https://superuser.com/users/128228/fuhrmanator\" target=\"_blank\" rel=\"nofollow noopener\">Fuhrmanator</a>"},{"reply":"Saya juga bingung mengapa tampaknya tidak mungkin untuk menjalankan perintah PS yang sangat sederhana itu tanpa hak yang ditinggikan ...","author":"<a href=\"https://superuser.com/users/148208/christoph\" target=\"_blank\" rel=\"nofollow noopener\">Christoph</a>"}]},{"answer":"<p> Solusi sederhana ini berhasil untuk saya. </p>\n\n<ul>\n<li> Buat pintasan windows dengan Target ini:\n<code>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"Get-PnpDevice -FriendlyName \\\"Intel(R) Display Audio\\\" | Disable-PnpDevice -confirm:$false; Get-PnpDevice -FriendlyName \\\"Intel(R) Display Audio\\\" | Enable-PnpDevice -confirm:$false\"</code> </li>\n<li> Dalam <strong> Properti Pintasan&gt; Pintasan&gt; Properti tingkat lanjut </strong> , centang &quot;Jalankan sebagai administrator&quot; <a href=\"https://i.stack.imgur.com/1PcxP.png\" rel=\"nofollow noopener\" target=\"_blank\"><img src=\"https://i.stack.imgur.com/1PcxP.png\" alt=\"enter image description here\" class=\"img-fluid d-block my-2\" loading=\"lazy\"></a></li>\n</ul>\n\n<p> Ini akhirnya DUA gerakan, karena Anda harus mengizinkan ketinggian izin. Ketika saya mencoba <a href=\"https://superuser.com/a/1166288/128228\" target=\"_blank\" rel=\"nofollow noopener\"> @ Jawaban Ob1lan </a> , Saya juga harus mengklik untuk mengizinkan elevasi (gerakan kedua). Jadi, ini bukanlah jawaban yang ideal menurut pertanyaan awal. Catatan: Penonaktifan / pengaktifan perangkat secara manual (seperti yang dijelaskan dalam pertanyaan) tidak memerlukan ketinggian. </p>\n\n<p> Alasan saya menghindari file skrip (.ps1) adalah karena memerlukan serangkaian solusi tambahan karena keamanan, dan meskipun ada banyak pemeriksaan untuk administrator, itu tidak menambah nilai saat mencentang opsi pintasan &quot;Jalankan sebagai administrator&quot; . Lihat <a href=\"https://stackoverflow.com/questions/4037939/powershell-says-execution-of-scripts-is-disabled-on-this-system\" target=\"_blank\" rel=\"nofollow noopener\"> https://stackoverflow.com/questions/4037939/powershell-says-execution-of-scripts-is-disabled-on-this-system </a> untuk info lebih lanjut. </p>","votes":"3","source":"https://superuser.com/a/1166546","author":"<a href=\"https://superuser.com/users/128228/fuhrmanator\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Fuhrmanator</span></a>","replies":[{"reply":"Solusi bagus, apakah mungkin menggunakan pernyataan untuk mengaktifkan / menonaktifkan status perangkat, atau apakah saya harus menggunakan dua pintasan untuk itu?","author":"<a href=\"https://superuser.com/users/201818/albin\" target=\"_blank\" rel=\"nofollow noopener\">Albin</a>"}]},{"answer":"<p> Saya mengalami beberapa masalah dalam membuat skrip @ Ob1lan berfungsi di luar kotak karena agar dapat berfungsi (yaitu untuk memungkinkan skrip terangkat sendiri), <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-6#powershell-execution-policies\" rel=\"nofollow noopener\" target=\"_blank\"> Kebijakan Eksekusi Powershell </a> harus mengizinkan itu. Salah satu cara untuk melakukannya adalah dengan mengaturnya secara global menggunakan <a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-6\" rel=\"nofollow noopener\" target=\"_blank\"> <code>Set-ExecutionPolicy</code> </a> . Preferensi saya, meskipun, untuk <strong> biarkan kebijakan global tidak tersentuh dan lewati kapan pun diperlukan </strong> menggunakan argumen <code>-ExecutionPolicy ByPass</code>. </p>\n\n<p> Jadi di bawah ini adalah skrip yang sedikit dimodifikasi karena saya menggunakannya sekarang untuk menonaktifkan layar sentuh saya. Selain menambahkan bypass, saya juga menambahkan argumen <code>-WindowStyle hidden</code> untuk mencegah terlalu banyak jendela mencemari layar saya. (Petunjuk: jika skrip tidak berfungsi seperti yang diinginkan, saya sarankan Anda mengganti argumen itu terlebih dahulu dengan argumen <code>-noexit</code> untuk melihat pesan kesalahan apa pun.) </p> <pre><code># Get the ID and security principal of the current user account\n$myWindowsID=[System.Security.Principal.WindowsIdentity]::GetCurrent()\n$myWindowsPrincipal=new-object System.Security.Principal.WindowsPrincipal($myWindowsID)\n\n# Get the security principal for the Administrator role\n$adminRole=[System.Security.Principal.WindowsBuiltInRole]::Administrator\n\n# Check to see if we are currently running \"as Administrator\"\nif ($myWindowsPrincipal.IsInRole($adminRole))\n{\n    # We are running \"as Administrator\" - so change the title and background color to indicate this\n    $Host.UI.RawUI.WindowTitle = $myInvocation.MyCommand.Definition + \" (Elevated)\"\n    $Host.UI.RawUI.BackgroundColor = \"DarkBlue\"\n    clear-host\n}\nelse\n{\n    # We are not running \"as Administrator\" - so relaunch as administrator\n\n    # Create a new process object that starts PowerShell\n    $newProcess = new-object System.Diagnostics.ProcessStartInfo \"PowerShell\";\n\n    # Specify the current script path and name as a parameter, hide window and bypass execution policy (in case it has not been disabled globally)\n    $newProcess.Arguments = '-ExecutionPolicy ByPass -WindowStyle hidden ' + $myInvocation.MyCommand.Definition + '\" ';\n    # Here are the changes   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n    # Indicate that the process should be elevated\n    $newProcess.Verb = \"runas\";\n\n    # Start the new process\n    [System.Diagnostics.Process]::Start($newProcess);\n\n    # Exit from the current, unelevated, process\n    exit\n}\n\n Get-PnpDevice | Where-Object {$_.FriendlyName -like '*touch screen*'} | Enable-PnpDevice -Confirm:$false\n</code></pre>","votes":"0","source":"https://superuser.com/a/1365538","author":"<a href=\"https://superuser.com/users/148208/christoph\" target=\"_blank\" rel=\"nofollow noopener\"><span itemprop=\"name\">Christoph</span></a>","replies":[]}]}
